{"version":3,"sources":["Audio.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\assets\\framework\\modules","sourcesContent":["import Cache from \"./Cache\";\r\n\r\ninterface SE {\r\n    bgmVolume: number,\r\n    bgmEnable: boolean,\r\n    soundVolume: number,\r\n    soundEnable: boolean\r\n}\r\n\r\nexport default class Audio {\r\n    //单例处理\r\n    private static _instance: Audio = new Audio();\r\n    public static getInstance(): Audio {\r\n        return Audio._instance;\r\n    }\r\n    public _audioState: SE;\r\n    private _curBgm: number = null;\r\n    private _curBgmPath: cc.AudioClip = null;\r\n    private _curSoundEffect: number = null;\r\n    constructor() {\r\n        this._audioState = Cache.getInstance().getItem(\"AudioSE\") || { bgmVolume: 1, bgmEnable: true, soundVolume: 1, soundEnable: true };\r\n    }\r\n\r\n    public getAudioState(): SE {\r\n        return this._audioState;\r\n    }\r\n\r\n    public playBgm(bgm: cc.AudioClip): void {\r\n        if (!this._audioState.bgmEnable) return;\r\n        if (this._curBgm != null) this.stopCurBgm();\r\n        this._curBgmPath = bgm;\r\n        this._curBgm = cc.audioEngine.play(bgm, true, this._audioState.bgmVolume);\r\n    }\r\n\r\n    public stopCurBgm(): void {\r\n        if (this._curBgm != null) {\r\n            cc.audioEngine.stop(this._curBgm);\r\n        } else {\r\n            cc.audioEngine.stopAll();\r\n        }\r\n        this._curBgm = null;\r\n    }\r\n\r\n    public closeBgm(): void {\r\n        this._audioState.bgmEnable = false;\r\n        this.stopCurBgm();\r\n        this._saveAudioSE();\r\n    }\r\n\r\n    public openBgm(): void {\r\n        this._audioState.bgmEnable = true;\r\n        this.playBgm(this._curBgmPath);\r\n        this._saveAudioSE();\r\n    }\r\n\r\n    public setBgmVolume(volume: number): void {\r\n        this._audioState.bgmVolume = volume;\r\n        cc.audioEngine.setVolume(this._curBgm, this._audioState.bgmVolume);\r\n        this._saveAudioSE();\r\n    }\r\n\r\n    public playSoundEffect(audio: cc.AudioClip): number {\r\n        if (!this._audioState.soundEnable) return null;\r\n        this._curSoundEffect = cc.audioEngine.play(audio, false, this._audioState.soundVolume);\r\n        return this._curSoundEffect;\r\n    }\r\n\r\n    public stopSoundEffect(audioId?: number) {\r\n        if (typeof audioId !== \"undefined\") {\r\n            cc.audioEngine.stop(audioId);\r\n        } else {\r\n            if (this._curSoundEffect != null) {\r\n                cc.audioEngine.stop(this._curSoundEffect);\r\n                this._curSoundEffect = null;\r\n            }\r\n        }\r\n    }\r\n\r\n    public openSoundEffect(): void {\r\n        this._audioState.soundEnable = true;\r\n        this._saveAudioSE();\r\n    }\r\n\r\n    public closeSoundEffect(): void {\r\n        this._audioState.soundEnable = false;\r\n        this.stopSoundEffect();\r\n        this._saveAudioSE();\r\n    }\r\n\r\n    public setSoundEffectVolume(volume: number): void {\r\n        this._audioState.soundVolume = volume;\r\n        cc.audioEngine.setVolume(this._curSoundEffect, this._audioState.soundVolume);\r\n        this._saveAudioSE();\r\n    }\r\n\r\n    public stopAllAudio(): void {\r\n        cc.audioEngine.stopAll();\r\n        this._curBgm = null;\r\n        this._curSoundEffect = null;\r\n    }\r\n\r\n    private _saveAudioSE(): void {\r\n        Cache.getInstance().setItem(\"AudioSE\", this._audioState);\r\n    }\r\n}"]}