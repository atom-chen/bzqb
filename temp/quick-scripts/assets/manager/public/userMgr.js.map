{"version":3,"sources":["userMgr.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\assets\\manager\\public","sourcesContent":["import BaseMgr from \"../../framework/baseClass/BaseMgr\";\r\nimport { userMoney, user, userRank, userBattle } from \"./interface/iUserInfo\";\r\nimport Package from \"../../framework/net/package\";\r\nimport { dataids } from \"../../framework/net/dataids\";\r\nimport { enums } from \"../enums\";\r\nimport ShopMgr from \"./shopMgr\";\r\n\r\nexport default class UserMgr extends BaseMgr {\r\n    public user: user = <user>{};                   //玩家信息数据\r\n    public userRank: userRank = <userRank>{};       //玩家段位数据\r\n    public userBattle: userBattle = <userBattle>{}; //玩家战斗数据\r\n    public userMoney: userMoney = <userMoney>{};    //玩家金钱数据 \r\n    public userCfgTab: any = null;                  //玩家等级经验配置表\r\n    public onlineBoxTimes: number;                  //今日在线宝箱开箱次数\r\n    public winBoxTimes: number;\r\n    constructor() {\r\n        super();\r\n        this.routes = {\r\n            'gate.entry.req': this.gate_entry_req,\r\n            'plaza.users.initUser': this.plaza_users_initUser,\r\n            'plaza.users.createRole': this.plaza_users_createRole,\r\n            \"plaza.role.switchRole\": this.switchRole,\r\n            \"plaza.guild.createGuild\": this.plaza_guild_createGuild,\r\n            'plaza.guild.joinGuild': this.plaza_guild_joinGuild,\r\n            'guild.member.quitGuild': this.guild_member_quitGuild,\r\n            'search.entry.reqUserBrief': this.search_entry_reqUserBrief,\r\n        };\r\n    }\r\n\r\n    // 单例处理\r\n    private static _instance: UserMgr = null;\r\n    public static getInstance(): UserMgr {\r\n        if (UserMgr._instance == null) {\r\n            UserMgr._instance = new UserMgr();\r\n        }\r\n        return UserMgr._instance;\r\n    }\r\n    reqUserBrief(id) {\r\n        let msg = {\r\n            target: id\r\n        }\r\n        this.send_msg(\"search.entry.reqUserBrief\", msg)\r\n    }\r\n    private gate_entry_req(msg: Package): void {\r\n        this.user.userUID = msg.getDataByType(dataids.ID_UID);\r\n    }\r\n\r\n    private plaza_users_initUser(msg: Package): void {\r\n        this.userCfgTab = this.getConfigSync(\"level_dengji\").json;\r\n        this.initData(msg.getDataByType(dataids.ID_USER_INFO));\r\n    }\r\n\r\n    public plaza_users_createRole(msg: Package): void {\r\n        this.user.roleId = msg.getDataByType(dataids.ID_ROLEID_CHANGED);\r\n        this.user.userName = msg.getDataByType(dataids.ID_USER_NICKNAME_CHANGED);\r\n    }\r\n    // public dataAdd(name, dateName, data: number) {\r\n    //     this[name][dateName] += data;\r\n    //     cc.log(dateName, data, this[name][dateName])\r\n    // }\r\n\r\n    //初始化大厅部分数据\r\n    public initData(data: any): void {\r\n        console.log(\"-----玩家信息-----\", data)\r\n        this.initUser(data);\r\n        this.initUserRank(data);\r\n        this.initUserBattle(data);\r\n        this.initUserMoney(data);\r\n        this.onlineBoxTimes = data.todayOnlineBoxOpenTimes;\r\n        this.winBoxTimes = data.todayWinBoxOpenTimes;\r\n        if (this.user.guildId) {\r\n            this.requestGuildShopInfo();\r\n        }\r\n    }\r\n    public requestGuildShopInfo() {\r\n        ShopMgr.getInstance().reqShopInfo(enums.GuildShop_Card);\r\n    }\r\n    //初始化玩家信息数据\r\n    public initUser(data: any): void {\r\n        this.user.guildId = data.guildId || 0;\r\n        this.user.userUID = data.id;\r\n        this.user.roleId = data.roleId;\r\n        this.user.userName = data.nickname;\r\n        this.user.userExp = data.exp;\r\n        for (let i = 0; i < this.userCfgTab.length; i++) {\r\n            if (data.grade == this.userCfgTab[i].level) {\r\n                this.user.experience = this.userCfgTab[i].experience;\r\n            }\r\n        }\r\n        this.user.grade = data.grade;\r\n        this.user.winNum = data.winBattleTimes;\r\n        if (data.allBattleTimes != 0) {\r\n            this.user.winProbability = data.winBattleTimes / data.allBattleTimes * 100;\r\n        } else {\r\n            this.user.winProbability = 0;\r\n        }\r\n        this.user.mostRank = data.maxStage;\r\n        this.user.effects = 0;                  //暂无\r\n        this.user.oftenEffect = \"\";             //暂无\r\n        this.user.vipLv = data.vipLv;\r\n    }\r\n\r\n    //初始化玩家段位数据\r\n    public initUserRank(data: any): void {\r\n        this.userRank.stageStar = data.stageStar;\r\n        this.userRank.stage = data.stage;\r\n        this.userRank.stageScore = data.stageScore;\r\n    }\r\n\r\n    //初始化玩家战斗数据\r\n    public initUserBattle(data: any): void {\r\n        this.userBattle.hp = data.hp;\r\n        this.userBattle.atk = data.attack;\r\n        this.userBattle.ctr = data.critsRate;\r\n        this.userBattle.crtdamage = data.critsValueRate;\r\n        this.userBattle.effectList = null;\r\n    }\r\n    plaza_guild_joinGuild(msg: Package) {\r\n        if (this.user) {\r\n            this.user.guildId = msg.getDataByType(dataids.ID_USREGUILDID_CHANGED);\r\n        }\r\n    }\r\n    guild_member_quitGuild() {\r\n        if (this.user) {\r\n            this.user.guildId = 0;\r\n        }\r\n    }\r\n\r\n    //初始化大厅玩家金钱数据\r\n    public initUserMoney(data: any): void {\r\n        this.userMoney.gold = data.moneyGold;\r\n        this.userMoney.crystal = data.moneyFen;\r\n        this.userMoney.diamond = data.moneyStone;\r\n    }\r\n\r\n    //刷新玩家数据\r\n    public refreshData(id: number, data: any): void {\r\n        console.log(this.userMoney.gold)\r\n        switch (id) {\r\n            case dataids.ID_USER_MONEYGOLD:\r\n                this.userMoney.gold = data.userGold;\r\n                this.gemit(\"refreshMoneyUI\");\r\n                break;\r\n            case dataids.ID_USER_MONEYSTONE:\r\n                this.userMoney.diamond = data;\r\n                this.gemit(\"refreshMoneyUI\");\r\n                break;\r\n            case dataids.ID_USER_MONEYFEN:\r\n                this.userMoney.crystal = data;\r\n                this.gemit(\"refreshMoneyUI\");\r\n                break;\r\n            case dataids.ID_USRE_LEVEL:\r\n                this.user.grade = data.userLv;\r\n                this.user.userExp = data.userExp;\r\n                this.gemit(\"refreshLevelUI\");\r\n                break;\r\n            case dataids.ID_GET_MONEY_GOLD:\r\n                if (typeof data == \"number\") {\r\n                    this.userMoney.gold += data\r\n                }\r\n                else {\r\n                    this.userMoney.gold += data.moneyGold\r\n                }\r\n                this.gemit(\"refreshMoneyUI\");\r\n                break;\r\n            case dataids.ID_GET_MAILITEMS:\r\n                this.mailRewark(data.dictPrize);\r\n                this.gemit(\"refreshMoneyUI\");\r\n                break;\r\n            case dataids.ID_GET_BOXPRIZE:\r\n                this.userMoney.gold += data.addMoneyGold\r\n                this.gemit(\"refreshMoneyUI\");\r\n                break;\r\n            case dataids.ID_GET_WEEKVIPPRIZE:\r\n                console.log(this.userMoney.gold, data)\r\n                this.userMoney.gold += data.dictItemInfo[1];\r\n                this.userMoney.crystal += data.dictItemInfo[2];\r\n                this.gemit(\"refreshMoneyUI\");\r\n                break;\r\n            case dataids.ID_DOSIGNIN_RECINFO:\r\n                this.rewark(data.dictRecItems);\r\n                break;\r\n            case dataids.ID_MULTISIGNIN_RECINFO:\r\n                this.rewark(data.dictRecItems);\r\n                this.gemit(\"refreshMoneyUI\");\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n    getAllTypeItem(data) {\r\n        if (data[enums.Get_Gold]) {\r\n            this.userMoney.gold += data[enums.Get_Gold]\r\n        }\r\n        if (data[enums.Get_Crystal]) {\r\n            this.userMoney.crystal += data[enums.Get_Crystal]\r\n        }\r\n        if (data[enums.Get_Price]) {\r\n            this.userMoney.diamond += data[enums.Get_Price]\r\n        }\r\n        this.gemit(\"refreshMoneyUI\");\r\n    }\r\n    //邮件奖励处理  特殊处理\r\n    public mailRewark(data: any): void {\r\n        for (let key in data) {             //暂时只有金钱\r\n            switch (Number(key)) {\r\n                case enums.Get_Gold:        //金币奖励\r\n                    this.userMoney.gold += data[key][0].amount;\r\n                    break;\r\n                case enums.Get_Crystal:     //粉晶奖励\r\n                    this.userMoney.crystal += data[key][0].amount;\r\n                    break;\r\n                case enums.Get_Price:       //钻石奖励\r\n                    this.userMoney.diamond += data[key][0].amount;\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n\r\n    //奖励处理  数据结构类型：\r\n    public rewark(data: any): void {\r\n        for (let key in data) {\r\n            switch (Number(key)) {\r\n                case enums.Get_Gold:        //金币奖励\r\n                    this.userMoney.gold += data[key];\r\n                    break;\r\n                case enums.Get_Crystal:     //粉晶奖励\r\n                    this.userMoney.crystal += data[key];\r\n                    break;\r\n                case enums.Get_Price:       //钻石奖励\r\n                    this.userMoney.diamond += data[key];\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n\r\n    //获取服务器发送的角色使用数据\r\n    public switchRole(msg: Package): void {\r\n        let itemData = msg.getDataByType(dataids.ID_EQUIP_ROLE);\r\n        //将玩家信息中的roleId替换\r\n        this.user.roleId = itemData.autoId;\r\n    }\r\n    plaza_guild_createGuild(msg: Package) {\r\n        this.user.guildId = msg.getDataByType(dataids.ID_USREGUILDID_CHANGED);\r\n    }\r\n    search_entry_reqUserBrief() {\r\n\r\n    }\r\n    getMyInfo() {\r\n        return this.user;\r\n    }\r\n}\r\n"]}