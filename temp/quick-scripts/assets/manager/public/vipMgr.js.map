{"version":3,"sources":["vipMgr.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\assets\\manager\\public","sourcesContent":["import BaseMgr from \"../../framework/baseClass/BaseMgr\";\nimport Package from \"../../framework/net/package\";\n\nimport { dataids } from \"../../framework/net/dataids\";\nimport UserMgr from \"./userMgr\";\nimport GameNet from \"../../framework/modules/GameNet\";\nimport EffectMgr from \"./effectMgr\";\nimport BoxMgr from \"./boxMgr\";\nlet userMgr = UserMgr.getInstance();\n\nexport default class VipMgr extends BaseMgr {\n\t//vip模块\n\tpublic isInit: boolean = false;\n\tpublic vipTabal: any = null\n\tpublic vip: any = [];\n\n\t//玩家vip信息\n\tpublic vipScore: number = null;\n\tpublic vipLv: number = null;\n\tpublic vipGiftInfo: any = [];\n\tpublic vipWeekPrizeInfo: any = [];\n\t//周宝箱\n\tpublic dictItemInfo: any = [];\n\t//购买宝箱\n\tpublic vipGift: any = [];\n\tconstructor() {\n\t\tsuper();\n\t\tthis.routes = {\n\t\t\t'plaza.vip.reqVipInfo': this.reqVipInfo,\n\t\t\t'plaza.vip.recVipWeekPrize': this.recVipWeekPrize,\n\t\t\t'plaza.vip.buyVipGift': this.buyVipGift,\n\t\t};\n\t}\n\t//发包和接包\n\ttestGm1() {\n\t\tlet route = 'plaza.box.gm';\n\t\tlet msg = {\n\t\t\toprType: 5,//操作类型\n\t\t\tvipScore: 77777,\n\t\t}\n\t\tthis.send_msg(route, msg);\n\t}\n\tsendReqVipInfo() {\n\t\tlet route = 'plaza.vip.reqVipInfo';\n\t\tthis.send_msg(route);\n\t\t//this.testGm1();\n\t}\n\treqVipInfo(msg: Package): void {\n\t\tthis.isInit = true;\n\t\tlet vipInfo = msg.getDataByType(dataids.ID_GET_VIPINFO);\n\t\tconsole.log(\"--------vip信息-------\", vipInfo);\n\t\tthis.vipScore = vipInfo.vipScore;\n\t\tthis.vipLv = vipInfo.vipLv;\n\t\tthis.vipGiftInfo = vipInfo.vipGiftInfo;\n\t\tthis.vipWeekPrizeInfo = vipInfo.vipWeekPrizeInfo;\n\t}\n\t//周宝箱\n\tsendRecVipWeekPrize(level) {\n\t\tlet route = 'plaza.vip.recVipWeekPrize';\n\t\tlet msg = {\n\t\t\trecVipLv: level,\n\t\t}\n\t\tthis.send_msg(route, msg);\n\t}\n\trecVipWeekPrize(msg: Package): void {\n\t\tlet vipWeekPrize = msg.getDataByType(dataids.ID_GET_WEEKVIPPRIZE);\n\t\tconsole.log(\"--------vip周宝箱信息-------\", vipWeekPrize);\n\t\tthis.dictItemInfo = vipWeekPrize.dictItemInfo;\n\t\tthis.vipWeekPrizeInfo = vipWeekPrize.vipWeekPrizeInfo;\n\t\tthis.dictItemInfo = [];\n\t\tfor (var key in vipWeekPrize.dictItemInfo) {\n\t\t\tthis.dictItemInfo.push({\n\t\t\t\ttype: key,\n\t\t\t\tamount: vipWeekPrize.dictItemInfo[key]\n\t\t\t})\n\t\t}\n\t\tthis.dictItemInfo\n\t}\n\tsendBuyVipGift(level) {\n\t\tlet route = 'plaza.vip.buyVipGift';\n\t\tlet msg = {\n\t\t\tbuyVipLv: level,\n\t\t}\n\t\tthis.send_msg(route, msg);\n\t}\n\tbuyVipGift(msg: Package): void {\n\t\tlet VipGift = msg.getDataByType(dataids.ID_GET_BUYVIPGIFT);\n\t\tconsole.log(\"--------vip购买宝箱信息-------\", VipGift);\n\t\tthis.vipGift = []\n\t\tthis.vipGiftInfo = VipGift.vipGiftInfo;\n\t\tfor (var key in VipGift.dictItemInfo) {\n\t\t\tfor (let i = 0; i < VipGift.dictItemInfo[key].length; i++) {\n\t\t\t\tlet amount = VipGift.dictItemInfo[key][i].amount;\n\t\t\t\tswitch (key) {\n\t\t\t\t\tcase \"4\":\n\t\t\t\t\t\tEffectMgr.getInstance().addEffect(VipGift.dictItemInfo[key][i])\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"5\":\n\t\t\t\t\t\tBoxMgr.getInstance().addBox(VipGift.dictItemInfo[key][i])\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tthis.vipGift.push({\n\t\t\t\t\ttype: key,\n\t\t\t\t\tamount: amount,\n\t\t\t\t})\n\t\t\t}\n\t\t\t\n\t\t}\n\n\t}\n\n\t//发包和接包结束\n\tinitData() {\n\t\t//查表\n\t\tthis.vipTabal = this.getConfigSync(\"vip_vip\").json;\n\t\tcc.log(\"----VIP表格----\", this.vipTabal)\n\t\tthis.initVip();\n\t}\n\tinitVip() {\n\t\tfor (let i = 0; i < this.vipTabal.length; i++) {\n\t\t\tthis.vip.push(this.vipTabal[i])\n\t\t}\n\t}\n\n\t// 单例处理\n\tprivate static _instance: VipMgr = null;\n\tpublic static getInstance(): VipMgr {\n\t\tif (VipMgr._instance == null) {\n\t\t\tVipMgr._instance = new VipMgr();\n\t\t}\n\t\treturn VipMgr._instance;\n\t}\n}\n\n/*\n请求vip界面信息协议：plaza.vip.reqVipInfo\n服务端需要数据：\n{\n\t\n}\n服务端返回数据：\n[75, dictInfo]/ip界面信息\ndictInfo = {\n        vipLv : null,//当前vip等级\n        vipScore : null,//当前vip积分\n        vipGiftInfo : {vip等级1:1, vip等级2:0},//0是未购买，1是已经购买\n        vipWeekPrizeInfo : {vip等级1：时间戳，vip等级2:时间戳}//是否领取了周礼包\n    }\n\n==========================\n购买vip特权宝箱协议：plaza.vip.buyVipGift\n服务端需要数据：\n{\n\tbuyVipLv ： 1购买什么等级的vip礼包\n}\n服务端返回数据：\n[77, dictPrize]//  获取的物品信息\ndictPrize = {\n\ttype : []//可能是金币数值，或者列表物品，看具体情况\n}\n\n==========================\n充值vip金额协议：plaza.vip.addVipScore\n服务端需要数据：\n{\n\taddScore : 1//增加的vip积分数额\n}\n服务端返回数据：\n[75, dictInfo]/ip界面信息\ndictInfo = {\n        vipLv : null,//当前vip等级\n        vipScore : null,//当前vip积分\n        vipGiftInfo : {vip等级1:1, vip等级2:0},//0是未购买，1是已经购买\n        vipWeekPrizeInfo : {vip等级1：时间戳，vip等级2:时间戳}//是否领取了周礼包\n    }\n\n==========================\n领取vip周宝箱协议：plaza.vip.recVipWeekPrize\n服务端需要数据：\n{\n\trecVipLv：1领取哪个等级的vip周福利\n}\n服务端返回数据：\n[78, dictPrize]//  获取的物品信息\ndictPrize = {\n\ttype : []//可能是金币数值，或者列表物品，看具体情况\n}\n */"]}