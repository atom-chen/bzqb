{"version":3,"sources":["cardMgr.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\assets\\manager\\public","sourcesContent":["import BaseMgr from \"../../framework/baseClass/BaseMgr\";\nimport Package from \"../../framework/net/package\";\n\nimport { dataids } from \"../../framework/net/dataids\";\nimport UserMgr from \"./userMgr\";\nimport GameNet from \"../../framework/modules/GameNet\";\nimport EffectMgr from \"./effectMgr\";\nimport { enums } from \"../enums\";\n\nexport default class cardMgr extends BaseMgr {\n    public monthlyCardTime: number = 2592000000;//月卡时间(毫秒)\n    public monthlyIsInit: boolean = false;\n    public LifeIsInit: boolean = false;\n    monthlyCardInfo: any = null;\n    lifetimeCardInfo: any = null;\n    monthlyCardBox:any =[];//月卡奖励\n    constructor() {\n        super();\n        this.routes = {\n            \"plaza.privilege.reqMonthlyCardInfo\": this.reqMonthlyCardInfo,\n            \"plaza.privilege.reqLifetimeCardInfo\": this.reqLifetimeCardInfo,\n            \"plaza.privilege.buyMonthlyCard\": this.buyMonthlyCard,\n            \"plaza.privilege.buyLifetimeCard\": this.buyLifetimeCard,\n            \"plaza.privilege.recMonthlyDailyBox\": this.recMonthlyDailyBox,\n        };\n\n    }\n    sendReqMonthlyCardInfo() {\n        let route = 'plaza.privilege.reqMonthlyCardInfo';\n        this.send_msg(route);\n    }\n    reqMonthlyCardInfo(msg: Package): void {\n        this.monthlyIsInit = true;\n        this.monthlyCardInfo = msg.getDataByType(dataids.ID_MONTHLYCARD_INFO);\n        console.log(\"--------月卡信息-------\", this.monthlyCardInfo);\n    }\n    sendReqLifetimeCardInfo() {\n        let route = 'plaza.privilege.reqLifetimeCardInfo';\n        this.send_msg(route);\n    }\n    reqLifetimeCardInfo(msg: Package): void {\n        this.LifeIsInit = true;\n        this.lifetimeCardInfo = msg.getDataByType(dataids.ID_LIFETIMECARD_INFO);\n        console.log(\"--------终身卡信息-------\", this.lifetimeCardInfo);\n    }\n    sendBuyMonthlyCard() {\n        let route = 'plaza.privilege.buyMonthlyCard';\n        this.send_msg(route);\n    }\n    buyMonthlyCard(msg: Package): void {\n        this.monthlyCardInfo = msg.getDataByType(dataids.ID_MONTHLYCARD_INFO);\n        console.log(\"--------购买月卡-------\", this.monthlyCardInfo);\n    }\n    sendBuyLifetimeCard() {\n        let route = 'plaza.privilege.buyLifetimeCard';\n        this.send_msg(route);\n    }\n    buyLifetimeCard(msg: Package): void {\n        this.lifetimeCardInfo = msg.getDataByType(dataids.ID_LIFETIMECARD_INFO);\n        console.log(\"--------购买终身卡-------\", this.lifetimeCardInfo);\n    }\n    sendRecMonthlyDailyBox() {\n        let route = 'plaza.privilege.recMonthlyDailyBox';\n        this.send_msg(route);\n    }\n    recMonthlyDailyBox(msg: Package): void {\n        this.monthlyCardInfo.isOpenBox = msg.getDataByType(dataids.ID_MONTHLYCARD_BOXPRIZE);\n        let goldInfo = msg.getDataByType(dataids.ID_GET_MONEY_GOLD);\n        let effectInfo = msg.getDataByType(dataids.ID_PRIZE_LIST_TEJI);\n        console.log(\"--------领取月卡宝箱-------\", this.monthlyCardInfo, goldInfo, effectInfo);\n        if (EffectMgr.getInstance().isInit) {\n            EffectMgr.getInstance().addEffect(effectInfo)\n        }\n        this.monthlyCardBox=[];\n        this.monthlyCardBox.push({\n            type: enums.Get_Gold,\n\t\t\tamount: goldInfo,\n        })\n        for (let i = 0; i < effectInfo.length; i++) {\n            this.monthlyCardBox.push({\n                type: effectInfo[i].type,\n\t\t\t\tamount: effectInfo[i].amount,\n            })\n        }\n        \n    }\n\n\n    // 单例处理\n    private static _instance: cardMgr = null;\n    public static getInstance(): cardMgr {\n        if (cardMgr._instance == null) {\n            cardMgr._instance = new cardMgr();\n        }\n        return cardMgr._instance;\n    }\n}\n\n"]}