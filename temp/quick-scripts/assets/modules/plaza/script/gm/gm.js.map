{"version":3,"sources":["gm.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\modules\\plaza\\script\\gm","sourcesContent":["import BaseModel from \"../../../../framework/baseClass/BaseModel\";\nimport BaseView from \"../../../../framework/baseClass/BaseView\";\nimport BaseCtrl from \"../../../../framework/baseClass/BaseCtrl\";\n\nimport gmMgr from \"../../../../manager/public/gmMgr\";\n/*\nauthor: 蔡世达\n日期:2018-11-24 14:18:08\n*/\n\n//MVC模块,\nconst { ccclass, property } = cc._decorator;\nlet ctrl: GMCtrl;\n//模型，数据处理\nclass Model extends BaseModel {\n    private json: any = gmMgr.getInstance().data;\n    private curType: any;\n\n\tconstructor() {\n\t\tsuper();\n\n    }\n    \n    public getData(): any { return this.json }\n\n    public setCurType(curType) { this.curType = curType }\n    public getCurType(): any { return this.curType }\n}\n//视图, 界面显示或动画，在这里完成\nclass View extends BaseView {\n\tprotected model: Model;\n\tprotected node: cc.Node;\n\tpublic ui={\n        \n        lblMgrType: ctrl.nodeData.getChildByName(\"lbltype\"),\n        editParam1: ctrl.nodeData.getChildByName(\"nodeParam1\").getChildByName(\"edit\"),\n        editParam2: ctrl.nodeData.getChildByName(\"nodeParam2\").getChildByName(\"edit\"),\n\n        lblParam1: ctrl.nodeData.getChildByName(\"nodeParam1\").getChildByName(\"lbl\"),\n        lblParam2: ctrl.nodeData.getChildByName(\"nodeParam2\").getChildByName(\"lbl\"),\n\n        btn_OK: ctrl.nodeData.getChildByName(\"btn\"),\n\n        nodeGMMgrType: ctrl.nodeGMMgrType,\n        prefab_btn : ctrl.btn,\n\n        btn_close: ctrl.node.getChildByName(\"bg1\"),\n\t}\n\n\tconstructor(model){\n\t\tsuper(model);\n\t\tthis.node = ctrl.node;\n\t\tthis.initUi();\n    }\n\n    public setlblParam1(param){\n        if(!param){\n            this.ui.lblParam1.parent.active = false\n            return\n        }else{\n            this.ui.lblParam1.parent.active = true\n        }\n        this.ui.lblParam1.getComponent(cc.Label).string = param\n    }\n    \n    public setlblParam2(param){\n        if(!param){\n            this.ui.lblParam2.parent.active = false\n            return\n        }else{\n            this.ui.lblParam2.parent.active = true\n        }\n        this.ui.lblParam2.getComponent(cc.Label).string = param\n    }\n\n    public getParam1(): any {\n        return this.ui.editParam1.getComponent(cc.EditBox).string\n    }\n\n    public getParam2(): any {\n        return this.ui.editParam2.getComponent(cc.EditBox).string\n    }\n\n\t//初始化ui\n\tpublic initUi() {\n\n    }\n    \n    public UpdateGmUI(){\n        let data = this.model.getData()\n        this.ui.nodeGMMgrType.destroyAllChildren()\n        for(var i = 0; i < data.length; i++){\n            let btn_type = this.addPrefabNode(this.ui.prefab_btn, this.ui.nodeGMMgrType);\n            btn_type.getChildByName(\"lbl\").getComponent(cc.Label).string = data[i].des\n\n            var clickEventHandler = new cc.Component.EventHandler();\n            clickEventHandler.target = ctrl.node; //这个 node 节点是你的事件处理代码组件所属的节点\n            clickEventHandler.component = \"gm\";//这个是代码文件名\n            clickEventHandler.handler = \"callback\";\n            clickEventHandler.customEventData = data[i];\n\n            var button = btn_type.getComponent(cc.Button);\n            button.clickEvents.push(clickEventHandler);\n        }\n    }\n\n    public UpdateTypeUI(){\n        let curType = this.model.getCurType()\n        this.setlblMgrType(curType.des)\n        this.setlblParam1(curType.param1)\n        this.setlblParam2(curType.param2)\n\n        this.ui.editParam1.getComponent(cc.EditBox).string = \"\"\n        this.ui.editParam2.getComponent(cc.EditBox).string = \"\"\n    }\n\n    public setlblMgrType(type):void {\n        this.ui.lblMgrType.getComponent(cc.Label).string = type\n    }\n}\n//c, 控制\n@ccclass\nexport default class GMCtrl extends BaseCtrl {\n\tprotected view: View;\n\tprotected model: Model;\n    //这边去声明ui组件\n    @property(cc.Node)\n    nodeGMMgrType:cc.Node = null;\n    @property(cc.Node)\n    nodeData:cc.Node = null;\n\n    @property(cc.Prefab)\n    btn: cc.Prefab = null;\n\t//声明ui组件end\n\t//这是ui组件的map,将ui和控制器或试图普通变量分离\n\n\tonLoad (){\n\t\t// 控制器\n\t\tctrl = this;\n\t\t// 创建mvc模式中模型和视图\n        this.initMvc(Model,View);\n        this.view.UpdateGmUI()\n\t}\n\n\t//定义网络事件\n\tprotected defineNetEvents() {\n\t \tthis.n_events = {\n\t\t\t//\"plaza.friend.applyFriend\": this.applyFriend,\n\t\t };\n\t}\n\t//定义全局事件\n\tprotected defineGlobalEvents() {\n\t\tthis.g_events = {\n\n\t\t};\n\t}\n\t\n\t//绑定操作的回调\n\tconnectUi() {\n        this.connect(\"click\", this.ui.btn_OK, ()=>{\n            let curType = this.model.getCurType()\n            if(!curType){\n                return\n            }\n\n            gmMgr.getInstance().sendData(curType.name, this.view.getParam1(), this.view.getParam2())\n\n        }, \"发送GM修改\" + this.model.getCurType())\n\n        this.connect(\"click\", this.ui.btn_close, ()=>{\n            this.closeModule(\"gm\")\n        }, \"\")\n\t}\n\t//网络事件回调begin\n\t//end\n\t//全局事件回调begin\n\t//end\n\t//按钮或任何控件操作的回调begin\n\t//end\n\n    // update(dt) {}\n    \n    public callback(event, customEventData) {\n        //这里 event 是一个 Touch Event 对象，你可以通过 event.target 取到事件的发送节点\n        var node = event.target;\n        var button = node.getComponent(cc.Button);\n        //这里的 customEventData 参数就等于你之前设置的 \"foobar\"\n\n        this.model.setCurType(customEventData)\n        this.view.UpdateTypeUI()\n    }\n\n\tonDestroy() {\n\t\tsuper.onDestroy();\n\t}\n}"]}