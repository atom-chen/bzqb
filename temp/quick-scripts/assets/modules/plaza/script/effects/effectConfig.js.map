{"version":3,"sources":["effectConfig.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\modules\\plaza\\script\\effects","sourcesContent":["import BaseModel from \"../../../../framework/baseClass/BaseModel\";\nimport BaseView from \"../../../../framework/baseClass/BaseView\";\nimport BaseCtrl from \"../../../../framework/baseClass/BaseCtrl\";\nimport { effectCfg, effect } from \"../../../../manager/public/interface/iEffect\";\nimport EffectMgr from \"../../../../manager/public/effectMgr\";\n\n/*\nauthor: 陈斌杰\n日期:2018-11-08 14:25:40\n*/\n\n//MVC模块,\nconst { ccclass, property } = cc._decorator;\nlet ctrl: EffectConfigCtrl;\n//模型，数据处理\nclass Model extends BaseModel {\n\tconstructor() {\n\t\tsuper();\n\t}\n\tpublic effect: effect = <effect>{};\n\tpublic effectCfg: effectCfg = <effectCfg>{};\n\n\t//初始化特技配置数据\n\tpublic initEffectCfgData (data: any): void {\n\t\tthis.effectCfg.isConfig = data.isConfig;\n\t\tthis.effectCfg.effectId = data.effectId;\n\t\tthis.initEffectData();\n\t}\n\n\tpublic initEffectData (): void {\n\t\tthis.effect = EffectMgr.getInstance().getEffectDataById(this.effectCfg.effectId);\n\t}\n\n\t//设置特技配置数据\n\tpublic setEffectCfgData (id: number): void {\n\t\tif (id == 0) {\n\t\t\tthis.effectCfg.isConfig = false;\n\t\t\tthis.effectCfg.effectId = id;\n\t\t\treturn;\n\t\t}\n\t\tthis.effect = EffectMgr.getInstance().getEffectDataById(id);\n\t\tthis.effectCfg.isConfig = true;\n\t\tthis.effectCfg.effectId = id;\n\t}\n}\n//视图, 界面显示或动画，在这里完成\nclass View extends BaseView {\n\tprotected model: Model;\n\tprotected node: cc.Node;\n\tpublic ui={\n\t\teffect: ctrl.effect,\t\t\t//特技\n\t\tisConfig: ctrl.isConfig,\t\t//是否配置\n\t\tenergy: ctrl.energy,\t\t\t//能量\n\t\tstars: ctrl.stars,\t\t\t\t//星级\n\t\teffectName: ctrl.effectName,\t//特技名称\n\t\tlevel: ctrl.level,\t\t\t\t//等级\n\t\tbtn_del: ctrl.btn_del,\t\t\t//删除\n\t}\n\tconstructor(model){\n\t\tsuper(model);\n\t\tthis.node = ctrl.node;\n\t\tthis.initUi();\n\t}\n\t//初始化ui\n\tpublic initUi() {\n\t\tthis.ui.effect.active = false;\n\t\tthis.ui.isConfig.active = false;\n\t}\n\n\t//初始化配置特技UI\n\tpublic initEffectCfgUi (): void {\n\t\tlet effectCfg = this.model.effectCfg;\n\t\tif (effectCfg.effectId != 0) {\n\t\t\tthis.ui.effect.active = true;\n\t\t\tthis.initEffectUi();\n\t\t} else {\n\t\t\tthis.ui.isConfig.active = true;\n\t\t}\n\t}\n\n\t//初始化特技UI\n\tpublic initEffectUi (): void {\n\t\tthis.ui.energy.string = this.model.effect.energy.toString();\n\t\tthis.ui.effectName.string = this.model.effect.name.toString();\n\t\tthis.ui.level.string = \"等级\"+this.model.effect.lv.toString();\n\t\tfor (let i = 0; i < this.ui.stars.childrenCount; i++) {\n\t\t\tif (i+1 <= this.model.effect.star) {\n\t\t\t\tthis.ui.stars.children[i].active = true;\n\t\t\t} else {\n\t\t\t\tthis.ui.stars.children[i].active = false;\n\t\t\t}\n\t\t}\n\t}\n\n\t//刷新特技配置UI\n\tpublic refreshEffectUI (): void {\n\t\tif (this.model.effectCfg.effectId == 0) {\n\t\t\tthis.ui.effect.active = false;\n\t\t} else {\n\t\t\tthis.ui.effect.active = true;\n\t\t}\n\t\tthis.ui.isConfig.active = false;\n\t\tthis.initEffectCfgUi();\n\t}\n}\n//c, 控制\n@ccclass\nexport default class EffectConfigCtrl extends BaseCtrl {\n\tprotected view: View;\n\tprotected model: Model;\n\t//这边去声明ui组件\n\t@property(cc.Node)\n\teffect: cc.Node = null;\n\t@property(cc.Node)\n\tisConfig: cc.Node = null;\n\t@property(cc.Label)\n\tenergy: cc.Label = null;\n\t@property(cc.Node)\n\tstars: cc.Node = null;\n\t@property(cc.Label)\n\teffectName: cc.Label = null;\n\t@property(cc.Label)\n\tlevel: cc.Label = null;\n\t@property(cc.Button)\n\tbtn_del: cc.Button = null;\n\t//声明ui组件end\n\t//这是ui组件的map,将ui和控制器或试图普通变量分离\n\n\n\tonLoad (){\n\t\t// 控制器\n\t\tctrl = this;\n\t\t// 创建mvc模式中模型和视图\n\t\tthis.initMvc(Model,View);\n\t}\n\n\t//定义网络事件\n\tprotected defineNetEvents() {\n\t \tthis.n_events = {};\n\t}\n\t//定义全局事件\n\tprotected defineGlobalEvents() {\n\t\tthis.g_events = {};\n\t}\n\t//绑定操作的回调\n\tconnectUi() {\n\t\tthis.connect(\"click\",this.ui.btn_del,()=>{\n\t\t\tthis.gemit(\"btn_delEffectCfg\",this.model.effect.itemId);\n\t\t},\"删除配置的特技\");\n\t}\n\t//网络事件回调begin\n\t//end\n\t//全局事件回调begin\n\t//end\n\t//按钮或任何控件操作的回调begin\n\t//end\n\n\t//初始化特技配置数据和UI\n\tpublic initEffectCfg (data: any): void {\n\t\tthis.model.initEffectCfgData(data);\n\t\tthis.view.initEffectCfgUi();\n\t}\n\n\t//刷新特技配置数据和UI\n\tpublic refreshEffectCfg (id: number): void {\n\t\tthis.model.setEffectCfgData(id);\n\t\tthis.view.refreshEffectUI();\n\t}\n\n\tonDestroy() {\n\t\tsuper.onDestroy();\n\t}\n}"]}