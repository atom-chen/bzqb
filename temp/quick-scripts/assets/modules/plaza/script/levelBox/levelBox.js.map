{"version":3,"sources":["levelBox.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\modules\\plaza\\script\\levelBox","sourcesContent":["import BaseModel from \"../../../../framework/baseClass/BaseModel\";\nimport BaseView from \"../../../../framework/baseClass/BaseView\";\nimport BaseCtrl from \"../../../../framework/baseClass/BaseCtrl\";\nimport BoxMgr from \"../../../../manager/public/boxMgr\";\nimport ModuleMgr from \"../../../../framework/modules/ModuleMgr\";\n/*\nauthor: 蒙磊\n日期:2018-11-23 17:11:42\n*/\n\n//MVC模块,\nconst { ccclass, property } = cc._decorator;\nlet ctrl: LevelBoxCtrl;\n//模型，数据处理\nclass Model extends BaseModel {\n\tpublic buyState: boolean = false;\n\tpublic des: string;\n\tpublic levelBox: any;\n\tpublic curPrice: string;\n\tpublic have: null;\n\tpublic originalPrice: string;\n\tconstructor() {\n\t\tsuper();\n\t}\n\tsetData(data, have) {\n\t\tthis.levelBox = data;\n\t\tthis.have = have;\n\t\tthis.des = data.des;\n\t\tthis.originalPrice = data.original_price.toString();\n\t\tthis.curPrice = \"现价\" + data.price_diamond;\n\t}\n}\n//视图, 界面显示或动画，在这里完成\nclass View extends BaseView {\n\tprotected model: Model;\n\tprotected node: cc.Node;\n\tpublic ui = {\n\t\t//在这里声明ui\n\t\tlab_des: ctrl.lab_des,\n\t\tlab_originalPrice: ctrl.lab_originalPrice,\n\t\tlab_curPrice: ctrl.lab_curPrice,\n\t\tbtn_buy: ctrl.btn_buy,\n\t}\n\tconstructor(model) {\n\t\tsuper(model);\n\t\tthis.node = ctrl.node;\n\t\tthis.initUi();\n\t}\n\t//初始化ui\n\tpublic initUi() {\n\n\t}\n\tinitData() {\n\t\tthis.showLabelString(this.ui.lab_des, this.model.des)\n\t\tthis.showLabelString(this.ui.lab_originalPrice, this.model.originalPrice)\n\t\tthis.showLabelString(this.ui.lab_curPrice, this.model.curPrice)\n\t\tif (this.model.have == null) {\n\t\t\tthis.ui.btn_buy.children[1].active = false;\n\t\t}\n\t\telse {\n\t\t\tthis.ui.btn_buy.children[0].active = false;\n\t\t\tthis.ui.btn_buy.getComponent(cc.Button).interactable = false;\n\t\t}\n\t}\n\tshowLabelString(obj: cc.Label, content: string) {\n\t\tobj.string = content;\n\t}\n}\n//c, 控制\n@ccclass\nexport default class LevelBoxCtrl extends BaseCtrl {\n\tprotected view: View;\n\tprotected model: Model;\n\t//这边去声明ui组件\n\t//label\n\t@property(cc.Label)\n\tlab_des: cc.Label = null;\n\t@property(cc.Label)\n\tlab_originalPrice: cc.Label = null;\n\t@property(cc.Label)\n\tlab_curPrice: cc.Label = null;\n\n\t@property(cc.Node)\n\tbtn_buy: cc.Node = null;\n\n\n\t//声明ui组件end\n\t//这是ui组件的map,将ui和控制器或试图普通变量分离\n\n\n\tonLoad() {\n\t\t// 控制器\n\t\tctrl = this;\n\t\t// 创建mvc模式中模型和视图\n\t\tthis.initMvc(Model, View);\n\n\t}\n\n\t//定义网络事件${route}\n\tprotected defineNetEvents() {\n\t\tthis.n_events = {\n\t\t\t'plaza.box.buyLevelBox': this.buyLevelBox,\n\t\t};\n\t}\n\t//定义全局事件\n\tprotected defineGlobalEvents() {\n\t\tthis.g_events = {};\n\t}\n\t//绑定操作的回调\n\tconnectUi() {\n\t\tthis.connect(\"click\", this.ui.btn_buy, this.buy, \"购买\");\n\t}\n\t//网络事件回调begin\n\tbuyLevelBox() {\n\t\tif (this.model.buyState) {\n\t\t\tthis.btn_buy.children[0].active = false;\n\t\t\tthis.btn_buy.children[1].active = true;\n\t\t\tthis.ui.btn_buy.getComponent(cc.Button).interactable = false;\n\t\t}\n\t}\n\t//end\n\t//全局事件回调begin\n\t//end\n\t//按钮或任何控件操作的回调begin\n\t//end\n\tbuy() {\n\t\tlet diamond = this.model.levelBox.original_price;\n\t\tlet level =\n\t\tModuleMgr.getInstance().showMsgBox({\n\t\t\tcontent: `确定要花费${diamond}砖石购买级特惠礼包?`,\n\t\t\tokcb: () => { BoxMgr.getInstance().sendBuyLevelBox(this.model.levelBox.condition_level), this.model.buyState = true }\n\t\t})\n\n\t}\n\tsetData(data, have) {\n\t\tthis.model.setData(data, have);\n\t\tthis.view.initData();\n\t}\n\tinitData() {\n\n\t}\n\t// update(dt) {}\n\n\tonDestroy() {\n\t\tsuper.onDestroy();\n\t}\n}"]}