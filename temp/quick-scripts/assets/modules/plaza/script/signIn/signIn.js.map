{"version":3,"sources":["signIn.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\modules\\plaza\\script\\signIn","sourcesContent":["import BaseModel from \"../../../../framework/baseClass/BaseModel\";\nimport BaseView from \"../../../../framework/baseClass/BaseView\";\nimport BaseCtrl from \"../../../../framework/baseClass/BaseCtrl\";\nimport SignInMgr from \"../../../../manager/public/signInMgr\";\nimport { signInList, totalSignInList } from \"../../../../manager/public/interface/iSignInfo\";\nimport Package from \"../../../../framework/net/package\";\nimport { dataids } from \"../../../../framework/net/dataids\";\nimport UserMgr from \"../../../../manager/public/userMgr\";\n\n/*\nauthor: 陈斌杰\n日期:2018-11-20 16:29:17\n*/\n\n//MVC模块,\nconst { ccclass, property } = cc._decorator;\nlet ctrl: SignInCtrl;\n//模型，数据处理\nclass Model extends BaseModel {\n\tconstructor() {\n\t\tsuper();\n\t}\n\tpublic signInListData: signInList = SignInMgr.getInstance().signInData;\t\t\t\t//全部签到数据\n\tpublic totalBoxesData: totalSignInList = SignInMgr.getInstance().totalBoxesData;\t//全部累积宝箱数据\n\tpublic nowCloseSignIn: number = null;\t\t\t\t\t\t\t\t\t\t\t\t//当前放弃双倍签到的天数\n\tpublic nowRepairSignIn: number = null;\t\t\t\t\t\t\t\t\t\t\t\t//当前补签天数\n\n\t//判断玩家身上的金钱是否足够补签\n\tpublic getIsCanSpend(): boolean {\n\t\tlet money = UserMgr.getInstance().userMoney.diamond;\n\t\tif (SignInMgr.getInstance().signIn_ReissuesCost < money) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n}\n//视图, 界面显示或动画，在这里完成\nclass View extends BaseView {\n\tprotected model: Model;\n\tprotected node: cc.Node;\n\tpublic ui = {\n\t\tbtn_close: ctrl.btn_close,\n\t\tcontent: ctrl.content,\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t//签到预制挂载节点\n\t\tboxes: ctrl.boxes,\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t//累积宝箱挂载节点\n\t\tday: ctrl.day,\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t//签到预制\n\t\tsignInBox: ctrl.signInBox,\t\t\t\t\t\t\t\t\t\t\t\t\t\t//累积宝箱预制\n\t\tdoubleSignIn: ctrl.doubleSignIn,\t\t\t\t\t\t\t\t\t\t\t\t//双倍签到界面\n\t\tbtn_doubleClose: ctrl.doubleSignIn.getChildByName(\"btn_doubleClose\"),\t\t\t//双倍签到关闭按钮\n\t\tclose: ctrl.doubleSignIn.getChildByName(\"close\"),\t\t\t\t\t\t\t\t//遗憾放弃按钮\n\t\trepairSignin: ctrl.repairSignin,\t\t\t\t\t\t\t\t\t\t\t\t//补签界面\n\t\tbtn_yqrx: ctrl.repairSignin.getChildByName(\"btn_yqrx\"),\t\t\t\t\t\t\t//补签界面有钱任性按钮\n\t\tbtn_shareGame: ctrl.repairSignin.getChildByName(\"btn_shareGame\"),\t\t\t\t//补签界面分享游戏按钮\n\t\tbtn_repairClose: ctrl.repairSignin.getChildByName(\"btn_repairClose\"),\t\t\t//关闭补签界面按钮\n\t\trepairnum: ctrl.repairSignin.getChildByName(\"repairNum\").getComponent(cc.Label),//补签次数\n\t\ttotalDay: ctrl.totalDay,\t\t\t\t\t\t\t\t\t\t\t\t\t\t//累积签到天数\n\t}\n\tconstructor(model) {\n\t\tsuper(model);\n\t\tthis.node = ctrl.node;\n\t\tthis.initUi();\n\t}\n\t//初始化ui\n\tpublic initUi() {\n\t\tthis.initSignInUI();\n\t\tthis.initTotalBoxesUI();\n\t\tthis.ui.doubleSignIn.active = false;\n\t}\n\n\t//初始化签到界面\n\tpublic initSignInUI(): void {\n\t\tlet row: number = 0;\n\t\tlet column: number = 0;\n\t\tfor (let i = 0; i < this.model.signInListData.list.length; i++) {\n\t\t\tlet signInData = this.model.signInListData.list[i];\n\t\t\tlet signInNode = this.addPrefabNode(this.ui.day, this.ui.content);\n\t\t\t//设置坐标\n\t\t\tcolumn = i % 7;\n\t\t\tif (i != 0 && i % 7 == 0) {\n\t\t\t\trow++;\n\t\t\t}\n\t\t\tsignInNode.x = -255 + 85 * column;\n\t\t\tsignInNode.y = 140 - 85 * row;\n\t\t\tsignInNode.getComponent(\"day\").initSignIn(signInData);\n\t\t}\n\t\tthis.ui.totalDay.string = SignInMgr.getInstance().multiDay.toString();\n\t}\n\n\t//初始化签到累积宝箱\n\tpublic initTotalBoxesUI(): void {\n\t\tfor (let i = 0; i < this.model.totalBoxesData.list.length; i++) {\n\t\t\tlet boxesData = this.model.totalBoxesData.list[i];\n\t\t\tlet boxesNode = this.addPrefabNode(this.ui.signInBox, this.ui.boxes);\n\t\t\t//设置坐标\n\t\t\tboxesNode.x = -225 + i * 150;\n\t\t\tboxesNode.y = -210;\n\t\t\tboxesNode.getComponent(\"signInBox\").initTotalBoxes(boxesData);\n\t\t}\n\t}\n\n\t//刷新签到UI\n\tpublic refreshSignInUI(index: number): void {\n\t\tthis.ui.content.children[index - 1].getComponent(\"day\").refreshUI();\n\t}\n\n\t//开启双倍签到界面\n\tpublic showDoubleSignIn(): void {\n\t\tthis.ui.doubleSignIn.active = true;\n\t}\n\n\t//设置遗憾放弃签到数据\n\tpublic setCloseSignIn(): void {\n\t\tthis.ui.content.children[this.model.nowCloseSignIn - 1].getComponent(\"day\").model.isNoDoubleSignIn = true;\n\t\tthis.ui.doubleSignIn.active = false;\n\t\tthis.model.nowCloseSignIn = null;\n\t}\n\n\t//开启补签界面\n\tpublic showRepairSignIn(): void {\n\t\tthis.ui.repairnum.string = `${SignInMgr.getInstance().signIn_Reissues}次`;\n\t\tthis.ui.repairSignin.active = true;\n\t}\n\n\t//刷新累积签到天数\n\tpublic refreshTotalDayUI(): void {\n\t\tthis.ui.totalDay.string = SignInMgr.getInstance().multiDay.toString();\n\t}\n\n\t//刷新累积宝箱显示UI\n\tpublic refreshBoxesUI(data: any): void {\n\t\tfor (let i = 0; i < this.model.totalBoxesData.list.length; i++) {\n\t\t\tlet boxesData = this.model.totalBoxesData.list[i];\n\t\t\tif (boxesData.totalSignInDay == data.multiDayIndex) {\n\t\t\t\tthis.ui.boxes.children[i].getComponent(\"signInBox\").refreshBoxes(data.dictRecItems);\n\t\t\t}\n\t\t}\n\t}\n}\n//c, 控制\n@ccclass\nexport default class SignInCtrl extends BaseCtrl {\n\tprotected view: View;\n\tprotected model: Model;\n\t//这边去声明ui组件\n\t@property(cc.Button)\n\tbtn_close: cc.Button = null;\n\t@property(cc.Node)\n\tcontent: cc.Node = null;\n\t@property(cc.Node)\n\tboxes: cc.Node = null;\n\t@property(cc.Prefab)\n\tday: cc.Prefab = null;\n\t@property(cc.Prefab)\n\tsignInBox: cc.Prefab = null;\n\t@property(cc.Node)\n\tdoubleSignIn: cc.Node = null;\n\t@property(cc.Node)\n\trepairSignin: cc.Node = null;\n\t@property(cc.Label)\n\ttotalDay: cc.Label = null;\n\t//声明ui组件end\n\t//这是ui组件的map,将ui和控制器或试图普通变量分离\n\n\n\tonLoad() {\n\t\t// 控制器\n\t\tctrl = this;\n\t\t// 创建mvc模式中模型和视图\n\t\tthis.initMvc(Model, View);\n\t}\n\n\t//定义网络事件\n\tprotected defineNetEvents() {\n\t\tthis.n_events = {\n\t\t\t\"plaza.signin.signin\": this.signin,\n\t\t\t\"plaza.signin.repairSignin\": this.getRepairSignin,\n\t\t\t\"plaza.signin.recMultiSignin\": this.recMultiSignin,\n\t\t};\n\t}\n\t//定义全局事件\n\tprotected defineGlobalEvents() {\n\t\tthis.g_events = {\n\t\t\t\"openDoubleSignIn\": this.openDoubleSignIn,\n\t\t\t\"openRepairSignIn\": this.openRepairSignIn,\n\t\t};\n\t}\n\t//绑定操作的回调\n\tconnectUi() {\n\t\tthis.connect(\"click\", this.ui.btn_close, () => {\n\t\t\tthis.closeModule(\"signIn\");\n\t\t}, \"关闭签到界面\");\n\t\tthis.connect(\"click\", this.ui.btn_doubleClose, () => {\n\t\t\tthis.ui.doubleSignIn.active = false;\n\t\t}, \"关闭双倍签到界面\");\n\t\tthis.connect(\"click\", this.ui.close, () => {\n\t\t\tthis.view.setCloseSignIn();\n\t\t}, \"遗憾放弃\");\n\t\tthis.connect(\"click\", this.ui.btn_yqrx, () => {\n\t\t\tif (SignInMgr.getInstance().signIn_Reissues == 0) {\n\t\t\t\tconsole.log(\"-------补签次数不足------\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (!this.model.getIsCanSpend()) {\n\t\t\t\tconsole.log(\"-------钻石不够，请充值！------\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tSignInMgr.getInstance().sendReqRepairSignIn(this.model.nowRepairSignIn);\n\t\t}, \"点击有钱任性按钮发送补签\");\n\t\tthis.connect(\"click\", this.ui.btn_shareGame, () => {\n\t\t\tconsole.log(\"-------分享游戏------\");\n\t\t}, \"点击分享游戏按钮发送补签\");\n\t\tthis.connect(\"click\", this.ui.btn_repairClose, () => {\n\t\t\tthis.ui.repairSignin.active = false;\n\t\t}, \"关闭补签界面\");\n\t}\n\t//网络事件回调begin\n\t//end\n\t//全局事件回调begin\n\t//end\n\t//按钮或任何控件操作的回调begin\n\t//end\n\n\t// update(dt) {}\n\n\t//服务器下发的签到数据  刷新签到UI\n\tpublic signin(msg: Package): void {\n\t\tlet data = msg.getDataByType(dataids.ID_DOSIGNIN_RECINFO);\n\t\tthis.view.refreshSignInUI(data.dayIndex);\n\t\tthis.view.refreshTotalDayUI();\n\t}\n\n\t//服务器下发补签数据  刷新UI\n\tpublic getRepairSignin(msg: Package): void {\n\t\tlet data = msg.getDataByType(dataids.ID_DOSIGNIN_RECINFO);\n\t\tthis.ui.repairSignin.active = false;\n\t\tthis.view.refreshSignInUI(data.dayIndex);\n\t\tthis.view.refreshTotalDayUI();\n\t}\n\n\t//服务器下发累积宝箱开启数据\n\tpublic recMultiSignin(msg: Package): void {\n\t\tlet data = msg.getDataByType(dataids.ID_MULTISIGNIN_RECINFO);\n\t\tthis.view.refreshBoxesUI(data);\n\t}\n\n\t//打开双倍签到界面\n\tpublic openDoubleSignIn(dayIndex: number): void {\n\t\tthis.model.nowCloseSignIn = dayIndex;\n\t\tthis.view.showDoubleSignIn();\n\t}\n\n\t//打开补签界面\n\tpublic openRepairSignIn(dayIndex: number): void {\n\t\tthis.model.nowRepairSignIn = dayIndex;\n\t\tthis.view.showRepairSignIn();\n\t}\n\n\tonDestroy() {\n\t\tsuper.onDestroy();\n\t}\n}"]}