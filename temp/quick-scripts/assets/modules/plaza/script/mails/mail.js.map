{"version":3,"sources":["mail.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\modules\\plaza\\script\\mails","sourcesContent":["import BaseModel from \"../../../../framework/baseClass/BaseModel\";\nimport BaseView from \"../../../../framework/baseClass/BaseView\";\nimport BaseCtrl from \"../../../../framework/baseClass/BaseCtrl\";\nimport { mail } from \"../../../../manager/public/interface/iMailInfo\";\nimport MailMgr from \"../../../../manager/public/mailMgr\";\n\n/*\nauthor: 陈斌杰\n日期:2018-11-17 15:26:10\n*/\n\n//MVC模块,\nconst { ccclass, property } = cc._decorator;\nlet ctrl: MailCtrl;\n//模型，数据处理\nclass Model extends BaseModel {\n\tconstructor() {\n\t\tsuper();\n\t}\n\tpublic mailData: mail = <mail>{};\n\n\t//设置邮件数据\n\tpublic setMailData(data: any): void {\n\t\tthis.mailData = data;\n\t}\n\n\t//刷新邮件读取状态数据\n\tpublic setBReadedState(): void {\n\t\tthis.mailData.bReaded = true;\n\t}\n}\n//视图, 界面显示或动画，在这里完成\nclass View extends BaseView {\n\tprotected model: Model;\n\tprotected node: cc.Node;\n\tpublic ui = {\n\t\tmailIco: ctrl.mailIco,\t\t\t\t\t\t\t\t\t\t\t\t\t//邮件图标\n\t\tmailIco_unopen: ctrl.mailIco.getChildByName(\"mail_unopen\"),\t\t\t\t//邮件未读取图标\n\t\tmailIco_open: ctrl.mailIco.getChildByName(\"mail_open\"),\t\t\t\t\t//邮件已读取图标\n\t\ttip_lab: ctrl.tip_lab,\t\t\t\t\t\t\t\t\t\t\t\t\t//邮件标题\n\t\ttime_lab: ctrl.time_lab,\t\t\t\t\t\t\t\t\t\t\t\t//邮件创建时间\n\t\tcountDown_lab: ctrl.countDown_lab,\t\t\t\t\t\t\t\t\t\t//邮件剩余时间\n\t}\n\tconstructor(model) {\n\t\tsuper(model);\n\t\tthis.node = ctrl.node;\n\t\tthis.initUi();\n\t}\n\t//初始化ui\n\tpublic initUi() {\n\t\tthis.ui.mailIco.active = false;\n\t\tthis.ui.mailIco_unopen.active = false;\n\t\tthis.ui.mailIco_open.active = false;\n\t}\n\n\t//初始化邮件UI\n\tpublic initMailUI(): void {\n\t\tif (!this.model.mailData.id) {\n\t\t\treturn;\n\t\t}\n\t\tthis.ui.mailIco.active = true;\n\t\tthis.ui.mailIco_unopen.active = !this.model.mailData.bReaded;\n\t\tthis.ui.mailIco_open.active = this.model.mailData.bReaded;\n\t\tthis.ui.tip_lab.string = this.model.mailData.title;\n\t\tthis.ui.time_lab.string = this.model.mailData.sendTime;\n\t\tif (this.model.mailData.residueTime <= 0) {\n\t\t\tthis.ui.countDown_lab.string = \"即将删除\";\n\t\t} else {\n\t\t\tthis.ui.countDown_lab.string = `剩余时间${this.model.mailData.residueTime.toString()}天`;\n\t\t}\n\t}\n\n\t//刷新邮件Ico\n\tpublic refreshMailIco(): void {\n\t\tthis.ui.mailIco_unopen.active = false;\n\t\tthis.ui.mailIco_open.active = true;\n\t}\n}\n//c, 控制\n@ccclass\nexport default class MailCtrl extends BaseCtrl {\n\tprotected view: View;\n\tprotected model: Model;\n\t//这边去声明ui组件\n\t@property(cc.Node)\n\tmailIco: cc.Node = null;\n\t@property(cc.Label)\n\ttip_lab: cc.Label = null;\n\t@property(cc.Label)\n\ttime_lab: cc.Label = null;\n\t@property(cc.Label)\n\tcountDown_lab: cc.Label = null;\n\t//声明ui组件end\n\t//这是ui组件的map,将ui和控制器或试图普通变量分离\n\n\n\tonLoad() {\n\t\t// 控制器\n\t\tctrl = this;\n\t\t// 创建mvc模式中模型和视图\n\t\tthis.initMvc(Model, View);\n\t}\n\n\t//定义网络事件\n\tprotected defineNetEvents() {\n\t\tthis.n_events = {};\n\t}\n\t//定义全局事件\n\tprotected defineGlobalEvents() {\n\t\tthis.g_events = {};\n\t}\n\t//绑定操作的回调\n\tconnectUi() {\n\t\tthis.connect(\"click\", this.node.getComponent(cc.Button), () => {\n\t\t\tif (this.model.mailData.content) {\n\t\t\t\t//刷新邮件详细内容显示\n\t\t\t\tthis.gemit(\"refreshMailExplain\", this.model.mailData.id);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlet listId = [];\n\t\t\tlistId.push(this.model.mailData.id);\n\t\t\tMailMgr.getInstance().sendReqMailExplainData(listId);\n\t\t}, \"点击邮件发送请求获取邮件数据\");\n\t}\n\t//网络事件回调begin\n\t//end\n\t//全局事件回调begin\n\t//end\n\t//按钮或任何控件操作的回调begin\n\t//end\n\n\t//初始化邮件数据\n\tpublic initMailData(data: any): void {\n\t\tthis.model.setMailData(data);\n\t\tthis.view.initMailUI();\n\t}\n\n\t//刷新邮件读取状态\n\tpublic refreshMailState(): void {\n\t\tif (this.ui.mailIco_open.active == true) {\n\t\t\treturn;\n\t\t}\n\t\tthis.model.setBReadedState();\n\t\tthis.view.refreshMailIco();\n\t}\n\n\tonDestroy() {\n\t\tsuper.onDestroy();\n\t}\n}"]}