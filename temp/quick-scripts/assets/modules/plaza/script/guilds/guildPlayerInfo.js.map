{"version":3,"sources":["guildPlayerInfo.ts"],"names":[],"mappings":";;;;;AAAA,uEAAkE;AAClE,qEAAgE;AAChE,qEAAgE;AAEhE,mDAAkD;AAClD,6DAA4D;AAE5D;;;EAGE;AAEF,QAAQ;AACF,IAAA,kBAAqC,EAAnC,oBAAO,EAAE,sBAAQ,CAAmB;AAC5C,IAAI,IAAyB,CAAC;AAC9B,SAAS;AACT;IAAoB,yBAAS;IAI5B;QAAA,YACC,iBAAO,SACP;QALD,qBAAe,GAAG,IAAI,CAAC;QACvB,uBAAiB,GAAG,IAAI,CAAC;QACzB,wBAAkB,GAAG,IAAI,CAAC;;IAG1B,CAAC;IACD,8BAAc,GAAd;QAEC,IAAG,IAAI,CAAC,kBAAkB,IAAE,IAAI,CAAC,kBAAkB,CAAC,GAAG,IAAI,IAAI,CAAC,eAAe,CAAC,EAAE,EAAE;YACnF,IAAI,CAAC,eAAe,CAAC,QAAQ,GAAG,IAAI,CAAC,kBAAkB,CAAC,QAAQ,CAAC;SACjE;IACF,CAAC;IACD,yCAAyB,GAAzB,UAA0B,kBAAkB;QAE3C,IAAG,kBAAkB,EACrB;YACC,IAAG,kBAAkB,CAAC,GAAG,IAAI,IAAI,CAAC,eAAe,CAAC,EAAE,EAAE;gBACrD,IAAI,CAAC,eAAe,CAAC,QAAQ,GAAG,kBAAkB,CAAC,QAAQ,CAAC;aAC5D;SACD;IACF,CAAC;IACF,YAAC;AAAD,CAtBA,AAsBC,CAtBmB,mBAAS,GAsB5B;AACD,mBAAmB;AACnB;IAAmB,wBAAQ;IAW1B,cAAY,KAAK;QAAjB,YACC,kBAAM,KAAK,CAAC,SAGZ;QAZM,QAAE,GAAC;YACT,mBAAmB,EAAE,IAAI,CAAC,mBAAmB;YAC7C,wBAAwB,EAAE,IAAI,CAAC,wBAAwB;YACvD,mBAAmB,EAAE,IAAI,CAAC,mBAAmB;YAC7C,uBAAuB,EAAE,IAAI,CAAC,uBAAuB;YACrD,oBAAoB,EAAE,IAAI,CAAC,oBAAoB;YAC/C,qBAAqB,EAAE,IAAI,CAAC,qBAAqB;SACjD,CAAA;QAGA,KAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC;QACtB,KAAI,CAAC,MAAM,EAAE,CAAC;;IACf,CAAC;IACD,OAAO;IACA,qBAAM,GAAb;QACC,IAAI,CAAC,mBAAmB,EAAE,CAAC;IAC5B,CAAC;IACM,kCAAmB,GAA1B;QAEC,IAAG,IAAI,CAAC,KAAK,CAAC,eAAe,EAAE;YAC9B,IAAI,CAAC,EAAE,CAAC,mBAAmB,CAAC,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC,QAAQ,CAAC;YACzE,IAAI,mBAAmB,GAAG,EAAE,CAAC;YAC7B,QAAO,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC,QAAQ,EAC1C;gBACC,KAAK,aAAK,CAAC,YAAY;oBACvB,mBAAmB,GAAC,MAAM,CAAC;oBAC3B,MAAM;gBACN,KAAK,aAAK,CAAC,eAAe;oBAC1B,mBAAmB,GAAC,IAAI,CAAC;oBACzB,MAAM;gBACN,KAAK,aAAK,CAAC,mBAAmB;oBAC9B,mBAAmB,GAAC,KAAK,CAAC;oBAC1B,MAAM;aACN;YACD,IAAI,CAAC,EAAE,CAAC,uBAAuB,CAAC,MAAM,GAAG,mBAAmB,CAAC;YAC7D,IAAI,SAAS,GAAG,EAAE,CAAC;YACnB,QAAO,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC,UAAU,EAC5C;gBACC,KAAK,aAAK,CAAC,YAAY;oBACvB,SAAS,GAAC,MAAM,CAAC;oBACjB,MAAM;gBACN,KAAK,aAAK,CAAC,eAAe;oBAC1B,SAAS,GAAC,IAAI,CAAC;oBACf,MAAM;gBACN,KAAK,aAAK,CAAC,mBAAmB;oBAC9B,SAAS,GAAC,KAAK,CAAC;oBAChB,MAAM;aACN;YACD,IAAI,CAAC,EAAE,CAAC,oBAAoB,CAAC,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC,UAAU,CAAC;YAC5E,IAAI,CAAC,EAAE,CAAC,qBAAqB,CAAC,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC,MAAM,CAAC;YACzE,8BAA8B;YAC9B,oCAAoC;SACpC;IACF,CAAC;IACF,WAAC;AAAD,CAzDA,AAyDC,CAzDkB,kBAAQ,GAyD1B;AACD,OAAO;AAEP;IAAiD,uCAAQ;IADzD;QAAA,qEAwGC;QApGA,WAAW;QAEX,yBAAmB,GAAc,IAAI,CAAC;QAEtC,8BAAwB,GAAc,IAAI,CAAC;QAE3C,yBAAmB,GAAa,IAAI,CAAC;QAErC,6BAAuB,GAAa,IAAI,CAAC;QAEzC,0BAAoB,GAAa,IAAI,CAAC;QAEtC,2BAAqB,GAAa,IAAI,CAAC;;IAwFxC,CAAC;IAvFA,WAAW;IACX,6BAA6B;IAG7B,oCAAM,GAAN;QACC,MAAM;QACN,IAAI,GAAG,IAAI,CAAC;QACZ,gBAAgB;QAChB,IAAI,CAAC,OAAO,CAAC,KAAK,EAAC,IAAI,CAAC,CAAC;IAC1B,CAAC;IAED,QAAQ;IACE,6CAAe,GAAzB;QACE,IAAI,CAAC,QAAQ,GAAG;YACP,yBAAyB,EAAC,IAAI,CAAC,uBAAuB;YACtD,6BAA6B,EAAC,IAAI,CAAC,2BAA2B;YAC9D,mCAAmC,EAAC,IAAI,CAAC,iCAAiC;YAC1E,gCAAgC,EAAC,IAAI,CAAC,8BAA8B;SACvE,CAAC;IACT,CAAC;IACD,QAAQ;IACE,gDAAkB,GAA5B;QACC,IAAI,CAAC,QAAQ,GAAG,EAAE,CAAC;IACpB,CAAC;IACD,SAAS;IACT,uCAAS,GAAT;QACC,IAAI,CAAC,OAAO,CAAC,OAAO,EAAC,IAAI,CAAC,IAAI,EAAC,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,IAAI,CAAC,EAAC,QAAQ,CAAC,CAAC;IAC/E,CAAC;IACD,0DAA4B,GAA5B,UAA6B,IAAI;QAEhC,OAAO,CAAC,GAAG,CAAC,8BAA8B,EAAC,IAAI,CAAC,CAAA;QAChD,IAAI,CAAC,KAAK,CAAC,eAAe,GAAG,IAAI,CAAC;QAClC,IAAI,CAAC,IAAI,CAAC,mBAAmB,EAAE,CAAC;IACjC,CAAC;IACD,kDAAoB,GAApB;QAEC,IAAI,CAAC,KAAK,CAAC,uBAAuB,EAAC,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC,CAAC;IAChE,CAAC;IACD,qDAAuB,GAAvB,UAAwB,GAAY;QAE7B,IAAI,YAAY,GAAG,GAAG,CAAC,aAAa,CAAC,iBAAO,CAAC,iBAAiB,CAAC,CAAC;QAChE,IAAG,YAAY,IAAE,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC,EAAE,EAAE;YAC/C,IAAI,CAAC,MAAM,EAAE,CAAC;SACjB;IACL,CAAC;IACD,yDAA2B,GAA3B,UAA4B,GAAY;QAEjC,IAAI,CAAC,KAAK,CAAC,iBAAiB,GAAG,GAAG,CAAC,cAAc,CAAC,iBAAO,CAAC,wBAAwB,CAAC,CAAC;QAE1F,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,iBAAiB,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YAC7D,IAAI,kBAAkB,GAAG,IAAI,CAAC,KAAK,CAAC,iBAAiB,CAAC,CAAC,CAAC,CAAC;YACzD,IAAG,kBAAkB,CAAC,GAAG,IAAI,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC,EAAE,EAAE;gBACrD,IAAI,CAAC,KAAK,CAAC,yBAAyB,CAAC,kBAAkB,CAAC,CAAC;gBACzD,IAAI,CAAC,IAAI,CAAC,mBAAmB,EAAE,CAAC;aACtC;SACD;QACK,mEAAmE;QACnE,GAAG;IACV,CAAC;IACD,+DAAiC,GAAjC,UAAkC,GAAY;QAEvC,IAAI,CAAC,KAAK,CAAC,kBAAkB,GAAG,GAAG,CAAC,aAAa,CAAC,iBAAO,CAAC,wBAAwB,CAAC,CAAC;QACpF,IAAG,IAAI,CAAC,KAAK,CAAC,kBAAkB,CAAC,GAAG,IAAE,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC,EAAE,EAAE;YACpE,IAAI,CAAC,KAAK,CAAC,cAAc,EAAE,CAAC;YAC5B,IAAI,CAAC,IAAI,CAAC,mBAAmB,EAAE,CAAC;SACnC;IACL,CAAC;IACD,4DAA8B,GAA9B,UAA+B,GAAY;QAEpC,IAAI,CAAC,KAAK,CAAC,kBAAkB,GAAG,GAAG,CAAC,aAAa,CAAC,iBAAO,CAAC,wBAAwB,CAAC,CAAC;QACpF,IAAG,IAAI,CAAC,KAAK,CAAC,kBAAkB,CAAC,GAAG,IAAE,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC,EAAE,EAAE;YACpE,IAAI,CAAC,KAAK,CAAC,cAAc,EAAE,CAAC;YAC5B,IAAI,CAAC,IAAI,CAAC,mBAAmB,EAAE,CAAC;SACnC;IACL,CAAC;IACD,aAAa;IACb,KAAK;IACL,aAAa;IACb,KAAK;IACL,mBAAmB;IACnB,KAAK;IAEL,gBAAgB;IAEhB,uCAAS,GAAT;QACC,iBAAM,SAAS,WAAE,CAAC;IACnB,CAAC;IAjGD;QADC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC;oEACkB;IAEtC;QADC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC;yEACuB;IAE3C;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;oEACkB;IAErC;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;wEACsB;IAEzC;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;qEACmB;IAEtC;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;sEACoB;IAfnB,mBAAmB;QADvC,OAAO;OACa,mBAAmB,CAuGvC;IAAD,0BAAC;CAvGD,AAuGC,CAvGgD,kBAAQ,GAuGxD;kBAvGoB,mBAAmB","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\modules\\plaza\\script\\guilds","sourcesContent":["import BaseModel from \"../../../../framework/baseClass/BaseModel\";\r\nimport BaseView from \"../../../../framework/baseClass/BaseView\";\r\nimport BaseCtrl from \"../../../../framework/baseClass/BaseCtrl\";\r\nimport GuildsMgr from \"../../../../manager/public/guildsMgr\";\r\nimport { enums } from \"../../../../manager/enums\";\r\nimport { dataids } from \"../../../../framework/net/dataids\";\r\n\r\n/*\r\nauthor: 汤凯\r\n日期:2018-11-20 15:25:14\r\n*/\r\n\r\n//MVC模块,\r\nconst { ccclass, property } = cc._decorator;\r\nlet ctrl: GuildPlayerInfoCtrl;\r\n//模型，数据处理\r\nclass Model extends BaseModel {\r\n\tguildPlayerInfo = null;\r\n\tpositionChangeArr = null;\r\n\tpositionChangeData = null;\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t}\r\n\tchangePosition()\r\n\t{\r\n\t\tif(this.positionChangeData&&this.positionChangeData.uid == this.guildPlayerInfo.id) {\r\n\t\t\tthis.guildPlayerInfo.position = this.positionChangeData.position;\r\n\t\t}\r\n\t}\r\n\tchangePositionWithDataArr(positionChangeData)\r\n\t{\r\n\t\tif(positionChangeData)\r\n\t\t{\r\n\t\t\tif(positionChangeData.uid == this.guildPlayerInfo.id) {\r\n\t\t\t\tthis.guildPlayerInfo.position = positionChangeData.position;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n//视图, 界面显示或动画，在这里完成\r\nclass View extends BaseView {\r\n\tprotected model: Model;\r\n\tprotected node: cc.Node;\r\n\tpublic ui={\r\n\t\tspr_guildPlayerIcon: ctrl.spr_guildPlayerIcon,\r\n\t\tspr_guildPlayerStageIcon: ctrl.spr_guildPlayerStageIcon,\r\n\t\tlbl_guildPlayerName: ctrl.lbl_guildPlayerName,\r\n\t\tlbl_guildPlayerPosition: ctrl.lbl_guildPlayerPosition,\r\n\t\tlbl_guildPlayerStage: ctrl.lbl_guildPlayerStage,\r\n\t\tlbl_guildPlayerDonate: ctrl.lbl_guildPlayerDonate,\r\n\t}\r\n\tconstructor(model){\r\n\t\tsuper(model);\r\n\t\tthis.node = ctrl.node;\r\n\t\tthis.initUi();\r\n\t}\r\n\t//初始化ui\r\n\tpublic initUi() {\r\n\t\tthis.showGuildPlayerInfo();\r\n\t}\r\n\tpublic showGuildPlayerInfo()\r\n\t{\r\n\t\tif(this.model.guildPlayerInfo) {\r\n\t\t\tthis.ui.lbl_guildPlayerName.string = this.model.guildPlayerInfo.nickname;\r\n\t\t\tlet guildPlayerPosition = '';\r\n\t\t\tswitch(this.model.guildPlayerInfo.position)\r\n\t\t\t{\r\n\t\t\t\tcase enums.Guild_Member:\r\n\t\t\t\tguildPlayerPosition='普通成员';\r\n\t\t\t\tbreak;\r\n\t\t\t\tcase enums.Guild_President:\r\n\t\t\t\tguildPlayerPosition='会长';\r\n\t\t\t\tbreak;\r\n\t\t\t\tcase enums.Guild_VicePresident:\r\n\t\t\t\tguildPlayerPosition='副会长';\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tthis.ui.lbl_guildPlayerPosition.string = guildPlayerPosition;\r\n\t\t\tlet stageName = '';\r\n\t\t\tswitch(this.model.guildPlayerInfo.stageIndex)\r\n\t\t\t{\r\n\t\t\t\tcase enums.Guild_Member:\r\n\t\t\t\tstageName='普通成员';\r\n\t\t\t\tbreak;\r\n\t\t\t\tcase enums.Guild_President:\r\n\t\t\t\tstageName='会长';\r\n\t\t\t\tbreak;\r\n\t\t\t\tcase enums.Guild_VicePresident:\r\n\t\t\t\tstageName='副会长';\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tthis.ui.lbl_guildPlayerStage.string = this.model.guildPlayerInfo.stageIndex;\r\n\t\t\tthis.ui.lbl_guildPlayerDonate.string = this.model.guildPlayerInfo.donate;\r\n\t\t\t// this.ui.spr_guildPlayerIcon\r\n\t\t\t// this.ui.spr_guildPlayerStageIcon \r\n\t\t}\r\n\t}\r\n}\r\n//c, 控制\r\n@ccclass\r\nexport default class GuildPlayerInfoCtrl extends BaseCtrl {\r\n\tprotected view: View;\r\n\tprotected model: Model;\r\n\t//这边去声明ui组件\r\n\t@property(cc.Sprite)\r\n\tspr_guildPlayerIcon: cc.Sprite = null;\r\n\t@property(cc.Sprite)\r\n\tspr_guildPlayerStageIcon: cc.Sprite = null;\r\n\t@property(cc.Label)\r\n\tlbl_guildPlayerName: cc.Label = null;\r\n\t@property(cc.Label)\r\n\tlbl_guildPlayerPosition: cc.Label = null;\r\n\t@property(cc.Label)\r\n\tlbl_guildPlayerStage: cc.Label = null;\r\n\t@property(cc.Label)\r\n\tlbl_guildPlayerDonate: cc.Label = null;\r\n\t//声明ui组件end\r\n\t//这是ui组件的map,将ui和控制器或试图普通变量分离\r\n\r\n\r\n\tonLoad (){\r\n\t\t// 控制器\r\n\t\tctrl = this;\r\n\t\t// 创建mvc模式中模型和视图\r\n\t\tthis.initMvc(Model,View);\r\n\t}\r\n\r\n\t//定义网络事件\r\n\tprotected defineNetEvents() {\r\n\t \tthis.n_events = {\r\n            'guild.member.kickMember':this.guild_member_kickMember,\r\n            'guild.member.transPresident':this.guild_member_transPresident,\r\n            'guild.member.appointVicePresident':this.guild_member_appointVicePresident,\r\n            'guild.member.fireVicePresident':this.guild_member_fireVicePresident,\r\n        };\r\n\t}\r\n\t//定义全局事件\r\n\tprotected defineGlobalEvents() {\r\n\t\tthis.g_events = {};\r\n\t}\r\n\t//绑定操作的回调\r\n\tconnectUi() {\r\n\t\tthis.connect(\"click\",this.node,this.guildPlayerNodeClick.bind(this),\"点击公会成员\");\r\n\t}\r\n\tupdateAndShowGuildPlayerInfo(data)\r\n\t{\r\n\t\tconsole.log('updateAndShowGuildPlayerInfo',data)\r\n\t\tthis.model.guildPlayerInfo = data;\r\n\t\tthis.view.showGuildPlayerInfo();\r\n\t}\r\n\tguildPlayerNodeClick()\r\n\t{\r\n\t\tthis.gemit('guild.playerOperation',this.model.guildPlayerInfo);\r\n\t}\r\n\tguild_member_kickMember(msg: Package)\r\n\t{\r\n        let kickMebmerId = msg.getDataByType(dataids.ID_KIKGUILDMEMBER);\r\n        if(kickMebmerId==this.model.guildPlayerInfo.id) {\r\n\t        this.remove();\r\n\t    }\r\n\t}\r\n\tguild_member_transPresident(msg: Package)\r\n\t{\r\n        this.model.positionChangeArr = msg.getDatasByType(dataids.ID_GUILDPOSITION_CHANGED);\r\n\r\n\t\tfor (let i = 0; i < this.model.positionChangeArr.length; i++) {\r\n\t\t\tlet positionChangeData = this.model.positionChangeArr[i];\r\n\t\t\tif(positionChangeData.uid == this.model.guildPlayerInfo.id) {\r\n\t\t        this.model.changePositionWithDataArr(positionChangeData);\r\n\t\t        this.view.showGuildPlayerInfo();\r\n\t\t\t}\r\n\t\t}\r\n        //if(this.model.positionChangeArr==this.model.guildPlayerInfo.id) {\r\n        //}\r\n\t}\r\n\tguild_member_appointVicePresident(msg: Package)\r\n\t{\r\n        this.model.positionChangeData = msg.getDataByType(dataids.ID_GUILDPOSITION_CHANGED);\r\n        if(this.model.positionChangeData.uid==this.model.guildPlayerInfo.id) {\r\n\t        this.model.changePosition();\r\n\t        this.view.showGuildPlayerInfo();\r\n\t    }\r\n\t}\r\n\tguild_member_fireVicePresident(msg: Package)\r\n\t{\r\n        this.model.positionChangeData = msg.getDataByType(dataids.ID_GUILDPOSITION_CHANGED);\r\n        if(this.model.positionChangeData.uid==this.model.guildPlayerInfo.id) {\r\n\t        this.model.changePosition();\r\n\t        this.view.showGuildPlayerInfo();\r\n\t    }\r\n\t}\r\n\t//网络事件回调begin\r\n\t//end\r\n\t//全局事件回调begin\r\n\t//end\r\n\t//按钮或任何控件操作的回调begin\r\n\t//end\r\n\r\n\t// update(dt) {}\r\n\r\n\tonDestroy() {\r\n\t\tsuper.onDestroy();\r\n\t}\r\n}"]}