{"version":3,"sources":["friend.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\modules\\plaza\\script\\friends","sourcesContent":["import BaseModel from \"../../../../framework/baseClass/BaseModel\";\nimport BaseView from \"../../../../framework/baseClass/BaseView\";\nimport BaseCtrl from \"../../../../framework/baseClass/BaseCtrl\";\n\nimport { friend } from \"../../../../manager/public/interface/iFriend\";\nimport FriendsMgr from \"../../../../manager/public/friendsMgr\";\nimport GuildMembersMgr from \"../../../../manager/public/guildMembersMgr\";\n\nimport UserMgs from \"../../../../manager/public/userMgr\";\n\n/*\nauthor: 蔡世达\n日期:2018-11-20 13:57:46\n*/\n\n//MVC模块,\nconst { ccclass, property } = cc._decorator;\nlet ctrl: FriendCtrl;\n//模型，数据处理\nclass Model extends BaseModel {\n    constructor() {\n\t\tsuper();\n    }\n    \n    public friendData: friend = <friend>{};     //好友信息\n\n    //设置好友数据\n    public setFriendData(data: any): void {\n        this.friendData = data\n    }\n\n    //有没有工会\n    public HaveGuild(): boolean {\n        return (this.friendData.guildId > 0)\n    }\n}\n\n/*\n    head: any;\t\t\t\t\t//如果是角色头像用角色id获，其他待定\n\tname: string;\t\t\t\t//好友名称\n\tsex: number;\t\t\t\t//好友性别\n\ttank: string;\t\t\t\t//好友段位\n\tvipLv: number;\t\t\t\t//好友vip等级\n\tguildName: string;\t\t\t//好友公会名称\n    isOnline: boolean;\t\t\t//是否在线\n*/\n//视图, 界面显示或动画，在这里完成\nclass View extends BaseView {\n\tprotected model: Model;\n\tprotected node: cc.Node;\n\tpublic ui={\n        head: ctrl.btnHead,                                                     //玩家头像\n        btnFrame: ctrl.btnFrame,                                                //背景按钮\n        btnChallenge: ctrl.btnChallenge,                                        //友谊战按钮\n        playerInfo: ctrl.playerInfo,                                            //用户信息按钮\n        delFriend: ctrl.delFriend,                                              //删除好友按钮\n        guildInvite: ctrl.guildInvite,                                          //工会邀请按钮\n\n        isSelect: ctrl.btnHead.node.getChildByName(\"isSelect\"),                 //是否选择\n        guild: ctrl.node.getChildByName(\"guild\"),                               //工会\n        vip: ctrl.node.getChildByName(\"vip\"),                                   //vip等级\n        level: ctrl.node.getChildByName(\"level\"),                               //段位等级\n        sex: ctrl.node.getChildByName(\"sex\"),                                   //性别\n        name: ctrl.node.getChildByName(\"name\"),                                 //名字\n        online: ctrl.node.getChildByName(\"bg\").getChildByName(\"onlineStatus\"),  //在线状态\n\n        action:ctrl.node.getChildByName(\"action\"),                              //操作界面\n\n\t}\n\tconstructor(model){\n\t\tsuper(model);\n\t\tthis.node = ctrl.node;\n\t\tthis.initUi();\n\t}\n\t//初始化ui\n\tpublic initUi() {\n        //this.updateUI()\n\t}\n\n    //更新好友信息\n\tpublic updateUI(): void {\n        //this.ui.guild.getComponent(cc.Label).string = this.model.friendData.guildName\n        this.updateFriendOnlineStatus()\n        this.ui.name.getComponent(cc.Label).string = this.model.friendData.nickname\n    }\n\n    //选中\n    public isSelect(bIsSelect): void {\n        this.ui.isSelect.active = bIsSelect\n        this.ui.action.active = false\n    }\n    \n    //更新在线状态\n    public updateFriendOnlineStatus(): void {\n        if(this.model.friendData.online){\n            this.ui.online.getComponent(cc.Label).string = \"在线\"\n            this.ui.online.color = cc.color(0, 255, 0)\n\n            this.ui.btnChallenge.node.active = true\n        }else{\n            this.ui.online.getComponent(cc.Label).string = \"离线\"\n            this.ui.online.color = cc.color(0, 255, 0)\n\n            this.ui.btnChallenge.node.active = false\n        }\n    }\n\n    public showAction(bShow): void {\n        this.ui.action.active = bShow\n\n        this.ui.action.getChildByName(\"name\").getComponent(cc.Label).string = this.model.friendData.nickname\n    }\n}\n//c, 控制\n@ccclass\nexport default class FriendCtrl extends BaseCtrl {\n\tprotected view: View;\n\tprotected model: Model;\n    //这边去声明ui组件\n    @property(cc.Button)\n    btnFrame:cc.Button = null\n\t@property(cc.Button)\n    btnHead:cc.Button = null\n    @property(cc.Button)\n    btnChallenge:cc.Button = null\n    @property(cc.Button)\n    playerInfo:cc.Button = null\n    @property(cc.Button)\n    delFriend:cc.Button = null\n    @property(cc.Button)\n    guildInvite:cc.Button = null\n\t\n\t//声明ui组件end\n\t//这是ui组件的map,将ui和控制器或试图普通变量分离\n\n\tonLoad (){\n\t\t// 控制器\n\t\tctrl = this;\n\t\t// 创建mvc模式中模型和视图\n\t\tthis.initMvc(Model,View);\n\t}\n\n\t//定义网络事件\n\tprotected defineNetEvents() {\n\t \tthis.n_events = {\n            'guild.member.inviteJoinGuild':this.guild_member_inviteJoinGuild,\n        };\n\t}\n\t//定义全局事件\n\tprotected defineGlobalEvents() {\n\t\tthis.g_events = {};\n\t}\n\t//绑定操作的回调\n\tconnectUi() {\n        this.connect(\"click\", this.ui.head, ()=>{\n            this.gemit(\"refreshFriendList\", this.model.friendData.id);\n            this.view.showAction(true)\n        }, \"点击头像\")\n\n        this.connect(\"click\", this.ui.btnFrame, ()=>{\n            this.gemit(\"refreshFriendList\", this.model.friendData.id);\n            this.view.showAction(false)\n        }, \"点击聊天\")\n\n        this.connect(\"click\", this.ui.btnChallenge, ()=>{\n            this.gemit(\"showChallenge\", this.model.friendData.id);\n        }, \"点击友谊战\")\n\n        this.connect(\"click\", this.ui.playerInfo, ()=>{\n            this.gemit(\"ShowUserInfo\", this.model.friendData.id);\n        }, \"用户信息\")\n\n        this.connect(\"click\", this.ui.delFriend, ()=>{\n            FriendsMgr.getInstance().kickFriend(this.model.friendData.id)\n        }, \"删除好友\")\n\n        this.connect(\"click\", this.ui.guildInvite, ()=>{\n            if(this.model.HaveGuild()){\n                console.log(\"弹窗------\" + \"该玩家已经有工会了！\")\n            }else{\n                if(UserMgs.getInstance().getMyInfo().guildId > 0){\n                    GuildMembersMgr.getInstance().inviteJoinGuild(this.model.friendData.id)\n                    // this.gemit(\"guildInvite\", this.model.friendData.id);\n                }else{\n                    console.log(\"弹窗------\" + \"自己还没有工会！\")\n                }\n            }\n        }, \"工会邀请\")\n    }\n    \n    public isSelect(bIsSelect): void {\n        this.view.isSelect(bIsSelect)\n    }\n\n    public initFriendData(data: any): void {\n        this.model.setFriendData(data)\n        this.view.updateUI()\n    }\n    //添加好友后关闭好友\n    guild_member_inviteJoinGuild()\n    {\n        this.view.isSelect(false)\n    }\n\n    public getFriendId(): number {\n        return this.model.friendData.id\n    }\n\t//网络事件回调begin\n\t//end\n\t//全局事件回调begin\n\t//end\n\t//按钮或任何控件操作的回调begin\n\t//end\n\n\t// update(dt) {}\n\n\tonDestroy() {\n\t\tsuper.onDestroy();\n\t}\n}"]}