{"version":3,"sources":["ranks.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\modules\\plaza\\script\\rank","sourcesContent":["import BaseModel from \"../../../../framework/baseClass/BaseModel\";\nimport BaseView from \"../../../../framework/baseClass/BaseView\";\nimport BaseCtrl from \"../../../../framework/baseClass/BaseCtrl\";\nimport RankMgr from \"../../../../manager/public/rankMgr\";\n\n/*\nauthor: 陈斌杰\n日期:2018-11-09 15:25:39\n*/\n\n//MVC模块,\nconst { ccclass, property } = cc._decorator;\nlet ctrl: RanksCtrl;\n//模型，数据处理\nclass Model extends BaseModel {\n\trankList = null;\n\tnodeContentHeight = 416;\n    myRankInfo = null;\n\tconstructor() {\n\t\tsuper();\n\t}\n}\n//视图, 界面显示或动画，在这里完成\nclass View extends BaseView {\n\tprotected model: Model;\n\tprotected node: cc.Node;\n\tpublic ui={\n\t\tbtn_close: ctrl.btn_close,\n\t\tpref_rankInfo: ctrl.pref_rankInfo,\n\t\tscroll_bar: ctrl.scroll_bar,\n\t\tnode_content: ctrl.node_content,\n\t\tnode_myInfoContent: ctrl.node_myInfoContent,\n\t}\n\tconstructor(model){\n\t\tsuper(model);\n\t\tthis.node = ctrl.node;\n\t\tthis.initUi();\n\t}\n\t//初始化ui\n\tpublic initUi() {\n\n\t}\n\trefreshRankList()\n\t{\n\t\t// this.ui.node_content.destroyAllChildren();\n\t\tif(this.model.rankList) {\n\t\t\tthis.ui.node_content.setContentSize(this.ui.node_content.getContentSize().width,this.model.nodeContentHeight*(this.model.rankList.page+1));\n\t\t\tfor (let rankListIdx = 0; rankListIdx < this.model.rankList.rankList.length; rankListIdx++) {\n\t\t\t\tlet rankData = this.model.rankList.rankList[rankListIdx];\n\t\t\t\tlet rankInfo =cc.instantiate(this.ui.pref_rankInfo);\n\t\t\t\tthis.ui.node_content.addChild(rankInfo);\n\t\t\t\trankInfo.getComponent('rankInfo').updateAndRefreshMyRankInfo(rankData);\n\t\t\t}\n\t\t}\n\t}\n\trefreshMyRankInfo()\n\t{\n\t\tif(this.model.myRankInfo) {\n\t\t\tlet rankData = this.model.myRankInfo.rankInfo;\n\t\t\tlet rankInfo =cc.instantiate(this.ui.pref_rankInfo);\n\t\t\tthis.ui.node_myInfoContent.addChild(rankInfo);\n\t\t\trankInfo.getComponent('rankInfo').updateAndRefreshMyRankInfo(rankData);\n\t\t}\n\t}\n}\n//c, 控制\n@ccclass\nexport default class RanksCtrl extends BaseCtrl {\n\tprotected view: View;\n\tprotected model: Model;\n\t//这边去声明ui组件\n\t@property(cc.Button)\n\tbtn_close: cc.Button = null;\n\t@property(cc.Prefab)\n\tpref_rankInfo: cc.Prefab = null;\n\t@property(cc.ScrollView)\n\tscroll_bar: cc.ScrollView = null;\n\t@property(cc.Node)\n\tnode_content: cc.Node = null;\n\t@property(cc.Node)\n\tnode_myInfoContent: cc.Node = null;\n\t//声明ui组件end\n\t//这是ui组件的map,将ui和控制器或试图普通变量分离\n\n\n\tonLoad (){\n\t\t// 控制器\n\t\tctrl = this;\n\t\t// 创建mvc模式中模型和视图\n\t\tthis.initMvc(Model,View);\n\t\tRankMgr.getInstance().reqRank();\n\t\tRankMgr.getInstance().reqMyRankInfo();\n\t}\n\n\t//定义网络事件\n\tprotected defineNetEvents() {\n\t \tthis.n_events = {\n            'search.entry.reqRank': this.search_entry_reqRank,\n            'search.entry.reqMyRankInfo': this.search_entry_reqMyRankInfo,\n        };\n\t}\n\t//定义全局事件\n\tprotected defineGlobalEvents() {\n\t\tthis.g_events = {};\n\t}\n\t//绑定操作的回调\n\tconnectUi() {\n\t\tthis.connect(\"click\",this.ui.btn_close,()=>{\n\t\t\tRankMgr.getInstance().clearData();\n\t\t\tthis.closeModule(\"ranks\");\n\t\t},\"关闭排行榜界面\");\n\t\tthis.connect(\"scroll-to-bottom\",this.ui.scroll_bar.node,this.scrollToBottom.bind(this),\"拉到末尾\");\n\t}\n\t//网络事件回调begin\n\t//end\n\t//全局事件回调begin\n\t//end\n\t//按钮或任何控件操作的回调begin\n\t//end\n\tscrollToBottom()\n\t{\n\t\tRankMgr.getInstance().reqRank();\n\t}\n\tsearch_entry_reqRank()\n\t{\n\t\tthis.model.rankList = RankMgr.getInstance().getRankList();\n\t\tif(this.model.rankList&&this.model.rankList.rankList.length>0) {\n\t\t\tthis.view.refreshRankList();\n\t\t}\n\t}\n\tsearch_entry_reqMyRankInfo()\n\t{\n\t\tthis.model.myRankInfo = RankMgr.getInstance().gerMyRankInfo();\n\t\tthis.view.refreshMyRankInfo();\n\t}\n\tonDestroy() {\n\t\tRankMgr.getInstance().clearData();\n\t\tsuper.onDestroy();\n\t}\n}"]}