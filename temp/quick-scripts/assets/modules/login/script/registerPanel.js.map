{"version":3,"sources":["registerPanel.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\modules\\login\\script","sourcesContent":["import BaseView from \"../../../framework/baseClass/BaseView\";\nimport BaseCtrl from \"../../../framework/baseClass/BaseCtrl\";\nimport BaseModel from \"../../../framework/baseClass/BaseModel\";\nimport { register } from \"../../../manager/public/interface/iRegister\";\nimport UserMgr from \"../../../manager/public/userMgr\";\nimport LoginMgr from \"../../../manager/public/loginMgr\";\n\n/*\nauthor: 陈斌杰\n日期:2018-11-05 10:09:04\n*/\n\n//MVC模块,\nconst { ccclass, property } = cc._decorator;\nlet ctrl: RegisterCtrl;\n//模型，数据处理\nclass Model extends BaseModel {\n\tconstructor() {\n\t\tsuper();\n\t}\n\n\tpublic sendRegisterData: register = <register>{};\t\t//创建角色数据\n\tpublic nicknameCfgTab: any = LoginMgr.getInstance().nicknameCfgTab;\n\n\t//记录设置选择的性别  roleID  1001 男  1002 女\n\tpublic setChoiceSexState(sex: number): void {\n\t\tthis.sendRegisterData.roleID = sex + 1000;\n\t}\n\n\t//初始化玩家数据\n\tpublic setUserData(UID: number): void {\n\t\tthis.sendRegisterData = { UID: UID, nickname: UID.toString(), roleID: 1001 };\n\t}\n\n\t//设置玩家昵称\n\tpublic setUserNickname(nickname: string): void {\n\t\tthis.sendRegisterData.nickname = nickname;\n\t}\n\n\t//随机昵称数据\n\tpublic randomNickname(): void {\n\t\tlet random: number = Math.floor(Math.random()*(this.nicknameCfgTab.length));\n\t\tif (this.sendRegisterData.roleID == 1001) {\n\t\t\tthis.setUserNickname(this.nicknameCfgTab[random].boyname);\n\t\t} else if (this.sendRegisterData.roleID == 1002) {\n\t\t\tthis.setUserNickname(this.nicknameCfgTab[random].girlname);\n\t\t}\n\t}\n}\n//视图, 界面显示或动画，在这里完成\nclass View extends BaseView {\n\tprotected model: Model;\n\tprotected node: cc.Node;\n\tpublic ui = {\n\t\tbtn_sex: ctrl.btn_sex,\n\t\tbtn_register: ctrl.btn_register,\n\t\tnickname_input: ctrl.nickname_input,\n\t\tbtn_random: ctrl.btn_random,\n\t}\n\tconstructor(model) {\n\t\tsuper(model);\n\t\tthis.node = ctrl.node;\n\t\tthis.initUi();\n\t}\n\t//初始化ui\n\tpublic initUi() {\n\t\t\n\t}\n\n\t//刷新选择的性别\n\tpublic refreshSexBtn(sex: number): void {\n\t\tif (this.model.sendRegisterData.roleID == sex) { return }\n\t\tthis.model.setChoiceSexState(sex);\n\t}\n\n\t//选择性别的按钮处理\n\tpublic selectSexBtn(sex: number, picPath: string): void {\n\t\tthis.loadImage(picPath).then((sprf: cc.SpriteFrame) => {\n\t\t\tthis.ui.btn_sex.children[sex].getComponent(cc.Sprite).spriteFrame = sprf;\n\t\t});\n\t}\n\n\t//随机昵称显示\n\tpublic showRandomNickname(): void {\n\t\tthis.model.randomNickname();\n\t\tthis.ui.nickname_input.string = this.model.sendRegisterData.nickname;\n\t}\n}\n//c, 控制\n@ccclass\nexport default class RegisterCtrl extends BaseCtrl {\n\tprotected view: View;\n\tprotected model: Model;\n\t//这边去声明ui组件\n\t@property(cc.Node)\n\tbtn_sex: cc.Node = null;\n\t@property(cc.Button)\n\tbtn_register: cc.Button = null;\n\t@property(cc.EditBox)\n\tnickname_input: cc.EditBox = null;\n\t@property(cc.Button)\n\tbtn_random: cc.Button = null\n\t//声明ui组件end\n\t//这是ui组件的map,将ui和控制器或试图普通变量分离\n\n\n\tonLoad() {\n\t\t// 控制器\n\t\tctrl = this;\n\t\t// 创建mvc模式中模型和视图\n\t\tthis.initMvc(Model, View);\n\n\t\t// 直接设置玩家UID和昵称（临时）\n\t\tlet UID = UserMgr.getInstance().user.userUID;\n\t\tthis.model.setUserData(UID);\n\t}\n\n\t//定义网络事件\n\tprotected defineNetEvents() {\n\t\tthis.n_events = {};\n\t}\n\t//定义全局事件\n\tprotected defineGlobalEvents() {\n\t\tthis.g_events = {};\n\t}\n\t//绑定操作的回调\n\tconnectUi() {\n\t\tfor (let i = 0; i < 2; i++) {\n\t\t\tthis.connect(\"toggle\", this.ui.btn_sex.children[i], () => {\n\t\t\t\tthis.view.refreshSexBtn(i + 1);\n\t\t\t}, `点击选择角色按钮${i}`);\n\t\t}\n\t\tthis.connect(\"click\", this.ui.btn_register, () => {\n\t\t\tthis._sendRegisterUser();\n\t\t}, \"创建角色\");\n\t\tthis.connect(\"editing-did-ended\", this.ui.nickname_input, () => {\n\t\t\tthis.model.setUserNickname(this.ui.nickname_input.string);\n\t\t}, \"修改玩家昵称\");\n\t\tthis.connect(\"click\",this.ui.btn_random,()=>{\n\t\t\tthis.view.showRandomNickname();\n\t\t},\"随机昵称\");\n\t}\n\t// 网络事件回调begin\n\t// end\n\t// 全局事件回调begin\n\t// end\n\t// 按钮或任何控件操作的回调begin\n\tprivate _sendRegisterUser(): void {\n\t\tlet { nickname, roleID } = this.model.sendRegisterData;\n\t\tLoginMgr.getInstance().sendRegisterUser(nickname, roleID);\n\t}\n\t// end\n\n\tonDestroy() {\n\t\tsuper.onDestroy();\n\t}\n}"]}