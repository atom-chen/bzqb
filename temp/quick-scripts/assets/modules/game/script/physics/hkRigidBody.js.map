{"version":3,"sources":["hkRigidBody.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\modules\\game\\script\\physics","sourcesContent":["import HkPhysics from \"./hkPhysics\";\nlet hkPhysics = HkPhysics.getInstance();\nimport config from \"../common/gameConfig\";\n/*\nauthor: 黄凯\n日期:2018-11-19\n*/\nconst { physicsConfig } = config;\n\nconst { ccclass, property } = cc._decorator;\n\n// 简单的刚体\n@ccclass\nexport default class rigidbody extends cc.Component{\n\tmass:number;\n\tforce:any;\n\t// realPoi:any;\n\tlineVelocity:any;\n\t// 是否启用\n\tbodyEnable:boolean = true;\n\t// 监听真实值发生变化\n\tconstructor(){\n\t\tsuper();\n\t\tthis.mass = 1;\n\t\tthis.force = {\n\t\t\tx:0,\n\t\t\ty:0\n\t\t};\n\t\tthis.lineVelocity = {\n\t\t\tx:0,\n\t\t\ty:0\n\t\t};\n\t}\n\n\t// 设置线性速度\n\tpublic setLineVelocity(vector:any){\n\t\tthis.lineVelocity.x = vector.x;\n\t\tthis.lineVelocity.y = vector.y;\n\t}\n\t// 设置力度\n\tpublic setForce(force:any){\n\t\tthis.force.x = force.x;\n\t\tthis.force.y = force.y;\n\t}\n\t// 增量\n\tpublic applyForce(force:any){\n\t\tthis.force.x += force.x;\n\t    this.force.y += force.y;\n\t}\n\t// 增量\n\tpublic applyLineVelocity(vector:any){\n\t\tthis.lineVelocity.x += vector.x;\n\t    this.lineVelocity.y += vector.y;\n\t}\n\n\tonEnable(){\n\t\tif(hkPhysics){\n\t\t\thkPhysics.addBody(this);\n\t\t}\n\t}\n\n\tonDisable(){\n\t\tif(hkPhysics){\n\t\t\thkPhysics.removeBody(this);\n\t\t}\n\t}\n\n\t// 施加重力\n\tprivate addGravity(){\n\t\tthis.force.x = Math.round(this.force.x*1000 + this.mass * (physicsConfig.gravity.x*1000))/1000;\n\t    this.force.y = Math.round(this.force.y*1000 + this.mass * (physicsConfig.gravity.y*1000))/1000;\n\t}\n\n\t// 立转化成速度\n\tprivate addAllForce(){\n\n\t    this.lineVelocity.x = Math.round(this.lineVelocity.x*1000 + this.force.x / this.mass*1000)/1000;\n\t    this.lineVelocity.y = Math.round(this.lineVelocity.y*1000 + this.force.y / this.mass*1000)/1000;\n\t}\n\n\t// 运行计算\n\tpublic step(){\n\n\t\tif(!this.bodyEnable){return;}\n\n\t\tthis.addGravity();\n\t\tthis.addAllForce();\n\n\t    if(this.node[\"realPoi\"]){\n\t\t    this.node[\"realPoi\"].x += Math.round(this.lineVelocity.x / physicsConfig.physicsScale);\n\t\t    this.node[\"realPoi\"].y += Math.round(this.lineVelocity.y / physicsConfig.physicsScale);\n\t    }else{\n\t\t    this.node.x += Math.round(this.lineVelocity.x / physicsConfig.physicsScale);\n\t\t    this.node.y += Math.round(this.lineVelocity.y / physicsConfig.physicsScale);\n\t    }\n\t}\n}"]}