{"version":3,"sources":["setting.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\modules\\public\\script","sourcesContent":["import BaseModel from \"../../../framework/baseClass/BaseModel\";\r\nimport BaseView from \"../../../framework/baseClass/BaseView\";\r\nimport BaseCtrl from \"../../../framework/baseClass/BaseCtrl\";\r\nimport Audio from \"../../../framework/modules/Audio\";\r\nimport LoginMgr from \"../../../manager/public/loginMgr\";\r\n\r\n/*\r\nauthor: 张志强\r\n日期:2018-11-09 18:35:49\r\n*/\r\n\r\n//MVC模块,\r\nconst { ccclass, property } = cc._decorator;\r\nlet ctrl: SettingCtrl;\r\n//模型，数据处理\r\nclass Model extends BaseModel {\r\n\tpublic bgmEnable: boolean;\r\n\tpublic soundEnable: boolean;\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis._initState();\r\n\t}\r\n\r\n\tprivate _initState(): void {\r\n\t\tlet audioSe = Audio.getInstance().getAudioState();\r\n\t\tthis.bgmEnable = audioSe.bgmEnable;\r\n\t\tthis.soundEnable = audioSe.soundEnable;\r\n\t}\r\n\r\n\tpublic refreshState(key: string, state: boolean): void {\r\n\t\tswitch (key) {\r\n\t\t\tcase \"music\": this._changeMusic(state); break;\r\n\t\t\tcase \"effect\": this._changeEffect(state); break;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate _changeMusic(bool: boolean): void {\r\n\t\tthis.bgmEnable = bool;\r\n\t\tif (this.bgmEnable) {\r\n\t\t\tAudio.getInstance().openBgm();\r\n\t\t} else {\r\n\t\t\tAudio.getInstance().closeBgm();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate _changeEffect(bool: boolean): void {\r\n\t\tthis.soundEnable = bool;\r\n\t\tif (this.soundEnable) {\r\n\t\t\tAudio.getInstance().openSoundEffect();\r\n\t\t} else {\r\n\t\t\tAudio.getInstance().closeSoundEffect();\r\n\t\t}\r\n\t}\r\n}\r\n//视图, 界面显示或动画，在这里完成\r\nclass View extends BaseView {\r\n\tprotected model: Model;\r\n\tprotected node: cc.Node;\r\n\tpublic ui = {\r\n\t\t//在这里声明ui\r\n\t\tmusicTgl: ctrl.musicTgl,\r\n\t\teffectTgl: ctrl.effectTgl,\r\n\t\tfriendTgl: ctrl.friendTgl,\r\n\t\tbarrageTgl: ctrl.barrageTgl,\r\n\t\tswitchBtn: ctrl.switchBtn,\r\n\t\tbindingBtn: ctrl.bindingBtn,\r\n\t\tcloseBtn: ctrl.closeBtn\r\n\t}\r\n\tconstructor(model) {\r\n\t\tsuper(model);\r\n\t\tthis.node = ctrl.node;\r\n\t\tthis.initUi();\r\n\t}\r\n\t//初始化ui\r\n\tpublic initUi() {\r\n\t\tthis.ui.musicTgl.isChecked = this.model.bgmEnable;\r\n\t\tthis.ui.musicTgl.node.getChildByName(\"background\").active = !this.model.bgmEnable;\r\n\t\tthis.ui.effectTgl.isChecked = this.model.soundEnable;\r\n\t\tthis.ui.effectTgl.node.getChildByName(\"background\").active = !this.model.soundEnable;\r\n\t}\r\n}\r\n//c, 控制\r\n@ccclass\r\nexport default class SettingCtrl extends BaseCtrl {\r\n\tprotected view: View;\r\n\tprotected model: Model;\r\n\t//这边去声明ui组件\r\n\t@property(cc.Toggle)\r\n\tmusicTgl: cc.Toggle = null;\r\n\t@property(cc.Toggle)\r\n\teffectTgl: cc.Toggle = null;\r\n\t@property(cc.Toggle)\r\n\tfriendTgl: cc.Toggle = null;\r\n\t@property(cc.Toggle)\r\n\tbarrageTgl: cc.Toggle = null;\r\n\t@property(cc.Node)\r\n\tswitchBtn: cc.Node = null;\r\n\t@property(cc.Node)\r\n\tbindingBtn: cc.Node = null;\r\n\t@property(cc.Node)\r\n\tcloseBtn: cc.Node = null;\r\n\t//声明ui组件end\r\n\t//这是ui组件的map,将ui和控制器或试图普通变量分离\r\n\r\n\tonLoad() {\r\n\t\t// 控制器\r\n\t\tctrl = this;\r\n\t\t// 创建mvc模式中模型和视图\r\n\t\tthis.initMvc(Model, View);\r\n\t}\r\n\r\n\t//定义网络事件\r\n\tprotected defineNetEvents() {\r\n\t\tthis.n_events = {};\r\n\t}\r\n\t//定义全局事件\r\n\tprotected defineGlobalEvents() {\r\n\t\tthis.g_events = {};\r\n\t}\r\n\t//绑定操作的回调\r\n\tconnectUi() {\r\n\t\tthis.connect(\"toggle\", this.ui.musicTgl, this._toggleCB, \"点击设置音乐开关\");\r\n\t\tthis.connect(\"toggle\", this.ui.effectTgl, this._toggleCB, \"点击设置音效开关\");\r\n\t\tthis.connect(\"toggle\", this.ui.friendTgl, this._friendTglCB, \"点击设置是否允许添加好友开关\");\r\n\t\tthis.connect(\"toggle\", this.ui.barrageTgl, this._barrageTglCB, \"点击设置弹幕开关\");\r\n\t\tthis.connect(\"click\", this.ui.switchBtn, this._switchBtnCB, \"点击设置切换账号按钮\");\r\n\t\tthis.connect(\"click\", this.ui.bindingBtn, this._bindingBtnCB, \"点击设置绑定账号按钮\");\r\n\t\tthis.connect(\"click\", this.ui.closeBtn, this._closeBtnCB, \"点击设置界面关闭按钮\");\r\n\t}\r\n\t//网络事件回调begin\r\n\t//end\r\n\t//全局事件回调begin\r\n\t//end\r\n\t//按钮或任何控件操作的回调begin\r\n\tprivate _toggleCB(event: cc.Event): void {\r\n\t\tlet bool = event.target.getComponent(cc.Toggle).isChecked;\r\n\t\tevent.target.getChildByName(\"background\").active = !bool;\r\n\t\tthis.model.refreshState(event.target.name, bool);\r\n\t}\r\n\r\n\tprivate _friendTglCB(): void {\r\n\r\n\t}\r\n\r\n\tprivate _barrageTglCB(): void {\r\n\r\n\t}\r\n\r\n\tprivate _switchBtnCB(): void {\r\n\t\tLoginMgr.getInstance().switchAccount();\r\n\t}\r\n\r\n\tprivate _bindingBtnCB(): void {\r\n\r\n\t}\r\n\r\n\tprivate _closeBtnCB(): void {\r\n\t\tthis.remove();\r\n\t}\r\n\t//end\r\n\r\n\t// update(dt) {}\r\n\r\n\tonDestroy() {\r\n\t\tsuper.onDestroy();\r\n\t}\r\n}"]}