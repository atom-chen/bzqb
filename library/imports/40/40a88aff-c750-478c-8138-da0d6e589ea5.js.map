{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\framework\\lib/assets\\framework\\lib\\PlatSdk.js"],"names":["platUrl","successcb","failcb","xhr","cc","loader","getXMLHttpRequest","onreadystatechange","readyState","status","JSON","parse","responseText","timeout","ontimeout","err","onerror","PlatSdk","url","route","msg","open","setRequestHeader","newMsg","head","uid","token","body","send","stringify","obj","data","success","fail","_platReq","window","platSdk"],"mappings":";;;;;;;;;;AAAA,CAAC,YAAY;AACT,QAAIA,UAAU,IAAd;AACA,QAAIC,YAAY,IAAhB;AACA,QAAIC,SAAS,IAAb;AACA,QAAIC,MAAMC,GAAGC,MAAH,CAAUC,iBAAV,EAAV;AACAH,QAAII,kBAAJ,GAAyB,YAAM;AAC3B,YAAIJ,IAAIK,UAAJ,KAAmB,CAAnB,IAAyBL,IAAIM,MAAJ,IAAc,GAAd,IAAqBN,IAAIM,MAAJ,GAAa,GAA/D,EAAqE;AACjE,gBAAIR,SAAJ,EAAeA,UAAUS,KAAKC,KAAL,CAAWR,IAAIS,YAAf,CAAV;AAClB;AACJ,KAJD;AAKAT,QAAIU,OAAJ,GAAc,IAAd;AACAV,QAAIW,SAAJ,GAAgB,UAACC,GAAD,EAAS;AACrB,YAAIb,MAAJ,EAAYA,OAAOa,GAAP;AACf,KAFD;AAGAZ,QAAIa,OAAJ,GAAc,UAACD,GAAD,EAAS;AACnB,YAAIb,MAAJ,EAAYA,OAAOa,GAAP;AACf,KAFD;;AAdS,QAiBHE,OAjBG;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,uCAkBMC,GAlBN,EAkBW;AACZlB,0BAAUkB,GAAV;AACH;AApBI;AAAA;AAAA,yCAqBQ;AACT,uBAAOlB,OAAP;AACH;AAvBI;AAAA;AAAA,qCAwBImB,KAxBJ,EAwBuB;AAAA,oBAAZC,GAAY,uEAAN,IAAM;;AACxBjB,oBAAIkB,IAAJ,CAAS,MAAT,EAAiBrB,OAAjB,EAA0B,IAA1B;AACAG,oBAAImB,gBAAJ,CAAqB,cAArB,EAAqC,gCAArC;AACA,oBAAIC,SAAS;AACTC,0BAAM;AACFL,yCAAeA,KADb;AAEFM,6BAAK,GAFH;AAGFC,+BAAO;AAHL,qBADG;AAMTC,0BAAMP;AANG,iBAAb;AAQAjB,oBAAIyB,IAAJ,CAASlB,KAAKmB,SAAL,CAAeN,MAAf,CAAT;AACH;AApCI;AAAA;AAAA,kCAqCCO,GArCD,EAqCM;AAAA,oBACDC,IADC,GACuBD,GADvB,CACDC,IADC;AAAA,oBACKC,OADL,GACuBF,GADvB,CACKE,OADL;AAAA,oBACcC,IADd,GACuBH,GADvB,CACcG,IADd;;AAEPhC,4BAAY+B,OAAZ;AACA9B,yBAAS+B,IAAT;AACA,qBAAKC,QAAL,CAAc,OAAd,EAAuBH,IAAvB;AACH;AA1CI;AAAA;AAAA,qCA2CID,GA3CJ,EA2CS;AAAA,oBACJC,IADI,GACoBD,GADpB,CACJC,IADI;AAAA,oBACEC,OADF,GACoBF,GADpB,CACEE,OADF;AAAA,oBACWC,IADX,GACoBH,GADpB,CACWG,IADX;;AAEVhC,4BAAY+B,OAAZ;AACA9B,yBAAS+B,IAAT;AACA,qBAAKC,QAAL,CAAc,UAAd,EAA0BH,IAA1B;AACH;AAhDI;AAAA;AAAA,yCAiDQD,GAjDR,EAiDa;AAAA,oBACRE,OADQ,GACUF,GADV,CACRE,OADQ;AAAA,oBACCC,IADD,GACUH,GADV,CACCG,IADD;;AAEdhC,4BAAY+B,OAAZ;AACA9B,yBAAS+B,IAAT;AACA,qBAAKC,QAAL,CAAc,SAAd;AACH;AAtDI;AAAA;AAAA,0CAuDS;AACV;AACH;AAzDI;AAAA;AAAA,sCA0DK;AACN;AACH;AA5DI;;AAAA;AAAA;;AA8DTC,WAAOC,OAAP,GAAiB,IAAInB,OAAJ,EAAjB;AACH,CA/DD","file":"PlatSdk.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\framework\\lib","sourcesContent":["(function () {\r\n    let platUrl = null;\r\n    let successcb = null;\r\n    let failcb = null;\r\n    let xhr = cc.loader.getXMLHttpRequest();\r\n    xhr.onreadystatechange = () => {\r\n        if (xhr.readyState === 4 && (xhr.status >= 200 && xhr.status < 300)) {\r\n            if (successcb) successcb(JSON.parse(xhr.responseText));\r\n        }\r\n    };\r\n    xhr.timeout = 3000;\r\n    xhr.ontimeout = (err) => {\r\n        if (failcb) failcb(err);\r\n    }\r\n    xhr.onerror = (err) => {\r\n        if (failcb) failcb(err);\r\n    }\r\n    class PlatSdk {\r\n        setPlatUrl(url) {\r\n            platUrl = url;\r\n        }\r\n        getPlatUrl() {\r\n            return platUrl;\r\n        }\r\n        _platReq(route, msg = null) {\r\n            xhr.open(\"POST\", platUrl, true);\r\n            xhr.setRequestHeader(\"Content-Type\", \"application/json;charset=utf-8\");\r\n            let newMsg = {\r\n                head: {\r\n                    route: `http.${route}`,\r\n                    uid: \"0\",\r\n                    token: \"\"\r\n                },\r\n                body: msg\r\n            }\r\n            xhr.send(JSON.stringify(newMsg));\r\n        }\r\n        login(obj) {\r\n            let { data, success, fail } = obj;\r\n            successcb = success;\r\n            failcb = fail;\r\n            this._platReq(\"login\", data);\r\n        }\r\n        register(obj) {\r\n            let { data, success, fail } = obj;\r\n            successcb = success;\r\n            failcb = fail;\r\n            this._platReq(\"register\", data);\r\n        }\r\n        touristLogin(obj) {\r\n            let { success, fail } = obj;\r\n            successcb = success;\r\n            failcb = fail;\r\n            this._platReq(\"tourist\");\r\n        }\r\n        wechatLogin() {\r\n            // 待实现\r\n        }\r\n        QQLoign() {\r\n            // 待实现\r\n        }\r\n    }\r\n    window.platSdk = new PlatSdk();\r\n})();"]}