{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\assets\\modules\\plaza\\script\\main/assets\\modules\\plaza\\script\\main\\middleMain.ts"],"names":[],"mappings":";;;;;AAAA,uEAAkE;AAClE,qEAAgE;AAChE,qEAAgE;AAChE,4DAAuD;AACvD,iEAA4D;AAC5D,8DAAyD;AACzD,8DAAyD;AACzD,8DAAyD;AACzD,qEAAgE;AAEhE,6DAA4D;AAC5D,8DAAyD;AACzD,kEAA6D;AAC7D,8DAAyD;AACzD;;;EAGE;AACF,QAAQ;AACF,IAAA,kBAAqC,EAAnC,oBAAO,EAAE,sBAAQ,CAAmB;AAC5C,IAAI,IAAoB,CAAC;AACzB,IAAI,MAAM,GAAG,gBAAM,CAAC,WAAW,EAAE,CAAC;AAClC,IAAI,OAAO,GAAG,iBAAO,CAAC,WAAW,EAAE,CAAC;AACpC,SAAS;AACT;IAAoB,yBAAS;IAC5B;QAAA,YACC,iBAAO,SACP;QACM,UAAI,GAAQ,iBAAO,CAAC,WAAW,EAAE,CAAC,IAAI,CAAC;QAC9C,gBAAgB;QAChB,eAAS,GAAG,IAAI,CAAC;QACjB,sBAAgB,GAAW,IAAI,CAAC,CAAA,QAAQ;QACxC,yBAAmB,GAAG,IAAI,CAAC,CAAA,mBAAmB;QAC9C,sBAAgB,GAAG,IAAI,CAAC;QACxB,iBAAW,GAAG,IAAI,CAAC;QAEnB,gBAAgB;QAChB,YAAM,GAAG,IAAI,CAAC;QACd,sBAAgB,GAAG,IAAI,CAAC,CAAA,kBAAkB;QAC1C,mBAAa,GAAW,CAAC,CAAC,CAAA,QAAQ;;IAZlC,CAAC;IAaD,MAAM;IACC,iCAAiB,GAAxB;QACC,IAAI,CAAC,SAAS,GAAG,MAAM,CAAC,SAAS,CAAC;QAClC,IAAI,CAAC,WAAW,GAAG,iBAAO,CAAC,WAAW,EAAE,CAAC,cAAc,EAAE,CAAC;QAC1D,IAAI,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,QAAQ,GAAG,CAAC,EAAE;YAClD,IAAI,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC;YACxC,OAAO,CAAC,GAAG,CAAC,UAAU,EAAE,SAAS,CAAC,CAAA;YAClC,2BAA2B;YAC3B,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,SAAS,CAAC,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC,IAAI,GAAG,IAAI,CAAC;SAC7G;IACF,CAAC;IACM,sCAAsB,GAA7B;QACC,IAAI,UAAU,GAAG,IAAI,CAAC,GAAG,EAAE,GAAG,IAAI,CAAC,WAAW,CAAC;QAC/C,IAAI,cAAc,GAAG,IAAI,CAAC,gBAAgB,GAAG,UAAU,CAAC;QACxD,cAAc,GAAG,cAAc,GAAG,CAAC,CAAC,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,CAAC;QACzD,IAAI,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,cAAc,GAAG,IAAI,CAAC,GAAG,IAAI,CAAC,CAAA;QACrD,IAAI,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,cAAc,GAAG,IAAI,CAAC,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC,CAAA;QAC9D,IAAI,KAAK,GAAG,IAAI,IAAI,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,GAAG,IAAI,CAAC;QAC3C,IAAI,OAAO,GAAG,MAAM,IAAI,EAAE,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,GAAG,GAAG,MAAM,CAAC;QACnD,IAAI,CAAC,gBAAgB,GAAG,cAAc,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAU,CAAC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC,IAAI,GAAG,IAAI,CAAC,CAAC;QAClH,IAAI,CAAC,mBAAmB,GAAG,KAAK,GAAG,GAAG,GAAG,OAAO,CAAC;IAClD,CAAC;IACD,MAAM;IACC,8BAAc,GAArB;QACC,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC;QAC5B,IAAI,IAAI,CAAC,MAAM,EAAE;YAChB,IAAI,YAAY,GAAG,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,WAAW,CAAC,KAAK,CAAC;YACzD,IAAI,YAAY,GAAG,CAAC,CAAC,CAAA,uBAAuB;YAC5C,IAAI,CAAC,gBAAgB,GAAG,YAAY,GAAG,GAAG,GAAG,YAAY,CAAA;YACzD,IAAI,CAAC,aAAa,GAAG,YAAY,GAAG,YAAY,CAAC;SACjD;IACF,CAAC;IACF,YAAC;AAAD,CAhDA,AAgDC,CAhDmB,mBAAS,GAgD5B;AACD,mBAAmB;AACnB;IAAmB,wBAAQ;IA2B1B,cAAY,KAAK;QAAjB,YACC,kBAAM,KAAK,CAAC,SAGZ;QA5BM,QAAE,GAAG;YACX,SAAS;YACT,SAAS,EAAE,IAAI,CAAC,SAAS;YACzB,WAAW,EAAE,IAAI,CAAC,WAAW;YAC7B,SAAS,EAAE,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,UAAU,CAAC;YAC/C,MAAM,EAAE,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC;YAC7C,cAAc,EAAE,IAAI,CAAC,cAAc;YACnC,QAAQ,EAAE,IAAI,CAAC,QAAQ;YACvB,YAAY,EAAE,IAAI,CAAC,YAAY;YAC/B,UAAU,EAAE,IAAI,CAAC,UAAU;YAC3B,aAAa,EAAE,IAAI,CAAC,aAAa;YACjC,mBAAmB,EAAE,IAAI,CAAC,mBAAmB;YAC7C,QAAQ,EAAE,IAAI,CAAC,QAAQ;YACvB,YAAY,EAAE,IAAI,CAAC,YAAY;YAC/B,UAAU,EAAE,IAAI,CAAC,UAAU;YAC3B,aAAa,EAAE,IAAI,CAAC,aAAa;YACjC,OAAO;YACP,kBAAkB,EAAE,IAAI,CAAC,kBAAkB;YAC3C,eAAe,EAAE,IAAI,CAAC,eAAe;YACrC,QAAQ;YACR,oBAAoB,EAAE,IAAI,CAAC,oBAAoB;YAC/C,gBAAgB,EAAE,IAAI,CAAC,gBAAgB;YACvC,OAAO,EAAE,IAAI,CAAC,OAAO;SACrB,CAAA;QAGA,KAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC;QACtB,KAAI,CAAC,MAAM,EAAE,CAAC;;IACf,CAAC;IACD,OAAO;IACA,qBAAM,GAAb;QACC,IAAI,CAAC,WAAW,CAAC,iBAAO,CAAC,WAAW,EAAE,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC;IACvD,CAAC;IACD,WAAW;IACX,8BAAe,GAAf,UAAgB,GAAa,EAAE,OAAe;QAC7C,GAAG,CAAC,MAAM,GAAG,OAAO,CAAC;IACtB,CAAC;IACD,OAAO;IACP,2BAAY,GAAZ,UAAa,GAAc,EAAE,OAAe;QAC3C,GAAG,CAAC,SAAS,GAAG,OAAO,CAAC;IACzB,CAAC;IAED,QAAQ;IACD,0BAAW,GAAlB,UAAmB,MAAc;QAAjC,iBAaC;QAZA,IAAI,YAAY,GAAG,iBAAO,CAAC,WAAW,EAAE,CAAC,SAAS,CAAC;QACnD,IAAI,EAAE,GAAG,IAAI,CAAC;QACd,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,YAAY,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YAC7C,IAAI,QAAQ,GAAG,YAAY,CAAC,CAAC,CAAC,CAAC;YAC/B,IAAI,MAAM,IAAI,QAAQ,CAAC,EAAE,EAAE;gBAC1B,EAAE,GAAG,QAAQ,CAAC,MAAM,GAAG,IAAI,CAAC;gBAC5B,MAAM;aACN;SACD;QACD,IAAI,CAAC,SAAS,CAAC,aAAW,EAAI,CAAC,CAAC,IAAI,CAAC,UAAC,IAAI;YACzC,KAAI,CAAC,EAAE,CAAC,OAAO,CAAC,WAAW,GAAG,IAAI,CAAC;QACpC,CAAC,CAAC,CAAC;IACJ,CAAC;IACF,WAAC;AAAD,CA5DA,AA4DC,CA5DkB,kBAAQ,GA4D1B;AACD,OAAO;AAEP;IAA4C,kCAAQ;IADpD;QAAA,qEAmOC;QA/NA,WAAW;QAEX,eAAS,GAAY,IAAI,CAAC;QAE1B,kBAAY,GAAY,IAAI,CAAC;QAE7B,mBAAa,GAAY,IAAI,CAAC;QAE9B,gBAAU,GAAY,IAAI,CAAC;QAE3B,iBAAW,GAAY,IAAI,CAAC;QAE5B,oBAAc,GAAY,IAAI,CAAC;QAE/B,cAAQ,GAAY,IAAI,CAAC;QAEzB,kBAAY,GAAY,IAAI,CAAC;QAE7B,gBAAU,GAAY,IAAI,CAAC;QAE3B,mBAAa,GAAY,IAAI,CAAC;QAE9B,yBAAmB,GAAY,IAAI,CAAC;QAEpC,cAAQ,GAAY,IAAI,CAAC;QAEzB,aAAO,GAAc,IAAI,CAAC;QAE1B,OAAO;QAEP,wBAAkB,GAAY,IAAI,CAAC;QAEnC,qBAAe,GAAY,IAAI,CAAC;QAEhC,QAAQ;QAER,0BAAoB,GAAc,IAAI,CAAC;QAEvC,sBAAgB,GAAc,IAAI,CAAC;;IAyLpC,CAAC;IArLA,WAAW;IACX,6BAA6B;IAG7B,+BAAM,GAAN;QACC,MAAM;QACN,IAAI,GAAG,IAAI,CAAC;QACZ,gBAAgB;QAChB,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;QAC1B,IAAI,CAAC,aAAa,EAAE,CAAC;QACrB,IAAI,CAAC,UAAU,EAAE,CAAC;IACnB,CAAC;IAED,QAAQ;IACE,wCAAe,GAAzB;QACC,IAAI,CAAC,QAAQ,GAAG;YACf,mBAAmB,EAAE,IAAI,CAAC,iBAAiB;YAC3C,wBAAwB,EAAE,IAAI,CAAC,WAAW;YAC1C,wBAAwB,EAAE,IAAI,CAAC,sBAAsB;YACrD,uBAAuB,EAAE,IAAI,CAAC,UAAU;YACxC,4BAA4B,EAAE,IAAI,CAAC,aAAa;YAChD,gCAAgC,EAAE,IAAI,CAAC,mBAAmB;SAC1D,CAAC;IACH,CAAC;IACD,QAAQ;IACE,2CAAkB,GAA5B;QACC,IAAI,CAAC,QAAQ,GAAG,EACf,CAAC;IACH,CAAC;IACD,SAAS;IACT,kCAAS,GAAT;QAAA,iBA4CC;QA3CA,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,IAAI,CAAC,EAAE,CAAC,SAAS,EAAE,cAAQ,KAAI,CAAC,YAAY,CAAC,UAAU,CAAC,CAAA,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAC;QAC5F,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,IAAI,CAAC,EAAE,CAAC,YAAY,EAAE,cAAQ,KAAI,CAAC,YAAY,CAAC,YAAY,CAAC,CAAA,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAC;QACjG,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,IAAI,CAAC,EAAE,CAAC,aAAa,EAAE,IAAI,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAC;QACvE,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,IAAI,CAAC,EAAE,CAAC,UAAU,EAAE,IAAI,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;QAEjE,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,IAAI,CAAC,EAAE,CAAC,WAAW,EAAE,cAAQ,KAAI,CAAC,YAAY,CAAC,SAAS,CAAC,CAAA,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAC;QAC7F,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,IAAI,CAAC,EAAE,CAAC,SAAS,EAAE,cAAQ,KAAI,CAAC,YAAY,CAAC,OAAO,CAAC,CAAA,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAC;QACzF,EAAE;QACF,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,IAAI,CAAC,EAAE,CAAC,MAAM,EAAE,cAAQ,KAAI,CAAC,YAAY,CAAC,IAAI,CAAC,CAAA,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAA;QAElF,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,IAAI,CAAC,EAAE,CAAC,cAAc,EAAE;YAC7C,IAAI,iBAAO,CAAC,WAAW,EAAE,CAAC,OAAO,IAAI,iBAAO,CAAC,WAAW,EAAE,CAAC,SAAS,EAAE;gBACrE,KAAI,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC;gBAC1B,OAAO;aACP;YACD,+CAA+C;QAChD,CAAC,EAAE,UAAU,CAAC,CAAC;QACf,uFAAuF;QACvF,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,IAAI,CAAC,EAAE,CAAC,YAAY,EAAE,cAAQ,KAAI,CAAC,YAAY,CAAC,UAAU,CAAC,CAAA,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC;QAC7F,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,IAAI,CAAC,EAAE,CAAC,UAAU,EAAE;YACzC,IAAI,mBAAS,CAAC,WAAW,EAAE,CAAC,OAAO,IAAI,mBAAS,CAAC,WAAW,EAAE,CAAC,UAAU,CAAC,IAAI,EAAE;gBAC/E,KAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;gBAC5B,OAAO;aACP;YACD,mBAAS,CAAC,WAAW,EAAE,CAAC,iBAAiB,EAAE,CAAC;QAC7C,CAAC,EAAE,MAAM,CAAC,CAAC;QACX,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,IAAI,CAAC,EAAE,CAAC,aAAa,EAAE;YAC5C,IAAI,iBAAO,CAAC,WAAW,EAAE,CAAC,OAAO,IAAI,iBAAO,CAAC,WAAW,EAAE,CAAC,aAAa,CAAC,IAAI,EAAE;gBAC9E,KAAI,CAAC,YAAY,CAAC,WAAW,CAAC,CAAC;gBAC/B,OAAO;aACP;YACD,iBAAO,CAAC,WAAW,EAAE,CAAC,oBAAoB,EAAE,CAAC;QAC9C,CAAC,EAAE,QAAQ,CAAC,CAAC;QACb,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,IAAI,CAAC,EAAE,CAAC,mBAAmB,EAAE,cAAQ,KAAI,CAAC,YAAY,CAAC,iBAAiB,CAAC,CAAA,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAC;QAC7G,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,IAAI,CAAC,EAAE,CAAC,QAAQ,EAAE;YACvC,iBAAO,CAAC,WAAW,EAAE,CAAC,YAAY,CAAC,KAAK,CAAC,CAAA;YACzC,IAAI,iBAAO,CAAC,WAAW,EAAE,CAAC,UAAU,EAAE;gBACrC,KAAI,CAAC,YAAY,CAAC,MAAM,CAAC,CAAA;aACzB;iBACI;gBACJ,iBAAO,CAAC,WAAW,EAAE,CAAC,WAAW,EAAE,CAAC;aACpC;QACF,CAAC,EAAE,MAAM,CAAC,CAAC;IACZ,CAAC;IACD,aAAa;IACb,MAAM;IAEN,0CAAiB,GAAjB;QACC,IAAI,CAAC,aAAa,EAAE,CAAC;QACrB,mBAAS,CAAC,WAAW,EAAE,CAAC,WAAW,CAAC,MAAM,CAAC,SAAS,CAAC,CAAA;IACtD,CAAC;IACD,MAAM;IACN,+CAAsB,GAAtB;QACC,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,CAAA;IAC1B,CAAC;IACD,gBAAgB;IACT,oCAAW,GAAlB;QACC,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC;IAC3B,CAAC;IACD,KAAK;IACL,aAAa;IACb,KAAK;IACL,mBAAmB;IACnB,KAAK;IACL,MAAM;IACN,sCAAa,GAAb;QACC,IAAI,CAAC,KAAK,CAAC,iBAAiB,EAAE,CAAC;QAC/B,OAAO,CAAC,GAAG,CAAC,SAAS,EAAE,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAA;QAC5C,IAAI,IAAI,CAAC,KAAK,CAAC,SAAS,IAAI,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,QAAQ,GAAG,CAAC,EAAE;YAC9D,IAAI,CAAC,KAAK,CAAC,sBAAsB,EAAE,CAAC;YACpC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,EAAE,CAAC,oBAAoB,EAAE,IAAI,CAAC,KAAK,CAAC,gBAAgB,CAAC,CAAA;YACjF,IAAI,IAAI,CAAC,KAAK,CAAC,gBAAgB,IAAI,CAAC,EAAE;gBACrC,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,EAAE,CAAC,kBAAkB,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,EAAE,MAAM,CAAC,CAAA;aACpF;iBACI;gBACJ,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,EAAE,CAAC,kBAAkB,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,mBAAmB,CAAC,CAAA;gBAC5G,IAAI,CAAC,eAAe,EAAE,CAAC;aACvB;SACD;aACI;YACJ,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,EAAE,CAAC,kBAAkB,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,EAAE,QAAQ,CAAC,CAAA;SACtF;IACF,CAAC;IACD,wCAAe,GAAf;QAAA,iBAYC;QAXA,IAAI,CAAC,QAAQ,CAAC,UAAA,MAAM;YACnB,KAAI,CAAC,KAAK,CAAC,sBAAsB,EAAE,CAAA;YACnC,KAAI,CAAC,IAAI,CAAC,YAAY,CAAC,KAAI,CAAC,EAAE,CAAC,oBAAoB,EAAE,KAAI,CAAC,KAAK,CAAC,gBAAgB,CAAC,CAAA;YACjF,IAAI,KAAI,CAAC,KAAK,CAAC,gBAAgB,IAAI,CAAC,EAAE;gBACrC,KAAI,CAAC,IAAI,CAAC,eAAe,CAAC,KAAI,CAAC,EAAE,CAAC,kBAAkB,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,EAAE,MAAM,CAAC,CAAA;gBACpF,KAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAA;aACvB;iBACI;gBACJ,KAAI,CAAC,IAAI,CAAC,eAAe,CAAC,KAAI,CAAC,EAAE,CAAC,kBAAkB,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,EAAE,KAAI,CAAC,KAAK,CAAC,mBAAmB,CAAC,CAAA;aAC5G;QACF,CAAC,EAAE,CAAC,CAAC,CAAA;IACN,CAAC;IACD,kCAAS,GAAT;QACC,IAAI,IAAI,CAAC,KAAK,CAAC,SAAS,IAAI,IAAI,CAAC,KAAK,CAAC,gBAAgB,IAAI,CAAC,EAAE;YAC7D,EAAE,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAA;YAChB,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,UAAU,CAAC,CAAA;YACvC,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,UAAU,CAAC,CAAA;SAC/C;aACI;YACJ,EAAE,CAAC,GAAG,CAAC,YAAY,CAAC,CAAA;SACpB;IACF,CAAC;IACD,MAAM;IACN,mCAAU,GAAV;QACC,IAAI,CAAC,KAAK,CAAC,cAAc,EAAE,CAAC;QAC5B,OAAO,CAAC,GAAG,CAAC,SAAS,EAAE,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAA;QACzC,IAAI,IAAI,CAAC,KAAK,CAAC,MAAM,IAAI,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,OAAO,CAAC,iBAAiB,EAAE;YAClG,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,EAAE,CAAC,gBAAgB,EAAE,IAAI,CAAC,KAAK,CAAC,aAAa,CAAC,CAAA;YAC1E,IAAI,IAAI,CAAC,KAAK,CAAC,aAAa,IAAI,CAAC,EAAE;gBAClC,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,EAAE,CAAC,eAAe,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,EAAE,MAAM,CAAC,CAAA;aACjF;iBACI;gBACJ,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,EAAE,CAAC,eAAe,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,gBAAgB,CAAC,CAAA;aACtG;SACD;aACI;YACJ,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,EAAE,CAAC,eAAe,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,EAAE,QAAQ,CAAC,CAAA;SACnF;IACF,CAAC;IACD,+BAAM,GAAN;QACC,EAAE,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAA;IACjB,CAAC;IAED,gBAAgB;IACT,mCAAU,GAAjB,UAAkB,GAAY;QAC7B,IAAI,QAAQ,GAAG,GAAG,CAAC,aAAa,CAAC,iBAAO,CAAC,aAAa,CAAC,CAAC;QACxD,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;IACxC,CAAC;IAED,QAAQ;IACD,sCAAa,GAApB;QACC,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;IAC7B,CAAC;IAED,UAAU;IACH,4CAAmB,GAA1B;QACC,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,CAAC;IAChC,CAAC;IAED,gBAAgB;IAChB,qCAAY,GAAZ,UAAa,IAAI;QAChB,OAAO,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAA;IAChC,CAAC;IACD,kCAAS,GAAT;QACC,iBAAM,SAAS,WAAE,CAAC;IACnB,CAAC;IA5ND;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;qDACQ;IAE1B;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;wDACW;IAE7B;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;yDACY;IAE9B;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;sDACS;IAE3B;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;uDACU;IAE5B;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;0DACa;IAE/B;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;oDACO;IAEzB;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;wDACW;IAE7B;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;sDACS;IAE3B;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;yDACY;IAE9B;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;+DACkB;IAEpC;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;oDACO;IAEzB;QADC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC;mDACM;IAI1B;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;8DACiB;IAEnC;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;2DACc;IAIhC;QADC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC;gEACmB;IAEvC;QADC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC;4DACe;IAzCf,cAAc;QADlC,OAAO;OACa,cAAc,CAkOlC;IAAD,qBAAC;CAlOD,AAkOC,CAlO2C,kBAAQ,GAkOnD;kBAlOoB,cAAc","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\modules\\plaza\\script\\main","sourcesContent":["import BaseModel from \"../../../../framework/baseClass/BaseModel\";\r\nimport BaseView from \"../../../../framework/baseClass/BaseView\";\r\nimport BaseCtrl from \"../../../../framework/baseClass/BaseCtrl\";\r\nimport BoxMgr from \"../../../../manager/public/boxMgr\";\r\nimport GameNet from \"../../../../framework/modules/GameNet\";\r\nimport ItemMgr from \"../../../../manager/public/itemMgr\";\r\nimport RoleMgr from \"../../../../manager/public/roleMgr\";\r\nimport ShopMgr from \"../../../../manager/public/shopMgr\";\r\nimport ModuleMgr from \"../../../../framework/modules/ModuleMgr\";\r\nimport Package from \"../../../../framework/net/package\";\r\nimport { dataids } from \"../../../../framework/net/dataids\";\r\nimport UserMgr from \"../../../../manager/public/userMgr\";\r\nimport SignInMgr from \"../../../../manager/public/signInMgr\";\r\nimport TaskMgr from \"../../../../manager/public/taskMgr\";\r\n/*\r\nauthor: 蒙磊\r\n日期:2018-11-02 18:03:26\r\n*/\r\n//MVC模块,\r\nconst { ccclass, property } = cc._decorator;\r\nlet ctrl: MiddleMainCtrl;\r\nlet boxMgr = BoxMgr.getInstance();\r\nlet itemMgr = ItemMgr.getInstance();\r\n//模型，数据处理\r\nclass Model extends BaseModel {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t}\r\n\tpublic user: any = UserMgr.getInstance().user;\r\n\t//-----在线宝箱-----\r\n\tonlineBox = null;\r\n\tonlineBoxPercent: number = null;//进度条百分比\r\n\tonlineBoxUnlockText = null;// 解锁进度显示文本 xx:xx  \r\n\tonlineBoxEndTime = null;\r\n\tserverDelay = null;\r\n\r\n\t//-----胜利宝箱-----\r\n\twinBox = null;\r\n\twinBoxUnlockText = null;//解锁进度显示文本 xx/xx  \r\n\twinBoxPercent: number = 0;//进度条百分比\r\n\t//在线宝箱\r\n\tpublic initOnlineBoxTime() {\r\n\t\tthis.onlineBox = boxMgr.onlineBox;\r\n\t\tthis.serverDelay = GameNet.getInstance().getServerDelay();\r\n\t\tif (this.onlineBox && this.onlineBox.boxTimes < 5) {\r\n\t\t\tlet openTimes = this.onlineBox.boxTimes;\r\n\t\t\tconsole.log(\"在线宝箱打开次数\", openTimes)\r\n\t\t\t//解锁的时间（毫秒）       解锁所需时间（秒）\r\n\t\t\tthis.onlineBoxEndTime = this.onlineBox.unlockTime + this.onlineBox.boxInfo.Onlinetime[openTimes].time * 1000;\r\n\t\t}\r\n\t}\r\n\tpublic setUnlockOnlineBoxTime() {\r\n\t\tlet serverTime = Date.now() + this.serverDelay;\r\n\t\tlet unlockNeedTime = this.onlineBoxEndTime - serverTime;\r\n\t\tunlockNeedTime = unlockNeedTime > 0 ? unlockNeedTime : 0;\r\n\t\tlet hour = Math.floor((unlockNeedTime / 1000) / 3600)\r\n\t\tlet minute = Math.floor(((unlockNeedTime / 1000) % 3600) / 60)\r\n\t\tlet hours = hour >= 10 ? hour : '0' + hour;\r\n\t\tlet minutes = minute >= 10 ? minute : '0' + minute;\r\n\t\tthis.onlineBoxPercent = unlockNeedTime / (this.onlineBox.boxInfo.Onlinetime[this.onlineBox.boxTimes].time * 1000);\r\n\t\tthis.onlineBoxUnlockText = hours + \":\" + minutes;\r\n\t}\r\n\t//胜利宝箱\r\n\tpublic initWinBoxTime() {\r\n\t\tthis.winBox = boxMgr.winBox;\r\n\t\tif (this.winBox) {\r\n\t\t\tlet winBoxMaxKey = this.winBox.boxInfo.unlock_prop.count;\r\n\t\t\tlet winBoxCurKey = 0;//itemMgr.winKey.amount\r\n\t\t\tthis.winBoxUnlockText = winBoxCurKey + \"/\" + winBoxMaxKey\r\n\t\t\tthis.winBoxPercent = winBoxCurKey / winBoxMaxKey;\r\n\t\t}\r\n\t}\r\n}\r\n//视图, 界面显示或动画，在这里完成\r\nclass View extends BaseView {\r\n\tprotected model: Model;\r\n\tprotected node: cc.Node;\r\n\tpublic ui = {\r\n\t\t//在这里声明ui\r\n\t\tbtn_match: ctrl.btn_match,\r\n\t\tbtn_friends: ctrl.btn_friends,\r\n\t\tbtn_chats: ctrl.node.getChildByName(\"btn_chat\"),\r\n\t\tbtn_gm: ctrl.node.getChildByName(\"btn_gmMgr\"),\r\n\t\tbtn_changeRose: ctrl.btn_changeRose,\r\n\t\tbtn_best: ctrl.btn_best,\r\n\t\tbtn_activity: ctrl.btn_activity,\r\n\t\tbtn_signIn: ctrl.btn_signIn,\r\n\t\tbtn_dailyTask: ctrl.btn_dailyTask,\r\n\t\tbtn_invitingFriends: ctrl.btn_invitingFriends,\r\n\t\tbtn_shop: ctrl.btn_shop,\r\n\t\tbtn_levelBox: ctrl.btn_levelBox,\r\n\t\tbtn_winBox: ctrl.btn_winBox,\r\n\t\tbtn_onlineBox: ctrl.btn_onlineBox,\r\n\t\t//label\r\n\t\tlab_onlineTimeText: ctrl.lab_onlineTimeText,\r\n\t\tlab_winTimeText: ctrl.lab_winTimeText,\r\n\t\t//sprite\r\n\t\tsp_onlineTimePercent: ctrl.sp_onlineTimePercent,\r\n\t\tsp_winBoxPercent: ctrl.sp_winBoxPercent,\r\n\t\tsp_role: ctrl.sp_role,\r\n\t}\r\n\tconstructor(model) {\r\n\t\tsuper(model);\r\n\t\tthis.node = ctrl.node;\r\n\t\tthis.initUi();\r\n\t}\r\n\t//初始化ui\r\n\tpublic initUi() {\r\n\t\tthis.refreshRole(RoleMgr.getInstance().choiceRole.id);\r\n\t}\r\n\t//显示label内容\r\n\tshowLabelString(obj: cc.Label, content: string) {\r\n\t\tobj.string = content;\r\n\t}\r\n\t//显示进度条\r\n\tshowProgress(obj: cc.Sprite, percent: number) {\r\n\t\tobj.fillRange = percent;\r\n\t}\r\n\r\n\t//刷新角色显示\r\n\tpublic refreshRole(roleId: number): void {\r\n\t\tlet roleListData = RoleMgr.getInstance().rolesData;\r\n\t\tlet id = null;\r\n\t\tfor (let i = 0; i < roleListData.length; i++) {\r\n\t\t\tlet roleData = roleListData[i];\r\n\t\t\tif (roleId == roleData.id) {\r\n\t\t\t\tid = roleData.roleId - 1001;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.loadImage(`rolePic_${id}`).then((sprf) => {\r\n\t\t\tthis.ui.sp_role.spriteFrame = sprf;\r\n\t\t});\r\n\t}\r\n}\r\n//c, 控制\r\n@ccclass\r\nexport default class MiddleMainCtrl extends BaseCtrl {\r\n\tprotected view: View;\r\n\tprotected model: Model;\r\n\t//这边去声明ui组件\r\n\t@property(cc.Node)\r\n\tbtn_match: cc.Node = null;\r\n\t@property(cc.Node)\r\n\tbtn_levelBox: cc.Node = null;\r\n\t@property(cc.Node)\r\n\tbtn_onlineBox: cc.Node = null;\r\n\t@property(cc.Node)\r\n\tbtn_winBox: cc.Node = null;\r\n\t@property(cc.Node)\r\n\tbtn_friends: cc.Node = null;\r\n\t@property(cc.Node)\r\n\tbtn_changeRose: cc.Node = null;\r\n\t@property(cc.Node)\r\n\tbtn_best: cc.Node = null;\r\n\t@property(cc.Node)\r\n\tbtn_activity: cc.Node = null;\r\n\t@property(cc.Node)\r\n\tbtn_signIn: cc.Node = null;\r\n\t@property(cc.Node)\r\n\tbtn_dailyTask: cc.Node = null;\r\n\t@property(cc.Node)\r\n\tbtn_invitingFriends: cc.Node = null;\r\n\t@property(cc.Node)\r\n\tbtn_shop: cc.Node = null;\r\n\t@property(cc.Sprite)\r\n\tsp_role: cc.Sprite = null;\r\n\r\n\t//label\r\n\t@property(cc.Node)\r\n\tlab_onlineTimeText: cc.Node = null;\r\n\t@property(cc.Node)\r\n\tlab_winTimeText: cc.Node = null;\r\n\r\n\t//sprite\r\n\t@property(cc.Sprite)\r\n\tsp_onlineTimePercent: cc.Sprite = null;\r\n\t@property(cc.Sprite)\r\n\tsp_winBoxPercent: cc.Sprite = null;\r\n\r\n\r\n\r\n\t//声明ui组件end\r\n\t//这是ui组件的map,将ui和控制器或试图普通变量分离\r\n\r\n\r\n\tonLoad() {\r\n\t\t// 控制器\r\n\t\tctrl = this;\r\n\t\t// 创建mvc模式中模型和视图\r\n\t\tthis.initMvc(Model, View);\r\n\t\tthis.initOnlineBox();\r\n\t\tthis.initWinBox();\r\n\t}\r\n\r\n\t//定义网络事件\r\n\tprotected defineNetEvents() {\r\n\t\tthis.n_events = {\r\n\t\t\t'plaza.box.openBox': this.plaza_box_openBox,\r\n\t\t\t\"plaza.role.reqRoleList\": this.reqRoleList,\r\n\t\t\t'plaza.data.reqShopInfo': this.plaza_data_reqShopInfo,\r\n\t\t\t\"plaza.role.switchRole\": this.switchRole,\r\n\t\t\t\"plaza.signin.reqSigninInfo\": this.reqSigninInfo,\r\n\t\t\t\"plaza.data.reqDailyMissionInfo\": this.reqDailyMissionInfo,\r\n\t\t};\r\n\t}\r\n\t//定义全局事件\r\n\tprotected defineGlobalEvents() {\r\n\t\tthis.g_events = {\r\n\t\t};\r\n\t}\r\n\t//绑定操作的回调\r\n\tconnectUi() {\r\n\t\tthis.connect(\"click\", this.ui.btn_match, () => { this.openPrefabCB(\"matching\") }, \"打开竞技模式\");\r\n\t\tthis.connect(\"click\", this.ui.btn_levelBox, () => { this.openPrefabCB(\"levelBoxBG\") }, \"打开等级宝箱\");\r\n\t\tthis.connect(\"click\", this.ui.btn_onlineBox, this.onlineBox, \"打开在线宝箱\");\r\n\t\tthis.connect(\"click\", this.ui.btn_winBox, this.winBox, \"打开胜利宝箱\");\r\n\r\n\t\tthis.connect(\"click\", this.ui.btn_friends, () => { this.openPrefabCB(\"friends\") }, \"打开邀请好友\");\r\n\t\tthis.connect(\"click\", this.ui.btn_chats, () => { this.openPrefabCB(\"chats\") }, \"打开聊天窗口\");\r\n\t\t//\r\n\t\tthis.connect(\"click\", this.ui.btn_gm, () => { this.openPrefabCB(\"gm\") }, \"打开GM模块\")\r\n\r\n\t\tthis.connect(\"click\", this.ui.btn_changeRose, () => {\r\n\t\t\tif (RoleMgr.getInstance().isFirst || RoleMgr.getInstance().rolesData) {\r\n\t\t\t\tthis.openPrefabCB(\"role\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t// RoleMgr.getInstance().sendReqRoleListData();\r\n\t\t}, \"发送角色列表数据\");\r\n\t\t//this.connect(\"click\", this.ui.btn_best, () => {this.openPrefabCB(\"best\")}, \"打开全场最佳\");\r\n\t\tthis.connect(\"click\", this.ui.btn_activity, () => { this.openPrefabCB(\"activity\") }, \"打开活动\");\r\n\t\tthis.connect(\"click\", this.ui.btn_signIn, () => {\r\n\t\t\tif (SignInMgr.getInstance().isFrist || SignInMgr.getInstance().signInData.list) {\r\n\t\t\t\tthis.openPrefabCB(\"signIn\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tSignInMgr.getInstance().sendReqSignInInfo();\r\n\t\t}, \"打开签到\");\r\n\t\tthis.connect(\"click\", this.ui.btn_dailyTask, () => {\r\n\t\t\tif (TaskMgr.getInstance().isFirst || TaskMgr.getInstance().dailyTaskData.list) {\r\n\t\t\t\tthis.openPrefabCB(\"dailyTask\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tTaskMgr.getInstance().sendReqDailyTaskData();\r\n\t\t}, \"打开每日任务\");\r\n\t\tthis.connect(\"click\", this.ui.btn_invitingFriends, () => { this.openPrefabCB(\"invitingFriends\") }, \"打开邀请好友\");\r\n\t\tthis.connect(\"click\", this.ui.btn_shop, () => {\r\n\t\t\tShopMgr.getInstance().setShopState(\"box\")\r\n\t\t\tif (ShopMgr.getInstance().isInitShop) {\r\n\t\t\t\tthis.openPrefabCB(\"shop\")\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tShopMgr.getInstance().reqShopInfo();\r\n\t\t\t}\r\n\t\t}, \"打开商店\");\r\n\t}\r\n\t//网络事件回调begin\r\n\t//打开宝箱\r\n\r\n\tplaza_box_openBox() {\r\n\t\tthis.initOnlineBox();\r\n\t\tModuleMgr.getInstance().showGainBox(boxMgr.boxReward)\r\n\t}\r\n\t//打开商店\r\n\tplaza_data_reqShopInfo() {\r\n\t\tthis.openPrefabCB(\"shop\")\r\n\t}\r\n\t//获取服务器发送的角色列表数据\r\n\tpublic reqRoleList(): void {\r\n\t\tthis.openPrefabCB(\"role\");\r\n\t}\r\n\t//end\r\n\t//全局事件回调begin\r\n\t//end\r\n\t//按钮或任何控件操作的回调begin\r\n\t//end\r\n\t//在线宝箱\r\n\tinitOnlineBox() {\r\n\t\tthis.model.initOnlineBoxTime();\r\n\t\tconsole.log(\"初始化在线宝箱\", this.model.onlineBox)\r\n\t\tif (this.model.onlineBox && this.model.onlineBox.boxTimes < 5) {\r\n\t\t\tthis.model.setUnlockOnlineBoxTime();\r\n\t\t\tthis.view.showProgress(this.ui.sp_onlineTimePercent, this.model.onlineBoxPercent)\r\n\t\t\tif (this.model.onlineBoxPercent == 0) {\r\n\t\t\t\tthis.view.showLabelString(this.ui.lab_onlineTimeText.getComponent(cc.Label), \"打开宝箱\")\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.view.showLabelString(this.ui.lab_onlineTimeText.getComponent(cc.Label), this.model.onlineBoxUnlockText)\r\n\t\t\t\tthis.onlineBoxTiming();\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.view.showLabelString(this.ui.lab_onlineTimeText.getComponent(cc.Label), \"已经没有宝箱\")\r\n\t\t}\r\n\t}\r\n\tonlineBoxTiming() {\r\n\t\tthis.schedule(timing => {\r\n\t\t\tthis.model.setUnlockOnlineBoxTime()\r\n\t\t\tthis.view.showProgress(this.ui.sp_onlineTimePercent, this.model.onlineBoxPercent)\r\n\t\t\tif (this.model.onlineBoxPercent == 0) {\r\n\t\t\t\tthis.view.showLabelString(this.ui.lab_onlineTimeText.getComponent(cc.Label), \"打开宝箱\")\r\n\t\t\t\tthis.unschedule(timing)\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.view.showLabelString(this.ui.lab_onlineTimeText.getComponent(cc.Label), this.model.onlineBoxUnlockText)\r\n\t\t\t}\r\n\t\t}, 1)\r\n\t}\r\n\tonlineBox() {\r\n\t\tif (this.model.onlineBox && this.model.onlineBoxPercent == 0) {\r\n\t\t\tcc.log(\"打开在线宝箱\")\r\n\t\t\tcc.log(this.model.onlineBox.id_service)\r\n\t\t\tboxMgr.openBox(this.model.onlineBox.id_service)\r\n\t\t}\r\n\t\telse {\r\n\t\t\tcc.log(\"宝箱未解锁或没有宝箱\")\r\n\t\t}\r\n\t}\r\n\t//胜利宝箱\r\n\tinitWinBox() {\r\n\t\tthis.model.initWinBoxTime();\r\n\t\tconsole.log(\"初始化胜利宝箱\", this.model.winBox)\r\n\t\tif (this.model.winBox && this.model.winBox.boxTimes < this.model.winBox.boxInfo.todayMaxOpenTimes) {\r\n\t\t\tthis.view.showProgress(this.ui.sp_winBoxPercent, this.model.winBoxPercent)\r\n\t\t\tif (this.model.winBoxPercent == 1) {\r\n\t\t\t\tthis.view.showLabelString(this.ui.lab_winTimeText.getComponent(cc.Label), \"打开宝箱\")\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.view.showLabelString(this.ui.lab_winTimeText.getComponent(cc.Label), this.model.winBoxUnlockText)\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.view.showLabelString(this.ui.lab_winTimeText.getComponent(cc.Label), \"已经没有宝箱\")\r\n\t\t}\r\n\t}\r\n\twinBox() {\r\n\t\tcc.log(\"打开胜利宝箱\")\r\n\t}\r\n\r\n\t//获取服务器发送的角色使用数据\r\n\tpublic switchRole(msg: Package): void {\r\n\t\tlet itemData = msg.getDataByType(dataids.ID_EQUIP_ROLE);\r\n\t\tthis.view.refreshRole(itemData.autoId);\r\n\t}\r\n\r\n\t//打开签到界面\r\n\tpublic reqSigninInfo(): void {\r\n\t\tthis.openPrefabCB(\"signIn\");\r\n\t}\r\n\r\n\t//打开每日任务界面\r\n\tpublic reqDailyMissionInfo(): void {\r\n\t\tthis.openPrefabCB(\"dailyTask\");\r\n\t}\r\n\r\n\t// update(dt) {}\r\n\topenPrefabCB(name) {\r\n\t\treturn this.openSubModule(name)\r\n\t}\r\n\tonDestroy() {\r\n\t\tsuper.onDestroy();\r\n\t}\r\n}"]}