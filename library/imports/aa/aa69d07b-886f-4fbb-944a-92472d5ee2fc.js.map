{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\assets\\modules\\plaza\\script\\main/assets\\modules\\plaza\\script\\main\\bottomMain.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\modules\\plaza\\script\\main","sourcesContent":["import BaseModel from \"../../../../framework/baseClass/BaseModel\";\nimport BaseView from \"../../../../framework/baseClass/BaseView\";\nimport BaseCtrl from \"../../../../framework/baseClass/BaseCtrl\";\nimport BoxMgr from \"../../../../manager/public/boxMgr\";\nimport GameNet from \"../../../../framework/modules/GameNet\";\nimport EffectMgr from \"../../../../manager/public/effectMgr\";\nimport AchievementMgr from \"../../../../manager/public/achievementMgr\";\nimport talentMgr from \"../../../../manager/public/talentMgr\";\nimport UserMgr from \"../../../../manager/public/userMgr\";\nimport GuildsMgr from \"../../../../manager/public/guildsMgr\";\n/*\nauthor: 蒙磊\n日期:2018-11-02 18:03:47\n*/\n\n//MVC模块,\nconst { ccclass, property } = cc._decorator;\nlet ctrl: BottomMainCtrl;\nlet boxMgr = BoxMgr.getInstance();\n//模型，数据处理\nclass Model extends BaseModel {\n\tconstructor() {\n\t\tsuper();\n\t}\n\tunlockingBattleBox = null;//解锁中的宝箱节点\n\tbattleBoxEndTime = null;//箱子结束时间\n\tbattleBoxUnlockTime = null;//箱子显示时间\n\t//解锁的时间（毫秒）       解锁所需时间（秒）\n\tpublic initbattleBoxEndTime(unlockTime: number, unlock_time: number) {\n\t\tthis.battleBoxEndTime = unlockTime + unlock_time * 1000;\n\t}\n\tpublic setUnlockBattleBoxTime() {\n\t\tlet serverDelay = GameNet.getInstance().getServerDelay();\n\t\tlet serverTime = Date.now() + serverDelay;\n\t\tlet unlockNeedTime = this.battleBoxEndTime - serverTime;\n\t\tunlockNeedTime = unlockNeedTime > 0 ? unlockNeedTime : 0;\n\t\tlet hour = Math.floor((unlockNeedTime / 1000) / 3600)\n\t\tlet minute = Math.floor(((unlockNeedTime / 1000) % 3600) / 60)\n\t\tlet hours = hour >= 10 ? hour : '0' + hour;\n\t\tlet minutes = minute >= 10 ? minute : '0' + minute;\n\t\tthis.battleBoxUnlockTime = hours + \":\" + minutes;\n\t}\n}\n//视图, 界面显示或动画，在这里完成\nclass View extends BaseView {\n\tprotected model: Model;\n\tprotected node: cc.Node;\n\tpublic ui = {\n\t\t//在这里声明ui\n\t\tbtn_talent: ctrl.btn_talent,\n\t\tbtn_skill: ctrl.btn_skill,\n\t\tbtn_achievement: ctrl.btn_achievement,\n\t\tbtn_guild: ctrl.btn_guild,\n\t\tbtn_ranking: ctrl.btn_ranking,\n\t\tboxList: ctrl.boxList,\n\n\n\t}\n\tconstructor(model) {\n\t\tsuper(model);\n\t\tthis.node = ctrl.node;\n\t\tthis.initUi();\n\t}\n\t//初始化ui\n\tpublic initUi() {\n\n\n\t}\n\tshowLabelString(obj: cc.Label, content: string) {\n\t\tobj.string = content;\n\t}\n\thide(obj: any) {\n\t\tobj.active = false;\n\t}\n\n\tshow(obj: any) {\n\t\tobj.active = true;\n\t}\n\n}\n//c, 控制\n@ccclass\nexport default class BottomMainCtrl extends BaseCtrl {\n\tprotected view: View;\n\tprotected model: Model;\n\t//这边去声明ui组件\n\t@property(cc.Node)\n\tbtn_talent: cc.Node = null;\n\t@property(cc.Node)\n\tbtn_skill: cc.Node = null;\n\t@property(cc.Node)\n\tbtn_achievement: cc.Node = null;\n\t@property(cc.Node)\n\tbtn_guild: cc.Node = null;\n\t@property(cc.Node)\n\tbtn_ranking: cc.Node = null;\n\t@property(cc.Node)\n\tboxList: cc.Node = null;\n\n\n\t//声明ui组件end\n\t//这是ui组件的map,将ui和控制器或试图普通变量分离\n\n\n\tonLoad() {\n\t\t// 控制器\n\t\tctrl = this;\n\t\t// 创建mvc模式中模型和视图\n\t\tthis.initMvc(Model, View);\n\t\tthis.initBox();\n\t}\n\n\t//定义网络事件\n\tprotected defineNetEvents() {\n\t\tthis.n_events = {\n\t\t\t\"plaza.teji.reqTejiInfo\": this.reqTejiInfo,\n\t\t\t\"plaza.data.reqAchieveInfo\": this.reqAchieveInfo,\n\t\t\t\"plaza.talent.reqTalentInfo\":this.reqTalentInfo,\n\t\t\t\"plaza.box.unlockBox\":this.unlockBox,\n\t\t\t\"plaza.vip.buyVipGift\":this.buyVipGift,\n\t\t};\n\t}\n\t//定义全局事件\n\tprotected defineGlobalEvents() {\n\t\tthis.g_events = {};\n\t}\n\t//绑定操作的回调\n\tconnectUi() {\n\t\tthis.connect(\"click\", this.ui.btn_talent, () => {\n\t\t\tif (talentMgr.getInstance().isInit) {\n\t\t\t\tthis.reqTalentInfo();\n\t\t\t}\n\t\t\telse {\n\t\t\t\ttalentMgr.getInstance().sendReqTalentInfo();\n\t\t\t}\n\t\t}, \"打开天赋\");\n\t\tthis.connect(\"click\", this.ui.btn_skill, () => {\n\t\t\tif (EffectMgr.getInstance().isInit) {\n\t\t\t\tthis.openPrefabCB(\"effects\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tEffectMgr.getInstance().sendReqEffectData();\n\t\t}, \"发送特技数据请求\");\n\t\tthis.connect(\"click\", this.ui.btn_achievement, () => {\n\t\t\tif (AchievementMgr.getInstance().isInit) {\n\t\t\t\tthis.reqAchieveInfo();\n\t\t\t}\n\t\t\telse {\n\t\t\t\tAchievementMgr.getInstance().sendReqAchieveInfo();\n\t\t\t}\n\t\t}, \"打开成就\");\n\t\tthis.connect(\"click\", this.ui.btn_guild, () => { \n\t\t\tlet guildId= UserMgr.getInstance().getMyInfo().guildId;\n\t\t\tif(guildId) {\n\t\t\t\tGuildsMgr.getInstance().reqMyGuildDetail();\n\t\t\t\tGuildsMgr.getInstance().reqGuildMembers(guildId,0);\n\t\t\t\tthis.openPrefabCB(\"guildsInfo\")\n\t\t\t}\n\t\t\telse this.openPrefabCB(\"guilds\") \n\t\t}, \"打开公会\");\n\t\tthis.connect(\"click\", this.ui.btn_ranking, () => { this.openPrefabCB(\"ranks\") }, \"打开排行榜\");\n\t\tthis.connectBattleBox();\n\n\t}\n\tconnectBattleBox(){\n\t\tfor (let i = 0; i <this.ui.boxList.childrenCount; i++) {\n\t\t\tthis.connect(\"click\", this.ui.boxList.children[i], () => {\n\t\t\t\tboxMgr.setCurBattleBox(i)\n\t\t\t\tif (boxMgr.battleBox[i].unlockTime == 0) {\n\t\t\t\t\tthis.openPrefabCB(\"battleBox\");\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t//boxMgr.testOpenBox(boxMgr.battleBox[i].id_service)\n\t\t\t\t}\n\t\t\t}, \"打开战斗宝箱\");\n\t\t}\n\t}\n\tpublic initBox() {\n\t\tconsole.log(boxMgr.battleBox)\n\t\tfor (let i = 0; i < this.ui.boxList.childrenCount; i++) {\n\t\t\tif (boxMgr.battleBox[i]) {\n\t\t\t\tif (boxMgr.battleBox[i].unlockTime == 0) {\n\t\t\t\t\tlet obj_string = boxMgr.battleBox[i].boxInfo.unlock_time / 3600 + \"小时\";\n\t\t\t\t\tlet obj_label = this.ui.boxList.children[i].children[0].children[0].children[0].getComponent(cc.Label)\n\t\t\t\t\tthis.view.show(this.ui.boxList.children[i].children[0])\n\t\t\t\t\tthis.view.hide(this.ui.boxList.children[i].children[1])\n\t\t\t\t\tthis.view.showLabelString(obj_label, obj_string)\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t//初始化解锁中宝箱时间\n\t\t\t\t\tthis.model.initbattleBoxEndTime(boxMgr.battleBox[i].unlockTime, boxMgr.battleBox[i].boxInfo.unlock_time)\n\t\t\t\t\tthis.model.setUnlockBattleBoxTime()\n\t\t\t\t\tthis.model.unlockingBattleBox = this.ui.boxList.children[i].children[0].children[1].children[0]\n\t\t\t\t\tlet obj_label = this.model.unlockingBattleBox.getComponent(cc.Label)\n\t\t\t\t\tthis.view.showLabelString(obj_label, this.model.battleBoxUnlockTime)\n\t\t\t\t\tthis.view.hide(this.ui.boxList.children[i].children[0].children[0])\n\t\t\t\t\tthis.view.show(this.ui.boxList.children[i].children[0].children[1])\n\t\t\t\t\tthis.unlockBattleBoxTiming(obj_label);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.view.hide(this.ui.boxList.children[i].children[0])\n\t\t\t\tthis.view.show(this.ui.boxList.children[i].children[1])\n\t\t\t}\n\t\t\n\t\t}\n\t}\n\t//解锁中宝箱计时\n\tunlockBattleBoxTiming(obj_string) {\n\t\tthis.schedule(() => {\n\t\t\tthis.model.setUnlockBattleBoxTime();\n\t\t\tthis.view.showLabelString(obj_string, this.model.battleBoxUnlockTime)\n\t\t}, 1)\n\t}\n\n\t//网络事件回调begin\n\tpublic reqTejiInfo(): void {\n\t\tthis.openPrefabCB(\"effects\");\n\t}\n\tpublic reqAchieveInfo(): void {\n\t\tthis.openPrefabCB(\"achievementBG\");\n\t}\n\tpublic reqTalentInfo(): void {\n\t\tthis.openPrefabCB(\"talentBG\");\n\t}\n\tbuyVipGift(){\n\t\tconsole.log(\"加人新战斗宝箱！！\")\n\t\tthis.initBox();\n\t}\n\tunlockBox(){\n\t\tthis.initBox();\n\t}\n\t//end\n\t//全局事件回调begin\n\t//end\n\t//按钮或任何控件操作的回调begin\n\t//end\n\topenPrefabCB(name) {\n\t\tthis.openSubModule(name)\n\t}\n\t// update(dt) {}\n\n\tonDestroy() {\n\t\tsuper.onDestroy();\n\t}\n}"]}