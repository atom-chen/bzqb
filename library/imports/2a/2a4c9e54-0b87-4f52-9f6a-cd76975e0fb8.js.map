{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\assets\\modules\\plaza\\script\\guilds/assets\\modules\\plaza\\script\\guilds\\guildsInvitedPanel.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\modules\\plaza\\script\\guilds","sourcesContent":["import BaseModel from \"../../../../framework/baseClass/BaseModel\";\r\nimport BaseView from \"../../../../framework/baseClass/BaseView\";\r\nimport BaseCtrl from \"../../../../framework/baseClass/BaseCtrl\";\r\nimport Package from \"../../../../framework/net/package\";\r\nimport { dataids } from \"../../../../framework/net/dataids\";\r\nimport { enums } from \"../../../../manager/enums\";\r\nimport GuildsMgr from \"../../../../manager/public/guildsMgr\";\r\nimport UnsettledMgr  from \"../../../../manager/public/unsettledMgr\";\r\n\r\n/*\r\nauthor: 汤凯\r\n日期:2018-11-22\r\n*/\r\n\r\n//MVC模块,\r\nconst { ccclass, property } = cc._decorator;\r\nlet ctrl: GuildsInvitedPanelCtrl;\r\n//模型，数据处理\r\nclass Model extends BaseModel {\r\n\tguildInvitedIndexInfo = UnsettledMgr.getInstance().getGuildInvited();\r\n\tguildInvitedFullInfo = null;\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tif(this.guildInvitedIndexInfo) {\r\n\t\t\tGuildsMgr.getInstance().reqGuildInviteBrief();\r\n\t\t}\r\n\t}\r\n}\r\n//视图, 界面显示或动画，在这里完成\r\nclass View extends BaseView {\r\n\tprotected model: Model;\r\n\tprotected node: cc.Node;\r\n\tpublic ui={\r\n\t\tbtn_refussAll: ctrl.btn_refussAll,\r\n\t\tbtn_close: ctrl.btn_close,\r\n\t\tpref_guildInvitedInfo: ctrl.pref_guildInvitedInfo,\r\n\t\tnode_guildInvitedInfoPanel: ctrl.node_guildInvitedInfoPanel,\r\n\t}\r\n\tconstructor(model){\r\n\t\tsuper(model);\r\n\t\tthis.node = ctrl.node;\r\n\t\tthis.initUi();\r\n\t}\r\n\t//初始化ui\r\n\tpublic initUi() {\r\n\t\tthis.addGuildInvitedInfo();\r\n\t}\r\n\taddGuildInvitedInfo(){\r\n\t\tif(this.model.guildInvitedFullInfo) {\r\n\t\t\tthis.ui.node_guildInvitedInfoPanel.destroyAllChildren();\r\n\t\t\tfor (let guildInvitedFullInfoIdx = 0; guildInvitedFullInfoIdx < this.model.guildInvitedFullInfo.length; guildInvitedFullInfoIdx++) {\r\n\t\t\t\tlet invitedData = this.model.guildInvitedFullInfo[guildInvitedFullInfoIdx];\r\n\t\t\t\tlet prefabNode = cc.instantiate(this.ui.pref_guildInvitedInfo);\r\n\t\t\t\tthis.ui.node_guildInvitedInfoPanel.addChild(prefabNode);\r\n\t\t\t\tprefabNode.getComponent('guildInviteInfo').updateInvitedInfoAndShow(invitedData);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n//c, 控制\r\n@ccclass\r\nexport default class GuildsInvitedPanelCtrl extends BaseCtrl {\r\n\tprotected view: View;\r\n\tprotected model: Model;\r\n\t//这边去声明ui组件\r\n\t@property(cc.Button)\r\n\tbtn_refussAll: cc.Button = null;\r\n\t@property(cc.Prefab)\r\n\tpref_guildInvitedInfo: cc.Prefab = null;\r\n\t@property(cc.Button)\r\n\tbtn_close: cc.Button = null;\r\n\t@property(cc.Node)\r\n\tnode_guildInvitedInfoPanel: cc.Node = null;\r\n\t//声明ui组件end\r\n\t//这是ui组件的map,将ui和控制器或试图普通变量分离\r\n\r\n\tonLoad (){\r\n\t\t// 控制器\r\n\t\tctrl = this;\r\n\t\t// 创建mvc模式中模型和视图\r\n\t\tthis.initMvc(Model,View);\r\n\t}\r\n\r\n\t//定义网络事件\r\n\tprotected defineNetEvents() {\r\n\t \tthis.n_events = {\r\n            'search.entry.reqGuildInviteBrief': this.search_entry_reqGuildInviteBrief,\r\n            'plaza.guild.agreeInvitation': this.plaza_guild_agreeInvitation,\r\n            'plaza.guild.refuseInvitation': this.plaza_guild_refuseInvitation,\r\n        };\r\n\t}\r\n\t//定义全局事件\r\n\tprotected defineGlobalEvents() {\r\n\t\tthis.g_events = {};\r\n\t}\r\n\t//绑定操作的回调\r\n\tconnectUi() {\r\n\t\t// this.connect(\"click\",this.ui.btn_close,()=>{\r\n\t\t// \tthis.closeModule(\"guilds\");\r\n\t\t// },\"关闭公会界面\");\r\n\t\tthis.connect(\"click\",this.ui.btn_refussAll,this.btnRefussAll.bind(this),\"全部拒绝\");\r\n\t\tthis.connect(\"click\",this.ui.btn_close,this.btnClose.bind(this),\"关闭\")\r\n\r\n\t}\r\n\tbtnRefussAll()\r\n\t{\r\n\t\tGuildsMgr.getInstance().refuseInvitation();\r\n\t\tconsole.log(\"全部拒绝\")\r\n\t}\r\n\tbtnClose()\r\n\t{\r\n\t\tthis.remove();\r\n\t}\r\n\tsearch_entry_reqGuildInviteBrief()\r\n\t{\r\n\t\tthis.model.guildInvitedFullInfo = GuildsMgr.getInstance().getGuildInvitedInfo();\r\n\t\tthis.view.addGuildInvitedInfo();\r\n\t}\r\n\tplaza_guild_agreeInvitation(msg:Package)\r\n\t{\r\n        let guildId = msg.getDataByType(dataids.ID_USREGUILDID_CHANGED);\r\n        console.log(\"plaza_guild_agreeInvitation\",guildId)\r\n        if(guildId) {\r\n\t\t\tGuildsMgr.getInstance().reqMyGuildDetail();\r\n\t\t\tGuildsMgr.getInstance().reqGuildMembers(guildId,0);\r\n\t\t\tthis.remove();\r\n\t\t\tthis.closeModule(\"guilds\");\r\n\t\t\tthis.openSubModule('guildsInfo');\r\n        }\r\n\t}\r\n\tplaza_guild_refuseInvitation()\r\n\t{\r\n\t\tthis.remove();\r\n\t}\r\n\t//网络事件回调begin\r\n\t//end\r\n\t//全局事件回调begin\r\n\t//end\r\n\t//按钮或任何控件操作的回调begin\r\n\t//end\r\n\r\n\t// update(dt) {}\r\n\r\n\tonDestroy() {\r\n\t\tsuper.onDestroy();\r\n\t}\r\n}"]}