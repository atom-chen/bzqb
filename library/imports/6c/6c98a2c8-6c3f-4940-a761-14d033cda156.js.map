{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\assets\\modules\\plaza\\script\\main/assets\\modules\\plaza\\script\\main\\topMain.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\modules\\plaza\\script\\main","sourcesContent":["import BaseModel from \"../../../../framework/baseClass/BaseModel\";\nimport BaseView from \"../../../../framework/baseClass/BaseView\";\nimport BaseCtrl from \"../../../../framework/baseClass/BaseCtrl\";\nimport UserMgr from \"../../../../manager/public/userMgr\";\nimport MailMgr from \"../../../../manager/public/mailMgr\";\nimport GameNet from \"../../../../framework/modules/GameNet\";\nimport cardMgr from \"../../../../manager/public/cardMgr\";\nimport VipMgr from \"../../../../manager/public/vipMgr\";\nimport ShopMgr from \"../../../../manager/public/shopMgr\";\n\n\n/*\nauthor: 蒙磊\n日期:2018-11-02 16:47:30\n*/\n\n//MVC模块,\nconst { ccclass, property } = cc._decorator;\nlet ctrl: TopMainCtrl;\nlet userMgr = UserMgr.getInstance();\n\n//模型，数据处理\nclass Model extends BaseModel {\n\tconstructor() {\n\t\tsuper();\n\t}\n\n}\n//视图, 界面显示或动画，在这里完成\nclass View extends BaseView {\n\tprotected model: Model;\n\tprotected node: cc.Node;\n\tpublic ui = {\n\t\t//在这里声明ui\n\t\t//button\n\t\tbtn_userInfoPanel: ctrl.btn_userInfoPanel,\n\t\tbtn_vip: ctrl.btn_vip,\n\t\tbtn_monthlyCard: ctrl.btn_monthlyCard,\n\t\tbtn_foreverCard: ctrl.btn_foreverCard,\n\n\t\tbtn_mail: ctrl.btn_mail,\n\t\tbtn_set: ctrl.btn_set,\n\t\t//label\n\t\n\t\tlab_level: ctrl.lab_level,\n\t\tlab_name: ctrl.lab_name,\n\t\tlab_exe: ctrl.lab_exe,\n\t\tsp_exePercent: ctrl.sp_exePercent,\n\n\t}\n\tconstructor(model) {\n\t\tsuper(model);\n\t\tthis.node = ctrl.node;\n\t\tthis.initUi();\n\t}\n\t\n\tupdateLevel() {\n\t\tthis.ui.lab_level.getComponent(cc.Label).string = (userMgr.user.grade).toString();\n\t}\n\tupdateName() {\n\t\tthis.ui.lab_name.getComponent(cc.Label).string = userMgr.user.userName\n\t}\n\tupdateExe() {\n\t\tthis.ui.lab_exe.getComponent(cc.Label).string = this.numberEllipsis(userMgr.user.userExp) + '/' + userMgr.user.experience;\n\t\tthis.showProgress(this.ui.sp_exePercent, userMgr.user.userExp / userMgr.user.experience)\n\t}\n\t//显示进度条\n\tshowProgress(obj: cc.Sprite, percent: number) {\n\t\tobj.fillRange = percent;\n\t}\n\t//初始化ui\n\tpublic initUi() {\n\t\tthis.updateLevel();\n\t\tthis.updateName();\n\t\tthis.updateExe();\n\t}\n}\n//c, 控制\n@ccclass\nexport default class TopMainCtrl extends BaseCtrl {\n\tprotected view: View;\n\tprotected model: Model;\n\t//这边去声明ui组件\n\t//button\n\t@property(cc.Node)\n\tbtn_userInfoPanel: cc.Node = null;\n\t@property(cc.Node)\n\tbtn_vip: cc.Node = null;\n\t@property(cc.Node)\n\tbtn_monthlyCard: cc.Node = null;\n\t@property(cc.Node)\n\tbtn_foreverCard: cc.Node = null;\n\t@property(cc.Node)\n\tbtn_mail: cc.Node = null;\n\t@property(cc.Node)\n\tbtn_set: cc.Node = null;\n\t//label\n\t@property(cc.Node)\n\tlab_name: cc.Node = null;\n\t@property(cc.Node)\n\tlab_exe: cc.Node = null;\n\t@property(cc.Node)\n\tlab_level: cc.Node = null;\n\t//sprite\n\t@property(cc.Sprite)\n\tsp_exePercent: cc.Sprite = null;\n\t//声明ui组件end\n\t//这是ui组件的map,将ui和控制器或试图普通变量分离\n\n\n\n\n\t//定义网络事件\n\tprotected defineNetEvents() {\n\t\tthis.n_events = {\n\t\t\t\"plaza.mail.reqMailList\": this.reqMailList,\n\t\t\t\"plaza.privilege.reqMonthlyCardInfo\": this.reqMonthlyCardInfo,\n\t\t\t\"plaza.privilege.reqLifetimeCardInfo\": this.reqLifetimeCardInfo,\n\t\t\t'plaza.vip.reqVipInfo': this.reqVipInfo,\n\t\t};\n\t}\n\t//定义全局事件\n\tprotected defineGlobalEvents() {\n\t\tthis.g_events = {\n\t\t};\n\t}\n\t\n\t//绑定操作的回调\n\tconnectUi() {\n\t\tthis.connect(\"click\", this.ui.btn_userInfoPanel, () => { this.openPrefabCB(\"userInfoPanel\") }, \"打开角色信息\");\n\t\tthis.connect(\"click\", this.ui.btn_vip, () => {\n\t\t\tif (VipMgr.getInstance().isInit) {\n\t\t\t\tthis.openPrefabCB(\"vip\")\n\t\t\t}\n\t\t\telse {\n\t\t\t\tVipMgr.getInstance().sendReqVipInfo();\n\t\t\t}\n\t\t}, \"打开vip\");\n\t\tthis.connect(\"click\", this.ui.btn_monthlyCard, () => {\n\t\t\tif (cardMgr.getInstance().monthlyIsInit) {\n\t\t\t\tthis.openPrefabCB(\"monthlyCard\")\n\t\t\t}\n\t\t\telse {\n\t\t\t\tcardMgr.getInstance().sendReqMonthlyCardInfo();\n\t\t\t}\n\t\t}, \"打开月卡\");\n\t\tthis.connect(\"click\", this.ui.btn_foreverCard, () => {\n\t\t\tif (cardMgr.getInstance().LifeIsInit) {\n\t\t\t\tthis.openPrefabCB(\"foreverCard\")\n\t\t\t}\n\t\t\telse {\n\t\t\t\tcardMgr.getInstance().sendReqLifetimeCardInfo();\n\t\t\t}\n\t\t}, \"打开永久卡\");\n\t\t\n\t\tthis.connect(\"click\", this.ui.btn_mail, () => {\n\t\t\tif (MailMgr.getInstance().isFrist || MailMgr.getInstance().mailsData.list) {\n\t\t\t\tthis.openPrefabCB(\"mails\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tMailMgr.getInstance().sendReqMailsData();\n\t\t}, \"打开邮箱\");\n\t\tthis.connect(\"click\", this.ui.btn_set, () => { this.openPrefabCB(\"setting\", true) }, \"打开设置\");\n\n\t}\n\t//网络事件回调begin\n\treqMonthlyCardInfo() {\n\t\tthis.openPrefabCB(\"monthlyCard\")\n\t}\n\treqLifetimeCardInfo() {\n\t\tthis.openPrefabCB(\"foreverCard\")\n\t}\n\treqVipInfo() {\n\t\tthis.openPrefabCB(\"vip\")\n\t}\n\t\n\t//end\n\t//全局事件回调begin\n\t//end\n\t//按钮或任何控件操作的回调begin\n\t//end\n\n\t// update(dt) {}\n\tonLoad() {\n\t\t// 控制器\n\t\tctrl = this;\n\t\t// 创建mvc模式中模型和视图\n\t\tthis.initMvc(Model, View);\n\t}\n\n\t//打开邮箱预制\n\tpublic reqMailList(): void {\n\t\tthis.openPrefabCB(\"mails\");\n\t}\n\n\topenPrefabCB(name, isPublic: boolean = false) {\n\t\treturn this.openSubModule(name, isPublic)\n\t}\n\tonDestroy() {\n\t\tsuper.onDestroy();\n\t}\n}"]}