{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\assets\\modules\\plaza\\script\\talent/assets\\modules\\plaza\\script\\talent\\suspensionframe.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\modules\\plaza\\script\\talent","sourcesContent":["import BaseModel from \"../../../../framework/baseClass/BaseModel\";\nimport BaseView from \"../../../../framework/baseClass/BaseView\";\nimport BaseCtrl from \"../../../../framework/baseClass/BaseCtrl\";\nimport talentMgr from \"../../../../manager/public/talentMgr\";\n\n/*\nauthor: 蒙磊\n日期:2018-11-19 11:15:19\n*/\n\n//MVC模块,\nconst { ccclass, property } = cc._decorator;\nlet ctrl: SuspensionframeCtrl;\n//模型，数据处理\nclass Model extends BaseModel {\n\ttalent: any = null;\n\tid: number;\n\tname: string;\n\tlevel: string;\n\tnextDes: string;\n\tcurDes: string;\n\n\tconstructor() {\n\t\tsuper();\n\t}\n\tsetData(data) {\n\t\tthis.talent = data;\n\t\tthis.id = data.id;\n\t\tthis.name = data.name;\n\t\tthis.level = \"等级:\" + data.curLevel + \"/\" + data.maxLevel\n\t\tlet curLevel = data.curLevel - 1;\n\t\tlet nextLevel = curLevel >= (data.maxLevel - 1) ? curLevel : curLevel + 1;\n\t\tif (!data.value) {\n\t\t\tif (curLevel == -1) {\n\t\t\t\tthis.curDes = \"未习得\"\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.curDes = data.des\n\t\t\t}\n\t\t\tthis.nextDes = data.des\n\t\t}\n\t\telse {\n\t\t\tif (curLevel == -1) {\n\t\t\t\tthis.curDes = \"未习得\"\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.curDes = this.stringReplace(data.des, \"X\", data.value[curLevel].value);\n\t\t\t}\n\t\t\tthis.nextDes = this.stringReplace(data.des, \"X\", data.value[nextLevel].value);\n\t\t}\n\t\tif(curLevel==nextLevel){\n\t\t\tthis.nextDes =\"当前已满级\"\n\t\t}\n\t}\n}\n//视图, 界面显示或动画，在这里完成\nclass View extends BaseView {\n\tprotected model: Model;\n\tprotected node: cc.Node;\n\tpublic ui = {\n\t\t//在这里声明ui\n\t\tlab_name: ctrl.lab_name,\n\t\tlab_level: ctrl.lab_level,\n\t\tlab_curDes: ctrl.lab_curDes,\n\t\tlab_nexDes: ctrl.lab_nexDes,\n\t\tbtn_close: ctrl.btn_close,\n\t\tbtn_levelUp: ctrl.btn_levelUp,\n\t}\n\tconstructor(model) {\n\t\tsuper(model);\n\t\tthis.node = ctrl.node;\n\t\tthis.initUi();\n\t}\n\t//初始化ui\n\tpublic initUi() {\n\n\t}\n\t//显示label内容\n\tshowLabelString(obj: cc.Label, content: string) {\n\t\tobj.string = content;\n\t}\n}\n//c, 控制\n@ccclass\nexport default class SuspensionframeCtrl extends BaseCtrl {\n\tprotected view: View;\n\tprotected model: Model;\n\t//这边去声明ui组件\n\t//label \n\t@property(cc.Label)\n\tlab_name: cc.Label = null;\n\t@property(cc.Label)\n\tlab_level: cc.Label = null;\n\t@property(cc.Label)\n\tlab_curDes: cc.Label = null;\n\t@property(cc.Label)\n\tlab_nexDes: cc.Label = null;\n\t//button\n\t@property(cc.Node)\n\tbtn_close: cc.Node = null;\n\t@property(cc.Node)\n\tbtn_levelUp: cc.Node = null;\n\t//声明ui组件end\n\t//这是ui组件的map,将ui和控制器或试图普通变量分离\n\n\n\tonLoad() {\n\t\t// 控制器\n\t\tctrl = this;\n\t\t// 创建mvc模式中模型和视图\n\t\tthis.initMvc(Model, View);\n\t}\n\n\t//定义网络事件\n\tprotected defineNetEvents() {\n\t\tthis.n_events = {\n\t\t\t'plaza.talent.learnTalent': this.learnTalent,\n\t\t};\n\t}\n\t//定义全局事件\n\tprotected defineGlobalEvents() {\n\t\tthis.g_events = {};\n\t}\n\t//绑定操作的回调\n\tconnectUi() {\n\t\tthis.connect(\"click\", this.ui.btn_levelUp, this.levelUp, \"升级天赋\");\n\t\tthis.connect(\"click\", this.ui.btn_close, this.close, \"关闭学习天赋\");\n\t}\n\t//网络事件回调begin\n\t//end\n\t//全局事件回调begin\n\t//end\n\t//按钮或任何控件操作的回调begin\n\t//end\n\t//关闭升级界面\n\tclose() {\n\t\tthis.node.destroy();\n\t\ttalentMgr.getInstance().curTalent =null;\n\t}\n\t//升级天赋按钮回调\n\tlevelUp() {\n\t\tif(talentMgr.getInstance().talentPoint<=0){\n\t\t\tconsole.log(\"没有天赋点了！\")\n\t\t}\n\t\telse if (!talentMgr.getInstance().boolStudyState(this.model.talent)) {\n\t\t\tconsole.log(\"学习天赋条件未达成\")\n\t\t}\n\t\telse {\n\t\t\ttalentMgr.getInstance().sendReqLearnTalent(this.model.id);\n\t\t}\n\t}\n\tlearnTalent() {\n\t\tthis.showData();\n\t}\n\t// update(dt) {}\n\t//设置天赋数据\n\tsetData(data) {\n\t\tthis.model.setData(data);\n\t}\n\t//显示天赋数据\n\tshowData() {\n\t\tthis.view.showLabelString(this.ui.lab_name, this.model.name)\n\t\tthis.view.showLabelString(this.ui.lab_level, this.model.level)\n\t\tthis.view.showLabelString(this.ui.lab_curDes, this.model.curDes)\n\t\tthis.view.showLabelString(this.ui.lab_nexDes, this.model.nextDes)\n\t}\n\tonDestroy() {\n\t\tsuper.onDestroy();\n\t}\n}"]}