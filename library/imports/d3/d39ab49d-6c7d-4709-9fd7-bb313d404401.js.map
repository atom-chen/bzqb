{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\assets\\modules\\plaza\\script\\shop/assets\\modules\\plaza\\script\\shop\\cardShop.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\modules\\plaza\\script\\shop","sourcesContent":["import BaseModel from \"../../../../framework/baseClass/BaseModel\";\r\nimport BaseView from \"../../../../framework/baseClass/BaseView\";\r\nimport BaseCtrl from \"../../../../framework/baseClass/BaseCtrl\";\r\nimport TableMgr from \"../../../../manager/public/tableMgr\";\r\nimport ModuleMgr from \"../../../../framework/modules/ModuleMgr\";\r\nimport ShopMgr from \"../../../../manager/public/shopMgr\";\r\n\r\n/*\r\nauthor: 蒙磊\r\n日期:2018-11-15 10:31:05\r\n*/\r\n\r\n//MVC模块,\r\nconst { ccclass, property } = cc._decorator;\r\nlet ctrl: CardShopCtrl;\r\n//模型，数据处理\r\nclass Model extends BaseModel {\r\n\tcost: number;\r\n\tcount: number;\r\n\tpriceType: number;\r\n\tname: string;\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.initData();\r\n\t}\r\n\tinitData() {\r\n\t\tthis.cost = ctrl.cost;\r\n\t\tthis.count = ctrl.count;\r\n\t\tthis.priceType = ctrl.priceType;\r\n\t\tthis.name = ctrl.name;\r\n\t}\r\n}\r\n//视图, 界面显示或动画，在这里完成\r\nclass View extends BaseView {\r\n\tprotected model: Model;\r\n\tprotected node: cc.Node;\r\n\tpublic ui = {\r\n\t\t//在这里声明ui\r\n\t\tlab_name: ctrl.lab_name,\r\n\t\tlab_cost: ctrl.lab_cost,\r\n\t\tlab_count: ctrl.lab_count,\r\n\t\tsp_price:ctrl.sp_price,\r\n\t\tsp_SpriteFrame:ctrl.sp_SpriteFrame,\r\n\t\tcardBuyShow:ctrl.cardBuyShow,\r\n\t}\r\n\tconstructor(model) {\r\n\t\tsuper(model);\r\n\t\tthis.node = ctrl.node;\r\n\t\tthis.initUi();\r\n\t}\r\n\t//初始化ui\r\n\tpublic initUi() {\r\n\t\tif (this.model.cost) {\r\n\t\t\tthis.showLabelString(this.ui.lab_cost.getComponent(cc.Label), this.model.cost.toString())\r\n\t\t}\r\n\t\tif (this.model.count) {\r\n\t\t\tthis.showLabelString(this.ui.lab_count.getComponent(cc.Label), 'X' + this.model.count)\r\n\t\t}\r\n\t\tif (this.model.name) {\r\n\t\t\tthis.showLabelString(this.ui.lab_name.getComponent(cc.Label), this.model.name)\r\n\t\t}\r\n\t\tif (this.model.priceType != null) {\r\n\t\t\tthis.ui.sp_price.spriteFrame = this.ui.sp_SpriteFrame[this.model.priceType-1];\r\n\t\t}\r\n\t}\r\n\t//显示label内容\r\n\tshowLabelString(obj: cc.Label, content: string) {\r\n\t\tobj.string = content;\r\n\t}\r\n\tpublic addPrefab(obj_node: cc.Node, obj_Prefab: cc.Prefab) {\r\n\t\treturn this.addPrefabNode(obj_Prefab, obj_node);\r\n\t}\r\n}\r\n//c, 控制\r\n@ccclass\r\nexport default class CardShopCtrl extends BaseCtrl {\r\n\tprotected view: View;\r\n\tprotected model: Model;\r\n\t//这边去声明ui组件\r\n\t//label\r\n\t@property(cc.Node)\r\n\tlab_cost: cc.Node = null;\r\n\t@property(cc.Node)\r\n\tlab_name: cc.Node = null;\r\n\t@property(cc.Node)\r\n\tlab_count: cc.Node = null;\r\n\t//sprite\r\n\t@property(cc.Sprite)\r\n\tsp_price: cc.Sprite = null;\r\n\t//SpriteFrame\r\n\t@property([cc.SpriteFrame])\r\n\tsp_SpriteFrame: any = [cc.SpriteFrame];\r\n\t//Prefab\r\n\t@property(cc.Prefab)\r\n\tcardBuyShow: cc.Prefab = null;\r\n\t//声明ui组件end\r\n\t//这是ui组件的map,将ui和控制器或试图普通变量分离\r\n\tcost: number;\r\n\tcount: number;\r\n\tpriceType: number;\r\n\tname: string;\r\n\r\n\r\n\tonLoad() {\r\n\t\t// 控制器\r\n\t\tctrl = this;\r\n\t\t// 创建mvc模式中模型和视图\r\n\t\tthis.initMvc(Model, View);\r\n\t}\r\n\tsetData(cost: number, count: number, name: string, priceType: number) {\r\n\t\tif (this.view) {\r\n\t\t\tthis.model.cost = cost\r\n\t\t\tthis.model.count = count;\r\n\t\t\tthis.model.name = name;\r\n\t\t\tthis.model.priceType = priceType;\r\n\t\t\tthis.view.initUi();\r\n\t\t}\r\n\t\telse{\r\n\t\t\tthis.cost = cost;\r\n\t\t\tthis.count = count;\r\n\t\t\tthis.name = name;\r\n\t\t\tthis.priceType = priceType;\r\n\t\t}\r\n\t}\r\n\t//定义网络事件\r\n\tprotected defineNetEvents() {\r\n\t\tthis.n_events = {};\r\n\t}\r\n\t//定义全局事件\r\n\tprotected defineGlobalEvents() {\r\n\t\tthis.g_events = {};\r\n\t}\r\n\t//绑定操作的回调\r\n\tconnectUi() {\r\n\t\tthis.connect(\"click\", this.node.getComponent(cc.Button), this.buyCard, \"购买特技\");\r\n\t}\r\n\tupdateDateAndShowCardShop(data) {\r\n\t\tlet card = TableMgr.getInstance().search('teji_teji', { id: data.itemId })\r\n\t\tthis.model.cost = data.price;\r\n\t\tthis.model.count = data.amount;\r\n\t\tthis.model.name = card.name;\r\n\t\tthis.model.priceType = 2;\r\n\t\tthis.view.initUi();\r\n\t}\r\n\t//网络事件回调begin\r\n\t//end\r\n\t//全局事件回调begin\r\n\t//end\r\n\t//按钮或任何控件操作的回调begin\r\n\tbuyCard() {\r\n\t\t//this.addPrefab()\r\n\t\t//ModuleMgr.getInstance().showMsgBox({ content: `确定要花费${this.model.cost}购买特技：${this.model.name},X${this.model.count}?` })\r\n\t}\r\n\t//end\r\n\r\n\t// update(dt) {}\r\n\r\n\tonDestroy() {\r\n\t\tsuper.onDestroy();\r\n\t}\r\n}"]}