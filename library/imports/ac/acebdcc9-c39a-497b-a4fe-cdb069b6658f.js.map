{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\assets\\modules\\plaza\\script\\guilds/assets\\modules\\plaza\\script\\guilds\\guildsPanel.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\modules\\plaza\\script\\guilds","sourcesContent":["import BaseModel from \"../../../../framework/baseClass/BaseModel\";\r\nimport BaseView from \"../../../../framework/baseClass/BaseView\";\r\nimport BaseCtrl from \"../../../../framework/baseClass/BaseCtrl\";\r\nimport GuildsMgr from \"../../../../manager/public/guildsMgr\";\r\nimport { dataids } from \"../../../../framework/net/dataids\";\r\n\r\n/*\r\nauthor: 汤凯\r\n日期:2018-11-19\r\n*/\r\n\r\n//MVC模块,\r\nconst { ccclass, property } = cc._decorator;\r\nlet ctrl: GuildsPanelCtrl;\r\n//模型，数据处理\r\nclass Model extends BaseModel {\r\n\tsearchName = null;\r\n\tguildList = GuildsMgr.getInstance().getRandomGuildList();\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t}\r\n}\r\n//视图, 界面显示或动画，在这里完成\r\nclass View extends BaseView {\r\n\tprotected model: Model;\r\n\tprotected node: cc.Node;\r\n\tpublic ui={\r\n\t\tbtn_search: ctrl.btn_search,\r\n\t\tbtn_invitationReceive: ctrl.btn_invitationReceive,\r\n\t\tbtn_createGuild: ctrl.btn_createGuild,\r\n\t\tbtn_refreshGuilds: ctrl.btn_refreshGuilds,\r\n\t\tedit_searchName: ctrl.edit_searchName,\r\n\t\tpref_guild: ctrl.pref_guild,\r\n\t\tnode_guildListNode: ctrl.node_guildListNode,\r\n\t\tscroll_bar:ctrl.scroll_bar,\r\n\t\tpref_guildInvitedPanel: ctrl.pref_guildInvitedPanel,\r\n\t\tnode_guildInvitedPanelContent: ctrl.node_guildInvitedPanelContent\r\n\t}\r\n\tconstructor(model){\r\n\t\tsuper(model);\r\n\t\tthis.node = ctrl.node;\r\n\t\tthis.initUi();\r\n\t}\r\n\t//初始化ui\r\n\tpublic initUi() {\r\n\r\n\t}\r\n\tfreshGuildList()\r\n\t{\r\n\t\tthis.ui.node_guildListNode.destroyAllChildren();\r\n\t\tfor (let guildIdx = 0; guildIdx < this.model.guildList.length; guildIdx++) {\r\n\t\t\tlet guildItemData = this.model.guildList[guildIdx];\r\n\t\t\tlet guildItem = cc.instantiate(this.ui.pref_guild);\r\n\t\t\tthis.ui.node_guildListNode.addChild(guildItem);\r\n\t\t\tguildItem.getComponent('guildItem').updateAndShowGuildItem(guildItemData);\r\n\t\t}\r\n\t}\r\n\taddGuildInvitedPanel()\r\n\t{\r\n\t\tthis.ui.node_guildInvitedPanelContent.destroyAllChildren();\r\n\t\tlet guildInvitedPanel = cc.instantiate(this.ui.pref_guildInvitedPanel);\r\n\t\tthis.ui.node_guildInvitedPanelContent.addChild(guildInvitedPanel);\r\n\t}\r\n}\r\n//c, 控制\r\n@ccclass\r\nexport default class GuildsPanelCtrl extends BaseCtrl {\r\n\tprotected view: View;\r\n\tprotected model: Model;\r\n\t//这边去声明ui组件\r\n\t@property(cc.Button)\r\n\tbtn_search: cc.Button = null;\r\n\t@property(cc.Button)\r\n\tbtn_invitationReceive: cc.Button = null;\r\n\t@property(cc.Button)\r\n\tbtn_createGuild: cc.Button = null;\r\n\t@property(cc.Button)\r\n\tbtn_refreshGuilds: cc.Button = null;\r\n\t@property(cc.Prefab)\r\n\tpref_createGuild: cc.Prefab = null;\r\n\t@property(cc.EditBox)\r\n\tedit_searchName: cc.EditBox = null;\r\n\t@property(cc.Prefab)\r\n\tpref_guild: cc.Prefab = null;\r\n\t@property(cc.Node)\r\n\tnode_guildListNode: cc.Node = null;\r\n\t@property(cc.ScrollView)\r\n\tscroll_bar: cc.ScrollView = null;\r\n\t@property(cc.Prefab)\r\n\tpref_guildInvitedPanel: cc.Prefab = null;\r\n\t@property(cc.Node)\r\n\tnode_guildInvitedPanelContent: cc.Node = null;\r\n\t//声明ui组件end\r\n\t//这是ui组件的map,将ui和控制器或试图普通变量分离\r\n\r\n\r\n\tonLoad (){\r\n\t\t// 控制器\r\n\t\tctrl = this;\r\n\t\t// 创建mvc模式中模型和视图\r\n\t\tthis.initMvc(Model,View);\r\n\t}\r\n\r\n\t//定义网络事件\r\n\tprotected defineNetEvents() {\r\n\t \tthis.n_events = {\r\n            'search.entry.randomGuildList':this.search_entry_randomGuildList,\r\n            'search.entry.searchGuild':this.search_entry_searchGuild,\r\n        };\r\n\t}\r\n\t//定义全局事件\r\n\tprotected defineGlobalEvents() {\r\n\t\tthis.g_events = {};\r\n\t}\r\n\t//绑定操作的回调\r\n\tconnectUi() {\r\n\t\t// this.connect(\"click\",this.ui.btn_close,()=>{\r\n\t\t// \tthis.closeModule(\"guilds\");\r\n\t\t// },\"关闭公会界面\");\r\n\t\tthis.connect(\"click\",this.ui.btn_search,this.btnSearch.bind(this),\"搜索公会\");\r\n\t\tthis.connect(\"click\",this.ui.btn_invitationReceive,this.btnInvitationReceive.bind(this),\"收到公会邀请\");\r\n\t\tthis.connect(\"click\",this.ui.btn_createGuild,this.btnCreateGuild.bind(this),\"创建公会\");\r\n\t\tthis.connect(\"click\",this.ui.btn_refreshGuilds,this.btnRefreshGuilds.bind(this),\"换一批\");\r\n\t\tthis.connect(\"editing-did-ended\",this.ui.edit_searchName,this.editSearchNameChangedEnd.bind(this),\"输入公会名称\");\r\n\t\tthis.connect(\"scroll-to-bottom\",this.ui.scroll_bar.node,this.scrollToBottom.bind(this),\"拉到末尾\");\r\n\t\tthis.connect(\"scroll-to-top\",this.ui.scroll_bar.node,this.scrollToTop.bind(this),\"拉到头\");\r\n\t}\r\n\tsearch_entry_randomGuildList()\r\n\t{\r\n\t\tthis.model.guildList = GuildsMgr.getInstance().getRandomGuildList();\r\n\t\tthis.view.freshGuildList();\r\n\t}\r\n\tscrollToBottom(event)\r\n\t{\r\n\t\tconsole.log(\"scrollToBottom\",event)\r\n\t}\r\n\tscrollToTop(event)\r\n\t{\r\n\t\tconsole.log(\"scrollToTop\",event)\r\n\t}\r\n\tsearch_entry_searchGuild(msg)\r\n\t{\r\n\t\tconsole.log('search_entry_searchGuild',msg)\r\n        this.model.guildList = msg.getDataByType(dataids.ID_GUILDLIST);\r\n\t\tthis.view.freshGuildList();\r\n\t}\r\n\tbtnSearch()\r\n\t{\r\n\t\tif(this.model.searchName) {\r\n\t\t\tGuildsMgr.getInstance().reqSearchGuild(this.model.searchName);\r\n\t\t}\r\n\t}\r\n\tbtnInvitationReceive()\r\n\t{\r\n\t\tthis.view.addGuildInvitedPanel();\r\n\t}\r\n\tbtnCreateGuild()\r\n\t{\r\n\t\tlet createGuildNode = cc.instantiate(this.pref_createGuild);\r\n\t\tthis.node.addChild(createGuildNode);\r\n\t\t// GuildsMgr.getInstance().reqCreateGuild();\r\n\t}\r\n\tbtnRefreshGuilds()\r\n\t{\r\n\t\tGuildsMgr.getInstance().reqRandomGuildList();\r\n\t}\r\n\teditSearchNameChangedEnd(event)\r\n\t{\r\n\t\tthis.model.searchName = event.string;\r\n\t}\r\n\tbtnGuildItemClick()\r\n\t{\r\n\r\n\t}\r\n\t//网络事件回调begin\r\n\t//end\r\n\t//全局事件回调begin\r\n\t//end\r\n\t//按钮或任何控件操作的回调begin\r\n\t//end\r\n\r\n\t// update(dt) {}\r\n\r\n\tonDestroy() {\r\n\t\tsuper.onDestroy();\r\n\t}\r\n}"]}