{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\..\\assets\\modules\\game\\script\\physics\\hkcollider/assets\\modules\\game\\script\\physics\\hkcollider\\hkContact.js"],"names":["Intersection","require","CollisionType","cc","Enum","None","CollisionEnter","CollisionStay","CollisionExit","Contact","collider1","collider2","touching","isCollider1Polygon","BoxCollider","PolygonCollider","isCollider2Polygon","isCollider1Circle","CircleCollider","isCollider2Circle","testFunc","polygonPolygon","circleCircle","polygonCircle","errorID","js","getClassName","prototype","test","world1","world","world2","aabb","intersects","points","updateState","result","type","module","exports"],"mappings":";;;;;;AACA,IAAIA,eAAeC,QAAQ,gBAAR,CAAnB;;AAEA,IAAIC,gBAAgBC,GAAGC,IAAH,CAAQ;AACxBC,UAAM,CADkB;AAExBC,oBAAgB,CAFQ;AAGxBC,mBAAe,CAHS;AAIxBC,mBAAe;AAJS,CAAR,CAApB;;AAOA,SAASC,OAAT,CAAkBC,SAAlB,EAA6BC,SAA7B,EAAwC;AACpC,SAAKD,SAAL,GAAiBA,SAAjB;AACA,SAAKC,SAAL,GAAiBA,SAAjB;;AAEA,SAAKC,QAAL,GAAgB,KAAhB;;AAEA,QAAIC,qBAAsBH,qBAAqBP,GAAGW,WAAzB,IAA0CJ,qBAAqBP,GAAGY,eAA3F;AACA,QAAIC,qBAAsBL,qBAAqBR,GAAGW,WAAzB,IAA0CH,qBAAqBR,GAAGY,eAA3F;AACA,QAAIE,oBAAoBP,qBAAqBP,GAAGe,cAAhD;AACA,QAAIC,oBAAoBR,qBAAqBR,GAAGe,cAAhD;;AAEA,QAAIL,sBAAsBG,kBAA1B,EAA8C;AAC1C,aAAKI,QAAL,GAAgBpB,aAAaqB,cAA7B;AACH,KAFD,MAGK,IAAIJ,qBAAqBE,iBAAzB,EAA4C;AAC7C,aAAKC,QAAL,GAAgBpB,aAAasB,YAA7B;AACH,KAFI,MAGA,IAAIT,sBAAsBM,iBAA1B,EAA6C;AAC9C,aAAKC,QAAL,GAAgBpB,aAAauB,aAA7B;AACH,KAFI,MAGA,IAAIN,qBAAqBD,kBAAzB,EAA6C;AAC9C,aAAKI,QAAL,GAAgBpB,aAAauB,aAA7B;AACA,aAAKb,SAAL,GAAiBC,SAAjB;AACA,aAAKA,SAAL,GAAiBD,SAAjB;AACH,KAJI,MAKA;AACDP,WAAGqB,OAAH,CAAW,IAAX,EAAiBrB,GAAGsB,EAAH,CAAMC,YAAN,CAAmBhB,SAAnB,CAAjB,EAAgDP,GAAGsB,EAAH,CAAMC,YAAN,CAAmBf,SAAnB,CAAhD;AACH;AACJ;;AAEDF,QAAQkB,SAAR,CAAkBC,IAAlB,GAAyB,YAAY;AACjC,QAAIC,SAAS,KAAKnB,SAAL,CAAeoB,KAA5B;AACA,QAAIC,SAAS,KAAKpB,SAAL,CAAemB,KAA5B;;AAEA,QAAI,CAACD,OAAOG,IAAP,CAAYC,UAAZ,CAAuBF,OAAOC,IAA9B,CAAL,EAA0C;AACtC,eAAO,KAAP;AACH;;AAED,QAAI,KAAKZ,QAAL,KAAkBpB,aAAaqB,cAAnC,EAAmD;AAC/C,eAAO,KAAKD,QAAL,CAAcS,OAAOK,MAArB,EAA6BH,OAAOG,MAApC,CAAP;AACH,KAFD,MAGK,IAAI,KAAKd,QAAL,KAAkBpB,aAAasB,YAAnC,EAAiD;AAClD,eAAO,KAAKF,QAAL,CAAcS,MAAd,EAAsBE,MAAtB,CAAP;AACH,KAFI,MAGA,IAAI,KAAKX,QAAL,KAAkBpB,aAAauB,aAAnC,EAAkD;AACnD,eAAO,KAAKH,QAAL,CAAcS,OAAOK,MAArB,EAA6BH,MAA7B,CAAP;AACH;;AAED,WAAO,KAAP;AACH,CAnBD;;AAqBAtB,QAAQkB,SAAR,CAAkBQ,WAAlB,GAAgC,YAAY;AACxC,QAAIC,SAAS,KAAKR,IAAL,EAAb;;AAEA,QAAIS,OAAOnC,cAAcG,IAAzB;AACA,QAAI+B,UAAU,CAAC,KAAKxB,QAApB,EAA8B;AAC1B,aAAKA,QAAL,GAAgB,IAAhB;AACAyB,eAAOnC,cAAcI,cAArB;AACH,KAHD,MAIK,IAAI8B,UAAU,KAAKxB,QAAnB,EAA6B;AAC9ByB,eAAOnC,cAAcK,aAArB;AACH,KAFI,MAGA,IAAI,CAAC6B,MAAD,IAAW,KAAKxB,QAApB,EAA8B;AAC/B,aAAKA,QAAL,GAAgB,KAAhB;AACAyB,eAAOnC,cAAcM,aAArB;AACH;;AAED,WAAO6B,IAAP;AACH,CAjBD;;AAoBA5B,QAAQP,aAAR,GAAwBA,aAAxB;;AAEAoC,OAAOC,OAAP,GAAiB9B,OAAjB","file":"hkContact.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\..\\assets\\modules\\game\\script\\physics\\hkcollider","sourcesContent":["\nvar Intersection = require('hkIntersection');\n\nvar CollisionType = cc.Enum({\n    None: 0,\n    CollisionEnter: 1,\n    CollisionStay: 2,\n    CollisionExit: 3\n});\n\nfunction Contact (collider1, collider2) {\n    this.collider1 = collider1;\n    this.collider2 = collider2;\n\n    this.touching = false;\n\n    var isCollider1Polygon = (collider1 instanceof cc.BoxCollider) || (collider1 instanceof cc.PolygonCollider);\n    var isCollider2Polygon = (collider2 instanceof cc.BoxCollider) || (collider2 instanceof cc.PolygonCollider);\n    var isCollider1Circle = collider1 instanceof cc.CircleCollider;\n    var isCollider2Circle = collider2 instanceof cc.CircleCollider;\n\n    if (isCollider1Polygon && isCollider2Polygon) {\n        this.testFunc = Intersection.polygonPolygon;\n    }\n    else if (isCollider1Circle && isCollider2Circle) {\n        this.testFunc = Intersection.circleCircle;\n    }\n    else if (isCollider1Polygon && isCollider2Circle) {\n        this.testFunc = Intersection.polygonCircle;\n    }\n    else if (isCollider1Circle && isCollider2Polygon) {\n        this.testFunc = Intersection.polygonCircle;\n        this.collider1 = collider2;\n        this.collider2 = collider1;\n    }\n    else {\n        cc.errorID(6601, cc.js.getClassName(collider1), cc.js.getClassName(collider2));\n    }\n}\n\nContact.prototype.test = function () {\n    var world1 = this.collider1.world;\n    var world2 = this.collider2.world;\n\n    if (!world1.aabb.intersects(world2.aabb)) {\n        return false;\n    }\n\n    if (this.testFunc === Intersection.polygonPolygon) {\n        return this.testFunc(world1.points, world2.points);\n    }\n    else if (this.testFunc === Intersection.circleCircle) {\n        return this.testFunc(world1, world2);\n    }\n    else if (this.testFunc === Intersection.polygonCircle) {\n        return this.testFunc(world1.points, world2);\n    }\n\n    return false;\n};\n\nContact.prototype.updateState = function () {\n    var result = this.test();\n\n    var type = CollisionType.None;\n    if (result && !this.touching) {\n        this.touching = true;\n        type = CollisionType.CollisionEnter;\n    }\n    else if (result && this.touching) {\n        type = CollisionType.CollisionStay;\n    }\n    else if (!result && this.touching) {\n        this.touching = false;\n        type = CollisionType.CollisionExit;\n    }\n\n    return type;\n};\n\n\nContact.CollisionType = CollisionType;\n\nmodule.exports = Contact;\n"]}