{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\assets\\modules\\plaza\\script\\guilds/assets\\modules\\plaza\\script\\guilds\\guildApplicationItem.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\modules\\plaza\\script\\guilds","sourcesContent":["import BaseModel from \"../../../../framework/baseClass/BaseModel\";\r\nimport BaseView from \"../../../../framework/baseClass/BaseView\";\r\nimport BaseCtrl from \"../../../../framework/baseClass/BaseCtrl\";\r\nimport GuildsMgr from \"../../../../manager/public/guildsMgr\";\r\nimport { enums } from \"../../../../manager/enums\";\r\nimport { dataids } from \"../../../../framework/net/dataids\";\r\nimport Package from \"../../../..framework/net/package\";\r\n\r\n/*\r\nauthor: 汤凯\r\n日期:2018-11-20 15:25:14\r\n*/\r\n\r\n//MVC模块,\r\nconst { ccclass, property } = cc._decorator;\r\nlet ctrl: GuildApplicationItemCtrl;\r\n//模型，数据处理\r\nclass Model extends BaseModel {\r\n\tguildInfo = GuildsMgr.getInstance().getGuildInfo();\r\n\tguildApplicationInfo = null;\r\n\tguildApplicationInfoIdx = 0;\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t}\r\n}\r\n//视图, 界面显示或动画，在这里完成\r\nclass View extends BaseView {\r\n\tprotected model: Model;\r\n\tprotected node: cc.Node;\r\n\tpublic ui={\r\n\t\tspr_guildPlayerIcon: ctrl.spr_guildPlayerIcon,\r\n\t\tspr_guildPlayerStageIcon: ctrl.spr_guildPlayerStageIcon,\r\n\t\tlbl_guildPlayerName: ctrl.lbl_guildPlayerName,\r\n\t\tlbl_guildPlayerPosition: ctrl.lbl_guildPlayerPosition,\r\n\t\tbtn_agress: ctrl.btn_agress,\r\n\t\tbtn_refuss: ctrl.btn_refuss,\r\n\t}\r\n\tconstructor(model){\r\n\t\tsuper(model);\r\n\t\tthis.node = ctrl.node;\r\n\t\tthis.initUi();\r\n\t}\r\n\t//初始化ui\r\n\tpublic initUi() {\r\n\t\t// this.showGuildApplicationInfo();\r\n\t}\r\n\tpublic showGuildApplicationInfo()\r\n\t{\r\n\t\tif(this.model.guildApplicationInfo ) {\r\n\t\t\tthis.ui.lbl_guildPlayerName.string = \"test\";\r\n\t\t\t// this.ui.lbl_guildPlayerStage.string = this.model.guildPlayerInfo.stageIndex;\r\n\t\t\t// this.ui.lbl_guildPlayerDonate.string = this.model.guildPlayerInfo.donate;\r\n\t\t\t// this.ui.spr_guildPlayerIcon\r\n\t\t\t// this.ui.spr_guildPlayerStageIcon \r\n\t\t}\r\n\t}\r\n}\r\n//c, 控制\r\n@ccclass\r\nexport default class GuildApplicationItemCtrl extends BaseCtrl {\r\n\tprotected view: View;\r\n\tprotected model: Model;\r\n\t//这边去声明ui组件\r\n\t@property(cc.Sprite)\r\n\tspr_guildPlayerIcon: cc.Sprite = null;\r\n\t@property(cc.Sprite)\r\n\tspr_guildPlayerStageIcon: cc.Sprite = null;\r\n\t@property(cc.Label)\r\n\tlbl_guildPlayerName: cc.Label = null;\r\n\t@property(cc.Label)\r\n\tlbl_guildPlayerPosition: cc.Label = null;\r\n\t@property(cc.Button)\r\n\tbtn_agress: cc.Button = null;\r\n\t@property(cc.Button)\r\n\tbtn_refuss: cc.Button = null;\r\n\r\n\t//声明ui组件end\r\n\t//这是ui组件的map,将ui和控制器或试图普通变量分离\r\n\r\n\r\n\tonLoad (){\r\n\t\t// 控制器\r\n\t\tctrl = this;\r\n\t\t// 创建mvc模式中模型和视图\r\n\t\tthis.initMvc(Model,View);\r\n\t}\r\n\r\n\t//定义网络事件\r\n\tprotected defineNetEvents() {\r\n\t \tthis.n_events = {\r\n            'guild.guild.agreeApply': this.guild_guild_agreeApply,\r\n            'guild.guild.refuseApply': this.guild_guild_refuseApply,\r\n        };\r\n\t}\r\n\t//定义全局事件\r\n\tprotected defineGlobalEvents() {\r\n\t\tthis.g_events = {};\r\n\t}\r\n\t//绑定操作的回调\r\n\tconnectUi() {\r\n\t\t// this.connect(\"click\",this.node,this.guildPlayerNodeClick.bind(this),\"点击公会成员\");\r\n\t\tthis.connect(\"click\",this.ui.btn_agress,this.btnAgress.bind(this),\"允许加入\");\r\n\t\tthis.connect(\"click\",this.ui.btn_refuss,this.btnRefuss.bind(this),\"拒绝\");\r\n\t}\r\n\tbtnAgress()\r\n\t{\r\n\t\tGuildsMgr.getInstance().agreeApply(this.model.guildApplicationInfoIdx);\r\n\t\tconsole.log(\"btnAgress\")\r\n\t}\r\n\tbtnRefuss()\r\n\t{\r\n\t\tconsole.log(\"btnRefuss\")\r\n\t\tGuildsMgr.getInstance().refuseApply(this.model.guildApplicationInfoIdx);\r\n\t}\r\n\tUpdateAndShowGuildApplicationInfo(data,index)\r\n\t{\r\n\t\tconsole.log(\"UpdateAndShowGuildApplicationInfo\",data)\r\n\t\tthis.model.guildApplicationInfo = data;\r\n\t\tthis.model.guildApplicationInfoIdx = index;\r\n\t\tthis.view.showGuildApplicationInfo();\r\n\t}\r\n\tguild_guild_agreeApply(msg: Package)\r\n\t{\r\n\t\tlet applicationIdx = msg.getDataByType(dataids.ID_AGREE_GUILD_APPLY);\r\n\t\tif( applicationIdx == this.model.guildApplicationInfoIdx) {\r\n\t\t\tthis.remove();\r\n\t\t}\r\n\t}\r\n\tguild_guild_refuseApply(msg: Package)\r\n\t{\r\n\t\tlet applicationIdx = msg.getDataByType(dataids.ID_REFUSE_GUILD_APPLY);\r\n\t\tif( applicationIdx == this.model.guildApplicationInfoIdx) {\r\n\t\t\tthis.remove();\r\n\t\t}\r\n\t}\r\n\t//网络事件回调begin\r\n\t//end\r\n\t//全局事件回调begin\r\n\t//end\r\n\t//按钮或任何控件操作的回调begin\r\n\t//end\r\n\r\n\t// update(dt) {}\r\n\r\n\tonDestroy() {\r\n\t\tsuper.onDestroy();\r\n\t}\r\n}"]}