{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\manager\\public/assets\\manager\\public\\talentMgr.ts"],"names":[],"mappings":";;;;;AAAA,6DAAwD;AAGxD,uDAAsD;AACtD,qCAAgC;AAEhC,IAAI,OAAO,GAAG,iBAAO,CAAC,WAAW,EAAE,CAAC;AAEpC;IAAuC,6BAAO;IAO7C;QAAA,YACC,iBAAO,SAOP;QAdM,eAAS,GAAE,IAAI,CAAC;QAChB,gBAAU,GAAQ,IAAI,CAAA;QACtB,YAAM,GAAY,KAAK,CAAC;QACxB,iBAAW,GAAS,IAAI,CAAC;QACzB,mBAAa,GAAS,IAAI,CAAC;QAC3B,gBAAU,GAAM,IAAI,CAAC;QAG3B,KAAI,CAAC,MAAM,GAAG;YACd,4BAA4B,EAAC,KAAI,CAAC,aAAa;YAC/C,0BAA0B,EAAC,KAAI,CAAC,WAAW;YAC3C,0BAA0B,EAAC,KAAI,CAAC,WAAW;SAC1C,CAAC;;IAEH,CAAC;IACD,4BAAQ,GAAR;QACC,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,aAAa,CAAC,eAAe,CAAC,CAAC,IAAI,CAAC;QAC3D,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,UAAU,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YAChD,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,QAAQ,GAAE,CAAC,CAAC;SAC/B;QACD,KAAK,IAAI,EAAE,IAAI,IAAI,CAAC,UAAU,EAAE;YAC/B,IAAI,GAAG,GAAE,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC;YAC/B,GAAG,CAAC,QAAQ,GAAE,IAAI,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC;SAClC;QACD,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,UAAU,CAAC,CAAA;IAC7B,CAAC;IACM,gCAAY,GAAnB,UAAoB,EAAO;QAC1B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,UAAU,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YAChD,IAAI,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;YACrC,IAAI,WAAW,CAAC,EAAE,IAAI,EAAE,EAAE;gBACzB,OAAO,WAAW,CAAC;aACnB;SACD;QACD,OAAO,OAAO,CAAC,GAAG,CAAC,SAAS,EAAE,EAAE,CAAC,CAAC;IACnC,CAAC;IACD,iCAAa,GAAb,UAAc,GAAY;QACzB,IAAI,UAAU,GAAG,GAAG,CAAC,aAAa,CAAC,iBAAO,CAAC,iBAAiB,CAAC,CAAC;QAC9D,OAAO,CAAC,GAAG,CAAC,gBAAgB,EAAC,UAAU,CAAC,CAAA;QACxC,IAAI,CAAC,WAAW,GAAE,UAAU,CAAC,YAAY,CAAC;QAC1C,IAAI,CAAC,aAAa,GAAE,UAAU,CAAC,UAAU,CAAC,aAAa,CAAC;QACxD,IAAI,CAAC,UAAU,GAAE,UAAU,CAAC,UAAU,CAAC,UAAU,CAAC;QAClD,IAAI,CAAC,MAAM,GAAE,IAAI,CAAC;QAClB,IAAI,CAAC,QAAQ,EAAE,CAAC;IACjB,CAAC;IACD,qCAAiB,GAAjB;QACC,IAAI,KAAK,GAAG,4BAA4B,CAAC;QACzC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAA;IACrB,CAAC;IACD,+BAAW,GAAX,UAAY,GAAY;QACvB,IAAI,WAAW,GAAG,GAAG,CAAC,aAAa,CAAC,iBAAO,CAAC,gBAAgB,CAAC,CAAC;QAC9D,IAAI,SAAS,GAAG,GAAG,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC;QACtC,OAAO,CAAC,GAAG,CAAC,gBAAgB,EAAC,WAAW,EAAC,SAAS,CAAC,CAAA;QACnD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,UAAU,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YAChD,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,QAAQ,GAAE,CAAC,CAAC;SAC/B;QACD,IAAI,CAAC,WAAW,GAAE,SAAS,CAAC,YAAY,CAAC;QACzC,IAAI,CAAC,aAAa,GAAE,SAAS,CAAC,SAAS,CAAC;IACzC,CAAC;IACD,sCAAkB,GAAlB,UAAmB,EAAE;QACpB,IAAI,KAAK,GAAG,0BAA0B,CAAC;QACvC,IAAI,GAAG,GAAE;YACR,SAAS,EAAE,EAAE;SACb,CAAA;QACD,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAC,GAAG,CAAC,CAAA;IACzB,CAAC;IACD,+BAAW,GAAX,UAAY,GAAY;QACvB,IAAI,UAAU,GAAG,GAAG,CAAC,aAAa,CAAC,iBAAO,CAAC,kBAAkB,CAAC,CAAC;QAC/D,OAAO,CAAC,GAAG,CAAC,gBAAgB,EAAC,UAAU,CAAC,CAAA;QACxC,IAAI,CAAC,WAAW,GAAE,UAAU,CAAC,YAAY,CAAC;QAC1C,KAAK,IAAI,EAAE,IAAI,UAAU,CAAC,YAAY,EAAE;YACvC,IAAI,GAAG,GAAE,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC;YAC/B,GAAG,CAAC,QAAQ,GAAE,UAAU,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC;SAC1C;IACF,CAAC;IACD,sCAAkB,GAAlB,UAAmB,EAAE;QACpB,IAAI,KAAK,GAAG,0BAA0B,CAAC;QACvC,IAAI,GAAG,GAAE;YACR,QAAQ,EAAE,EAAE;SACZ,CAAA;QACD,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAC,GAAG,CAAC,CAAA;IACzB,CAAC;IACD,kCAAc,GAAd,UAAe,MAAM;QACpB,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,CAAA;QACnB,IAAG,CAAC,MAAM,CAAC,YAAY,EAAC;YACvB,OAAO,IAAI,CAAC;SACZ;aACG;YACH,IAAI,GAAG,GAAE,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,YAAY,CAAC,CAAA;YAC/C,IAAG,GAAG,CAAC,QAAQ,IAAE,GAAG,CAAC,QAAQ,EAAE;gBAC9B,OAAO,IAAI,CAAC;aACZ;iBACG;gBACH,OAAO,KAAK,CAAC;aACb;SACD;IACF,CAAC;IAIa,qBAAW,GAAzB;QACC,IAAI,SAAS,CAAC,SAAS,IAAI,IAAI,EAAE;YAChC,SAAS,CAAC,SAAS,GAAG,IAAI,SAAS,EAAE,CAAC;SACtC;QACD,OAAO,SAAS,CAAC,SAAS,CAAC;IAC5B,CAAC;IAPD,OAAO;IACQ,mBAAS,GAAa,IAAI,CAAC;IAO3C,gBAAC;CA1GD,AA0GC,CA1GsC,iBAAO,GA0G7C;kBA1GoB,SAAS","file":"","sourceRoot":"..\\..\\..\\..\\..\\assets\\manager\\public","sourcesContent":["import BaseMgr from \"../../framework/baseClass/BaseMgr\";\nimport Package from \"../../framework/net/package\";\n\nimport { dataids } from \"../../framework/net/dataids\";\nimport UserMgr from \"./userMgr\";\nimport GameNet from \"../../framework/modules/GameNet\";\nlet userMgr = UserMgr.getInstance();\n\nexport default class talentMgr extends BaseMgr {\n\tpublic curTalent =null;\n\tpublic talentList: any = null\n\tpublic isInit: boolean = false;\n\tpublic talentPoint:number =null;\n\tpublic lastResetTime:number =null;\n\tpublic talentInfo:any =null;\n\tconstructor() {\n\t\tsuper();\n\t\tthis.routes = {\n\t\t'plaza.talent.reqTalentInfo':this.reqTalentInfo,\n\t\t'plaza.talent.resetTalent':this.resetTalent,\n\t\t'plaza.talent.learnTalent':this.learnTalent,\n\t\t};\n\t\n\t}\n\tinitData(){\n\t\tthis.talentList = this.getConfigSync(\"talent_talent\").json;\n\t\tfor (let i = 0; i < this.talentList.length; i++) {\n\t\t\tthis.talentList[i].curLevel =0;\n\t\t}\n\t\tfor (var id in this.talentInfo) {\n\t\t\tvar obj =this.selectTalent(id);\n\t\t\tobj.curLevel =this.talentInfo[id];\n\t\t}\n\t\tconsole.log(this.talentList)\n\t}\n\tpublic selectTalent(id: any): any {\n\t\tfor (let i = 0; i < this.talentList.length; i++) {\n\t\t\tlet achievement = this.talentList[i];\n\t\t\tif (achievement.id == id) {\n\t\t\t\treturn achievement;\n\t\t\t}\n\t\t}\n\t\treturn console.log(\"没有该天赋id\", id);\n\t}\n\treqTalentInfo(msg: Package): void {\n\t\tlet talentInfo = msg.getDataByType(dataids.ID_GET_TALENTINFO);\n\t\tconsole.log(\"-----天赋信息-----\",talentInfo)\n\t\tthis.talentPoint =talentInfo.talentPoints;\n\t\tthis.lastResetTime =talentInfo.talentInfo.lastResetTime;\n\t\tthis.talentInfo =talentInfo.talentInfo.talentInfo;\n\t\tthis.isInit =true;\n\t\tthis.initData();\n\t}\n\tsendReqTalentInfo(){\n\t\tlet route = 'plaza.talent.reqTalentInfo';\n\t\tthis.send_msg(route)\n\t}\n\tresetTalent(msg: Package): void {\n\t\tlet crystalInfo = msg.getDataByType(dataids.ID_USER_MONEYFEN);\n\t\tlet resetInfo = msg.getDataByType(76);\n\t\tconsole.log(\"-----重置天赋-----\",crystalInfo,resetInfo)\n\t\tfor (let i = 0; i < this.talentList.length; i++) {\n\t\t\tthis.talentList[i].curLevel =0;\n\t\t}\n\t\tthis.talentPoint =resetInfo.talentPoints;\n\t\tthis.lastResetTime =resetInfo.resetTime;\n\t}\n\tsendReqresetTalent(id){\n\t\tlet route = 'plaza.talent.resetTalent';\n\t\tlet msg ={\n\t\t\tresetType: id,\n\t\t}\n\t\tthis.send_msg(route,msg)\n\t}\n\tlearnTalent(msg: Package): void {\n\t\tlet talentInfo = msg.getDataByType(dataids.ID_GET_LEARNTALENT);\n\t\tconsole.log(\"-----升级天赋-----\",talentInfo)\n\t\tthis.talentPoint =talentInfo.talentPoints;\n\t\tfor (var id in talentInfo.talentLvInfo) {\n\t\t\tvar obj =this.selectTalent(id);\n\t\t\tobj.curLevel =talentInfo.talentLvInfo[id];\n\t\t}\n\t}\n\tsendReqLearnTalent(id){\n\t\tlet route = 'plaza.talent.learnTalent';\n\t\tlet msg ={\n\t\t\ttalentId: id,\n\t\t}\n\t\tthis.send_msg(route,msg)\n\t}\n\tboolStudyState(talent):boolean{\n\t\tconsole.log(talent)\n\t\tif(!talent.precondition){\n\t\t\treturn true;\n\t\t}\n\t\telse{\n\t\t\tlet obj =this.selectTalent(talent.precondition)\n\t\t\tif(obj.curLevel==obj.maxLevel ){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\t\n\t// 单例处理\n\tprivate static _instance: talentMgr =null;\n\tpublic static getInstance(): talentMgr {\n\t\tif (talentMgr._instance == null) {\n\t\t\ttalentMgr._instance = new talentMgr();\n\t\t}\n\t\treturn talentMgr._instance;\n\t}\n}\n\n"]}