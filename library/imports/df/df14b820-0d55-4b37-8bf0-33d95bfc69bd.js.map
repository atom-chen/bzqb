{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\assets\\modules\\game\\script\\UI/assets\\modules\\game\\script\\UI\\fightPlayerCtrl.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\modules\\game\\script\\UI","sourcesContent":["import fightPlayerShootCtrl from \"./fightPlayerShootCtrl\";\nimport Emitter from \"../../../../framework/modules/Emitter\";\nimport config from \"../common/gameConfig\";\nimport fightCardBtn from \"./fightCardBtn\";\n\n// import HkPhysics from \"../physics/hkPhysics\";\n// let hkPhysics = HkPhysics.getInstance();\n/*\nauthor: 黄凯\n日期:2018-11-19\n*/\nconst { fightEvent } = config;\n\nlet emitter = Emitter.getInstance();\n\nimport PlayerCtrlData from \"../modles/PlayerCtrlData\";\n\nlet playerCtrlData = PlayerCtrlData.getInstance();\n\n// 到我的回合时显示的ui\nconst {ccclass, property} = cc._decorator;\n\n\n// TODO \n// 1,仰角限制\n// 2,世界坐标等转换情况\n// 3,显示隐藏 ui效果\n// 4，圆形操作区域问题\n\n@ccclass\nexport default class fightPlayerUi extends cc.Component {\n\n    // 左按键\n    @property(cc.Node)\n    leftBtn : cc.Node = null;\n\n    // 右按键\n    @property(cc.Node)\n    rightBtn : cc.Node = null;\n\n    // 飞机按钮\n    @property(cc.Node)\n    planeBtn : cc.Node = null;\n\n    // 卡牌列表\n    @property(cc.Node)\n    cardListNode : cc.Node = null;\n    // 最后一张卡牌\n    @property(cc.Node)\n    lastCard : cc.Node = null;\n\n    @property(cc.Prefab)\n    cardPrefab : cc.Prefab = null;\n\n    // 卡牌id找对应的图集\n    // 测试用的\n    @property(cc.SpriteFrame)\n    cardSpriteFrame : cc.SpriteFrame = null;\n\n\n    onLoad(){\n    \t// 长按发送移动数据\n    \tthis.leftBtn.on(cc.Node.EventType.TOUCH_START,()=>{\n    \t\tthis.setDirection(-1);\n    \t});\n    \tthis.rightBtn.on(cc.Node.EventType.TOUCH_START,()=>{\n    \t\tthis.setDirection(1);\n    \t});\n\n    \tthis.leftBtn.on(cc.Node.EventType.TOUCH_CANCEL,this.cancleDirection,this);\n    \tthis.leftBtn.on(cc.Node.EventType.TOUCH_END,this.cancleDirection,this);\n    \tthis.rightBtn.on(cc.Node.EventType.TOUCH_CANCEL,this.cancleDirection,this);\n    \tthis.rightBtn.on(cc.Node.EventType.TOUCH_END,this.cancleDirection,this);\n\n    \tthis.planeBtn.on(cc.Node.EventType.TOUCH_START,this.setPlane,this);\n\n        // 触发卡牌的删除\n        emitter.on(fightEvent.onCardChange,this.onCardChange,this);\n        // TODO 触发卡牌的收缩\n\n\n    }\n\n    // 设置运动方向\n    public setDirection(direction:number):void{\n    \tplayerCtrlData.direction = direction;\n    }\n\n\n    // 取消长按\n    public cancleDirection():void{\n    \tplayerCtrlData.direction = 0;\n    }\n\n\n    // 当前飞机状态\n    nowPlane:number = 0;\n    // TODO 重置当前飞机 设置飞机\n    public setPlane():void{\n        (this.nowPlane == 0)?(this.nowPlane = 1):(this.nowPlane = 0);\n        playerCtrlData.changePlane = this.nowPlane;\n    }\n\n    // 1-6 张卡牌数组\n    onCardChange(cards:any){\n        // TODO 找到卡牌对应的图片\n        // 取出最后一张卡牌作为下一张\n        this.clearCardList();\n        if(cards.length <= 0){\n            return;\n        }\n        let lastCard = cards.splice(cards.length-1,1)[0];\n        for(let i = 0 ; i < cards.length ; i++){\n            let cardId = cards[i];\n            let node = cc.instantiate(this.cardPrefab);\n            let script = node.getComponent(fightCardBtn);\n            // 测试表现  先写死了\n            node.width = 110;\n            node.height = 160;\n            node.x = - i*120;\n            // 测试数据\n            script.init({\n                cardId:cardId,\n                spriteFrame:this.cardSpriteFrame,\n                sendUseCard:this.sendUseCard.bind(this)\n            });\n            node.parent = this.cardListNode;\n        }\n    }\n\n    // 使用卡牌\n    sendUseCard(cardId){\n        playerCtrlData.userCard = cardId;\n    }\n\n\n    // 清理卡牌列表\n    clearCardList(){\n        let children = this.cardListNode.children;\n        for(let i = 0;i<children.length;i++){\n            let child = children[i];\n            child.destroy();\n        }\n    }\n\n \n    onDestroy(){\n    \tthis.leftBtn.off(cc.Node.EventType.TOUCH_START,this.setDirection,-1);\n    \tthis.rightBtn.off(cc.Node.EventType.TOUCH_START,this.setDirection,1);\n\n    \tthis.leftBtn.off(cc.Node.EventType.TOUCH_CANCEL,this.cancleDirection);\n    \tthis.leftBtn.off(cc.Node.EventType.TOUCH_END,this.cancleDirection);\n    \tthis.rightBtn.off(cc.Node.EventType.TOUCH_CANCEL,this.cancleDirection);\n    \tthis.rightBtn.off(cc.Node.EventType.TOUCH_END,this.cancleDirection);\n\n    \tthis.planeBtn.off(cc.Node.EventType.TOUCH_START,this.setPlane);\n\n    }\n}\n\n"]}