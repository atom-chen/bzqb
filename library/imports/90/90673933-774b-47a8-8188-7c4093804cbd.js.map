{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\assets\\modules\\plaza\\script\\matching/assets\\modules\\plaza\\script\\matching\\matching.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\modules\\plaza\\script\\matching","sourcesContent":["import BaseModel from \"../../../../framework/baseClass/BaseModel\";\nimport BaseView from \"../../../../framework/baseClass/BaseView\";\nimport BaseCtrl from \"../../../../framework/baseClass/BaseCtrl\";\nimport MatchMgr from \"../../../../manager/public/matchMgr\";\n/*\nauthor: 蒙磊\n日期:2018-11-02 18:51:46\n*/\n\n//MVC模块,\nconst { ccclass, property } = cc._decorator;\nlet ctrl: MatchingCtrl;\nenum ROOMSTATE {\n\tCHOSE = 0,\n\tROOM,\n\tLOADING,\n}\n//模型，数据处理\nclass Model extends BaseModel {\n\tpublic roomState: number = ROOMSTATE.CHOSE;\n\tpublic second: number;//时间数据\n\tconstructor() {\n\t\tsuper();\n\t}\n\n\tpublic initTime(): void {\n\t\tthis.second = 0;\n\t}\n\n\tpublic addTime(): void {\n\t\t++this.second;\n\t}\n\n\tsetRoomState(roomState: number) {\n\t\tthis.roomState = roomState;\n\t}\n}\n//视图, 界面显示或动画，在这里完成\nclass View extends BaseView {\n\tprotected model: Model;\n\tprotected node: cc.Node;\n\tpublic ui = {\n\t\t//在这里声明ui\n\t\tnote_room: ctrl.note_room,\n\t\tnote_running: ctrl.note_running,\n\t\tnote_chose: ctrl.note_chose,\n\t\tnote_loading: ctrl.note_loading,\n\t\tbtn_room: ctrl.btn_room,\n\t\tbtn_back: ctrl.btn_back,\n\t\tbtn_tumble: ctrl.btn_tumble,\n\t\tbtn_begin: ctrl.btn_begin,\n\t\tbtn_cancel: ctrl.btn_cancel,\n\t\tlab_time: ctrl.lab_time,\n\t}\n\tconstructor(model) {\n\t\tsuper(model);\n\t\tthis.node = ctrl.node;\n\t\tthis.initUi();\n\t}\n\t//初始化ui\n\tpublic initUi() {\n\n\t}\n\tpublic hide(name): void {\n\t\tthis.ui[name].active = false;\n\t}\n\n\tpublic show(name): void {\n\t\tthis.ui[name].active = true;\n\t}\n\n\tpublic showTime(): void {\n\t\tlet minute = Math.floor(this.model.second / 60);\n\t\tlet mString = minute >= 10 ? minute.toString() : `0${minute}`;\n\t\tlet second = this.model.second % 60;\n\t\tlet sString = second >= 10 ? second.toString() : `0${second}`;\n\t\tthis.ui.lab_time.getComponent(cc.Label).string = `${mString}:${sString}`;\n\t}\n}\n//c, 控制\n@ccclass\nexport default class MatchingCtrl extends BaseCtrl {\n\tprotected view: View;\n\tprotected model: Model;\n\t//这边去声明ui组件\n\t@property(cc.Node)\n\tnote_chose: cc.Node = null;\n\t@property(cc.Node)\n\tnote_room: cc.Node = null;\n\t@property(cc.Node)\n\tnote_running: cc.Node = null;\n\t@property(cc.Node)\n\tnote_loading: cc.Node = null;\n\t@property(cc.Node)\n\tbtn_room: cc.Node = null;\n\t@property(cc.Node)\n\tbtn_back: cc.Node = null;\n\t@property(cc.Node)\n\tbtn_tumble: cc.Node = null;\n\t@property(cc.Node)\n\tbtn_begin: cc.Node = null;\n\t@property(cc.Node)\n\tbtn_cancel: cc.Node = null;\n\t@property(cc.Node)\n\tlab_time: cc.Node = null;\n\t//声明ui组件end\n\t//这是ui组件的map,将ui和控制器或试图普通变量分离\n\n\n\tonLoad() {\n\t\t// 控制器\n\t\tctrl = this;\n\t\t// 创建mvc模式中模型和视图\n\t\tthis.initMvc(Model, View);\n\t}\n\n\t//定义网络事件\n\tprotected defineNetEvents() {\n\t\tthis.n_events = {\n\t\t\t'match.match.match': this._match,\n\t\t\t'match.match.stopMatch': this._stopMatch\n\t\t};\n\t}\n\t//定义全局事件\n\tprotected defineGlobalEvents() {\n\t\tthis.g_events = {};\n\t}\n\t//绑定操作的回调\n\tconnectUi() {\n\t\tthis.connect(\"click\", this.ui.btn_room, this.roomCB, \"进入房间\");\n\t\tthis.connect(\"click\", this.ui.btn_back, this.backCB, \"返回\");\n\t\tthis.connect(\"click\", this.ui.btn_cancel, this._cancelCB, \"取消匹配\");\n\t\tthis.connect(\"click\", this.ui.btn_tumble, this.tumbleCB, \"进入乱斗\");\n\t\tthis.connect(\"click\", this.ui.btn_begin, this._beginCB, \"房间开始\");\n\t}\n\t//网络事件回调begin\n\tprivate _match(): void {\n\n\t}\n\n\tprivate _stopMatch(): void {\n\t\tthis.unschedule(this._timer);\n\t\tthis.view.hide(\"note_running\");\n\t\tthis.view.show(\"note_room\");\n\t\tthis.model.setRoomState(ROOMSTATE.ROOM);\n\t}\n\t//end\n\t//全局事件回调begin\n\t//end\n\t//按钮或任何控件操作的回调begin\n\t//end\n\troomCB() {\n\t\tthis.view.show(\"note_room\");\n\t\tthis.view.hide(\"note_chose\")\n\t\tthis.model.setRoomState(ROOMSTATE.ROOM)\n\t}\n\tbackCB() {\n\t\tcc.log(this.model.roomState)\n\t\tswitch (this.model.roomState) {\n\t\t\tcase ROOMSTATE.CHOSE:\n\t\t\t\tthis.closeModule(\"matching\")\n\t\t\t\tbreak;\n\t\t\tcase ROOMSTATE.ROOM:\n\t\t\t\tthis.closeModule(\"matching\")\n\t\t\t\tbreak;\n\t\t}\n\n\t}\n\n\tprivate _cancelCB(): void {\n\t\tMatchMgr.getInstance().sendStopMatch();\n\t}\n\n\ttumbleCB() {\n\t\tthis.view.show(\"note_running\");\n\t\tthis._startTimer();\n\t}\n\n\tprivate _beginCB() {\n\t\tthis.view.show(\"note_running\");\n\t\tthis._startTimer();\n\t\tMatchMgr.getInstance().sendMatch();\n\t\tthis.model.setRoomState(ROOMSTATE.LOADING);\n\t}\n\t//计时\n\tprivate _startTimer(): void {\n\t\tthis.model.initTime();\n\t\tthis.view.showTime()\n\t\tthis.schedule(this._timer, 1)\n\t}\n\n\tprivate _timer(): void {\n\t\tthis.model.addTime();\n\t\tthis.view.showTime();\n\t}\n\t//加载loading\n\tloading() {\n\t\tthis.closeModule(\"matching\")\n\t\tthis.openSubModule(\"loading\");\n\t}\n\n\t// update(dt) {}\n\n\tonDestroy() {\n\t\tsuper.onDestroy();\n\t}\n}"]}